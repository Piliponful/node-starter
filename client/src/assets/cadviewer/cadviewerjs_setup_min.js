var bMouseDown=false;var bTempMouseDown=false;var bPan=false;var firstx,firsty;var lastDX,lastDY;var TouchZoomFactor=1.1;var floorplan_height;var floorplan_width;var tip_width=30;var tip;var vqRoomMouseSelect=false;var thumbsMode=false;var layer_vqrooms="";var layer_vqstickynotes="";var layer_vqredlines="";var layer_vqdrag;var totalDragStart=0;var string_X="";var dx=0;var dy=0;var pdx=0;var pdy=0;var attr_1='{"display" : "none" }';var hide=$.parseJSON(attr_1);var attr_2='{"display" : "inline" }';var show=$.parseJSON(attr_2);var openHyperlinkInNewWindow=false;var hyperlinkNewWindowWidth=200;var hyperlinkNewWindowHeight=200;var cvjs_customToolTip=false;var locked=false;var rid;function cvjs_setCustomToolTip(a){cvjs_customToolTip=a}var cvjs_customToolTipArrayId=new Array();var cvjs_customToolTipArrayContent=new Array();function cvjs_displayCustomToolTip(a){for(ids in cvjs_customToolTipArrayId){if(cvjs_customToolTipArrayId[ids]==a){return cvjs_customToolTipArrayContent[ids]}}return a}function cvjs_setCustomToolTipValue(d,b){var c="";for(var a=0;a<b.length;a++){if(a==0){c=b[0]}else{c=c+"<br>"+b[a]}}cvjs_customToolTipArrayId.push(d);cvjs_customToolTipArrayContent.push(c)}function cvjs_searchReplaceText(b,a){$("text").each(function(h){if((($(this).text()).toLowerCase()).indexOf(b.toLowerCase())>-1){var c=$(this).attr("x");var j=$(this).attr("y");var d=$(this).attr("transform");var g=$(this).attr("font-size");var l=$(this).attr("stroke");var m=$(this).attr("fill");var f=$(this).attr("fill-opacity");var k='<text x="'+c+'" y="'+j+'" transform="'+d+'" >'+a+"</text>";$(this).replaceWith(k);layer_TEXTOS_PRINCIPALES.add(rPaper.text(c,j,a).attr({"font-size":"28px","font-family":"Arial",fill:"magenta",stroke:"magenta","fill-opacity":"1"}))}})}function cvjs_searchText(a,b){if(isNaN(b)){b=100}$("text").each(function(d){if((($(this).text()).toLowerCase()).indexOf(a.toLowerCase())>-1){var f=$(this).attr("x");var h=$(this).attr("y");viewBoxWidth=rpWidth/b*100;viewBoxHeight=rpHeight/b*100;viewBox.X=f-viewBoxWidth/2;viewBox.Y=h-viewBoxHeight/2;var c='{"viewBox" : "'+viewBox.X+" "+viewBox.Y+" "+viewBoxWidth+" "+viewBoxHeight+'" }';var g=$.parseJSON(c);rPaper.attr(g);zoomScale=viewBoxWidth/rpWidth}})}function cvjs_openHyperlinkInNewWindow(b,a,c){openHyperlinkInNewWindow=b;hyperlinkNewWindowWidth=a;hyperlinkNewWindowHeight=c}function consolelog(a){console.log(a)}function cvjs_getSpaceObjectIdList(){var a=new Array();for(spc in vqRooms){a.push(vqRooms[spc].data("id"))}return a}function cvjs_getSpaceObjectNodefromId(a){var b=-1;for(spc in vqRooms){if(vqRooms[spc].data("id")==a){b=vqRooms[spc].data("node");return b}}return b}function cvjs_getSpaceObjectNamefromId(a){var b=-1;for(spc in vqRooms){if(vqRooms[spc].data("id")==a){b=vqRooms[spc].data("name");return b}}return b}function cvjs_getSpaceObjectIdfromNode(a){var b=-1;for(spc in vqRooms){if(vqRooms[spc].data("node")==a){b=vqRooms[spc].data("id");return b}}return b}function cvjs_getSpaceObjectNamefromNode(b){var a=-1;for(spc in vqRooms){if(vqRooms[spc].data("node")==b){a=vqRooms[spc].data("name");return a}}return a}function cvjs_getAttributeStatus(c){var b=0;for(spc in vqRooms){if(vqRooms[spc].data("node")==c){b=spc}}var a=vqRooms[b].data("attributeStatus");return a}function cvjs_setAttributeStatus(c,b){var a=0;for(spc in vqRooms){if(vqRooms[spc].data("node")==c){a=spc}}vqRooms[a].removeData("attributeStatus");vqRooms[a].data("attributeStatus",b)}function cvjs_getAttributeFromSpaceObjectNode(f,c){var a=0;for(spc in vqRooms){if(vqRooms[spc].data("node")==f){a=spc}}var g=vqRooms[a].data("attributes");for(var b in g){var d=g[b];if(d.name==c){return d.value}}return -1}function cvjs_setAttributeInSpaceObjectNode(g,c,d){var a=0;for(spc in vqRooms){if(vqRooms[spc].data("node")==g){a=spc}}var h=vqRooms[a].data("attributes");for(var b in h){var f=h[b];if(f.name==c){h[b].value=d}}vqRooms[a].removeData("attributes");vqRooms[a].data("attributes",h)}function cvjs_layerList(){}function cvjs_newLayer(a){try{a=rPaper.g();return a}catch(b){}}function cvjs_clearLayer(a){try{a.remove();a=rPaper.g()}catch(b){a=rPaper.g()}return a}function cvjs_clearTextLayer(b){try{b.remove();b=rPaper.g();var a;for(a in vqTBorder){vqTBorder[a].attr(hide)}}catch(c){b=rPaper.g()}return b}function cvjs_sortLayersInOrder(c,b){try{c.prepend(b)}catch(a){return false}return true}function cvjs_sortLayers_prepend(c,b){try{c.prepend(b)}catch(a){return false}return true}function cvjs_sortLayers_insertAfter(c,b){try{c.insertAfter(b)}catch(a){return false}return true}function cvjs_AllLayersOn(){for(var a in vqRooms){vqRooms[a].attr(show)}}function cvjs_AllGroupsOn(){for(var a in vqRooms){vqRooms[a].attr(show)}}function cvjs_AllLayersOff(){for(var a in vqRooms){if(vqRooms[a].data("layer")=="Undefined"){}else{vqRooms[a].attr(hide)}}}function cvjs_AllGroupsOff(){for(var a in vqRooms){if(vqRooms[a].data("group")=="Undefined"||vqRooms[a].data("group")==""){}else{vqRooms[a].attr(hide)}}}function cvjs_LayerOn(b){var a=false;for(var c in vqRooms){if(vqRooms[c].data("layer")==b){vqRooms[c].attr(show);a=true}}for(var c in vqText){if(vqText[c].data("layer")==b){vqText[c].attr(show);a=true}}if(!a){b.attr(show)}}function cvjs_LayerOn_OthersOff(a){for(var b in vqRooms){if(vqRooms[b].data("layer")==a){vqRooms[b].attr(show)}else{vqRooms[b].attr(hide)}}}function cvjs_LayerOn_AllOff(a){for(var b in vqRooms){if(vqRooms[b].data("layer")==a){vqRooms[b].attr(show)}else{vqRooms[b].attr(hide)}}}function cvjs_LayerOff(b){try{var a=false;for(var d in vqRooms){if(vqRooms[d].data("layer")==b){vqRooms[d].attr(hide)}}for(var d in vqText){if(vqText[d].data("layer")==b){vqText[d].attr(hide);a=true}}if(!a){b.attr(hide)}}catch(c){window.alert(c)}}function cvjs_GroupOn(b){for(var a in vqRooms){if(vqRooms[a].data("group")==b){vqRooms[a].attr(show)}}}function cvjs_GroupOn_OthersOff(b){for(var a in vqRooms){if(vqRooms[a].data("group")==b){vqRooms[a].attr(show)}else{vqRooms[a].attr(hide)}}}function cvjs_GroupOn_AllOff(b){for(var a in vqRooms){if(vqRooms[a].data("group")==b){vqRooms[a].attr(show)}else{vqRooms[a].attr(hide)}}}function cvjs_GroupOff(b){for(var a in vqRooms){if(vqRooms[a].data("group")==b){vqRooms[a].attr(hide)}}}function cvjs_ApplyPatternOnSpaceObjectId(f,c,b,a,d){var g=cvjs_getSpaceObjectNodefromId(c);cvjs__ApplyPatternOnObject_layerSort(f,g,b,a,d,layer_vqrooms,1)}function cvjs_ApplyPatternOnSpaceObjectNode(d,f,b,a,c){cvjs__ApplyPatternOnObject_layerSort(d,f,b,a,c,layer_vqrooms,1)}function cvjs_ApplyPatternOnUrl(d,f,b,a,c){cvjs__ApplyPatternOnObject_layerSort(d,f,b,a,c,layer_vqrooms,2)}function cvjs__ApplyPatternOnObject_layerSort(H,t,y,d,A,z,I){var x;var B=false;if(I==1){for(spc in vqRooms){if(vqRooms[spc].data("node")==t){x=vqRooms[spc];B=true}}}if(I==2){for(spc in vqURLs){if(vqURLs[spc].data("node")==t){x=vqURLs[spc];B=true}}}if(!B){return}var j=x.toString();var a;var s=true;var f;var b;var v;if(j.indexOf("path")>-1){s=true;var g=j.indexOf(" d=");var E=j.substring(g+4);var u=E.indexOf('" ');a=E.substring(0,u)}if(j.indexOf("circle")>-1){s=false;var q=j.indexOf(" cx=");var G=j.substring(q+5);var n=G.indexOf('"');f=G.substring(0,n);var p=j.indexOf(" cy=");var F=j.substring(p+5);var h=F.indexOf('"');b=F.substring(0,h);var D=j.indexOf(" r=");var c=j.substring(D+4);var m=c.indexOf('"');v=c.substring(0,m)}if(y=="pattern_45degree_standard"||y=="pattern_45degree_fine"||y=="pattern_45degree_wide"||y=="pattern_90degree_standard"||y=="pattern_90degree_fine"||y=="pattern_90degree_wide"||y=="pattern_135degree_standard"||y=="pattern_135degree_fine"||y=="pattern_135degree_wide"||y=="pattern_0degree_standard"||y=="pattern_0degree_fine"||y=="pattern_0degree_wide"||y=="pattern_45degree_crosshatch_standard"||y=="pattern_45degree_crosshatch_fine"){var C;if(y=="pattern_45degree_standard"){cvjs_setUpPattern_45degree_standard(d,"1.0");C=pattern_45degree_standard}if(y=="pattern_45degree_fine"){cvjs_setUpPattern_45degree_fine(d,"1.0");C=pattern_45degree_standard}if(y=="pattern_45degree_wide"){cvjs_setUpPattern_45degree_wide(d,"1.0");C=pattern_45degree_standard}if(y=="pattern_90degree_standard"){cvjs_setUpPattern_90degree_standard(d,"1.0");C=pattern_90degree_standard}if(y=="pattern_90degree_fine"){cvjs_setUpPattern_90degree_fine(d,"1.0");C=pattern_90degree_standard}if(y=="pattern_90degree_wide"){cvjs_setUpPattern_90degree_wide(d,"1.0");C=pattern_90degree_standard}if(y=="pattern_135degree_standard"){cvjs_setUpPattern_135degree_standard(d,"1.0");C=pattern_135degree_standard}if(y=="pattern_135degree_fine"){cvjs_setUpPattern_135degree_fine(d,"1.0");C=pattern_135degree_standard}if(y=="pattern_135degree_wide"){cvjs_setUpPattern_135degree_wide(d,"1.0");C=pattern_135degree_standard}if(y=="pattern_0degree_standard"){cvjs_setUpPattern_0degree_standard(d,"1.0");C=pattern_0degree_standard}if(y=="pattern_0degree_fine"){cvjs_setUpPattern_0degree_fine(d,"1.0");C=pattern_0degree_standard}if(y=="pattern_0degree_wide"){cvjs_setUpPattern_0degree_wide(d,"1.0");C=pattern_0degree_standard}if(y=="pattern_45degree_crosshatch_standard"){cvjs_setUpPattern_45degree_crosshatch_standard(d,"1.0");C=pattern_45degree_crosshatch}if(y=="pattern_45degree_crosshatch_fine"){cvjs_setUpPattern_45degree_crosshatch_fine(d,"1.0");C=pattern_45degree_crosshatch}if(s){var l=rPaper.path(a);l.attr({fill:C,"fill-opacity":A,stroke:d,"stroke-opacity":A});H.add(l)}else{var o=rPaper.circle(f,b,v,v);window.alert(o);H.add(o.attr({fill:C,"fill-opacity":A,stroke:d,"stroke-opacity":A}))}try{z.prepend(H)}catch(k){var w=0}return 1}return -1}var pattern_45degree_standard=null;var pattern_90degree_standard=null;var pattern_135degree_standard=null;var pattern_0degree_standard=null;var pattern_45degree_crosshatch=null;function cvjs_setUpPattern_45degree_standard(a,b){pattern_45degree_standard=rPaper.path("M10-5-10,15M15,0,0,15M0-5-20,15").attr({fill:"none",stroke:a,strokeWidth:2,"stroke-opacity":b}).pattern(0,0,10,10)}function cvjs_setUpPattern_45degree_wide(a,b){pattern_45degree_standard=rPaper.path("M10-5-10,15M15,0,0,15M0-5-20,15").attr({fill:"none",stroke:a,strokeWidth:5,"stroke-opacity":b}).pattern(0,0,10,10)}function cvjs_setUpPattern_45degree_fine(a,b){pattern_45degree_standard=rPaper.path("M10-5-10,15M15,0,0,15M0-5-20,15").attr({fill:"none",stroke:a,strokeWidth:0.5,"stroke-opacity":b}).pattern(0,0,10,10)}function cvjs_setUpPattern_90degree_fine(a,b){pattern_90degree_standard=rPaper.path("M10-5 10,15M15,0,15,15M0-5 0,15").attr({fill:"none",stroke:a,strokeWidth:0.5,"stroke-opacity":b}).pattern(0,0,10,10)}function cvjs_setUpPattern_90degree_standard(a,b){pattern_90degree_standard=rPaper.path("M10-5 10,15M15,0,15,15M0-5 0,15").attr({fill:"none",stroke:a,strokeWidth:2,"stroke-opacity":b}).pattern(0,0,10,10)}function cvjs_setUpPattern_90degree_wide(a,b){pattern_90degree_standard=rPaper.path("M10-5 10,15M15,0,15,15M0-5 0,15").attr({fill:"none",stroke:a,strokeWidth:5,"stroke-opacity":b}).pattern(0,0,10,10)}function cvjs_setUpPattern_135degree_standard(a,b){pattern_135degree_standard=rPaper.path("M0-5 20,15M10,-5,30,15M-10-5 10,15").attr({fill:"none",stroke:a,strokeWidth:2,"stroke-opacity":b}).pattern(0,0,10,10)}function cvjs_setUpPattern_135degree_wide(a,b){pattern_135degree_standard=rPaper.path("M0-5 20,15M10,-5,30,15M-10-5 10,15").attr({fill:"none",stroke:a,strokeWidth:5,"stroke-opacity":b}).pattern(0,0,10,10)}function cvjs_setUpPattern_135degree_fine(a,b){pattern_135degree_standard=rPaper.path("M0-5 20,15M10,-5,30,15M-10-5 10,15").attr({fill:"none",stroke:a,strokeWidth:0.5,"stroke-opacity":b}).pattern(0,0,10,10)}function cvjs_setUpPattern_0degree_standard(a,b){pattern_0degree_standard=rPaper.path("M-5,0,15,0M-5,10,15,10M-5,20,15,20").attr({fill:"none",stroke:a,strokeWidth:2,"stroke-opacity":b}).pattern(0,0,10,10)}function cvjs_setUpPattern_0degree_wide(a,b){pattern_0degree_standard=rPaper.path("M-5,0,15,0M-5,10,15,10M-5,20,15,20").attr({fill:"none",stroke:a,strokeWidth:5,"stroke-opacity":b}).pattern(0,0,10,10)}function cvjs_setUpPattern_0degree_fine(a,b){pattern_0degree_standard=rPaper.path("M-5,0,15,0M-5,10,15,10M-5,20,15,20").attr({fill:"none",stroke:a,strokeWidth:0.5,"stroke-opacity":b}).pattern(0,0,10,10)}function cvjs_setUpPattern_45degree_crosshatch_standard(a,b){pattern_45degree_crosshatch=rPaper.path("M0-5 20,15M10,-5,30,15M-10-5 10,15M10-5-10,15M15,0,0,15M0-5-20,15").attr({fill:"none",stroke:a,strokeWidth:2,"stroke-opacity":b}).pattern(0,0,10,10)}function cvjs_setUpPattern_45degree_crosshatch_fine(a,b){pattern_45degree_crosshatch=rPaper.path("M0-5 20,15M10,-5,30,15M-10-5 10,15M10-5-10,15M15,0,0,15M0-5-20,15").attr({fill:"none",stroke:a,strokeWidth:0.5,"stroke-opacity":b}).pattern(0,0,10,10)}var linear_gradient;function cvjs_ApplyRelativeLinearGradientStandard2Colors(b,d,c,a){cvjs_ApplyRelativeLinearGradient(b,0,0,1,1,d,"",c,a)}function cvjs_ApplyRelativeLinearGradientStandard3Colors(b,f,d,c,a){cvjs_ApplyRelativeLinearGradient(b,0,0,1,1,f,d,c,a)}function cvjs_ApplyRelativeLinearGradient(c,f,k,a,j,d,g,b,h){if(g==""){linear_gradient=rPaper.gradient("l("+f+", "+k+", "+a+" ,"+j+" )"+d+"-"+b)}else{linear_gradient=rPaper.gradient("l("+f+", "+k+", "+a+" ,"+j+" )"+d+"-"+g+"-"+b)}c.attr({fill:linear_gradient,"fill-opacity":h,"stroke-opacity":h})}function cvjs_ApplyRelativeLinearGradientStandard2ColorsOnSpaceObjectId(c,a,f,d,b){var g=cvjs_getSpaceObjectNodefromId(a);cvjs_ApplyRelativeLinearGradientOnObject_layerSort(c,g,0,0,1,1,f,"",d,b,layer_vqrooms)}function cvjs_ApplyRelativeLinearGradientStandard2ColorsOnSpaceObjectNode(b,f,d,c,a){cvjs_ApplyRelativeLinearGradientOnObject_layerSort(b,f,0,0,1,1,d,"",c,a,layer_vqrooms)}function cvjs_ApplyRelativeLinearGradientStandard3ColorsOnSpaceObjectId(c,a,g,f,d,b){var h=cvjs_getSpaceObjectNodefromId(a);cvjs_ApplyRelativeLinearGradientOnObject_layerSort(c,h,0,0,1,1,g,f,d,b,layer_vqrooms)}function cvjs_ApplyRelativeLinearGradientStandard3ColorsOnSpaceObjectNode(b,g,f,d,c,a){cvjs_ApplyRelativeLinearGradientOnObject_layerSort(b,g,0,0,1,1,f,d,c,a,layer_vqrooms)}function cvjs_ApplyRelativeLinearGradientOnObject_layerSort(L,w,o,u,s,x,D,n,z,F,E){var C;var G=false;for(spc in vqRooms){if(vqRooms[spc].data("node")==w){C=vqRooms[spc];G=true}}if(!G){return}var h=C.toString();var a;var v=true;var d;var b;var A;if(h.indexOf("path")>-1){v=true;var f=h.indexOf(" d=");var I=h.substring(f+4);var y=I.indexOf('" ');a=I.substring(0,y)}if(h.indexOf("circle")>-1){v=false;var t=h.indexOf(" cx=");var K=h.substring(t+5);var m=K.indexOf('"');d=K.substring(0,m);var q=h.indexOf(" cy=");var J=h.substring(q+5);var g=J.indexOf('"');b=J.substring(0,g);var H=h.indexOf(" r=");var c=h.substring(H+4);var l=c.indexOf('"');A=c.substring(0,l)}if(n==""){linear_gradient=rPaper.gradient("l("+o+", "+u+", "+s+" ,"+x+" )"+D+"-"+z)}else{linear_gradient=rPaper.gradient("l("+o+", "+u+", "+s+" ,"+x+" )"+D+"-"+n+"-"+z)}if(v){var k=rPaper.path(a);k.attr({fill:linear_gradient,"fill-opacity":F,"stroke-opacity":F});L.add(k)}else{var p=rPaper.circle(d,b,A,A);p.attr({fill:linear_gradient,"fill-opacity":F,"stroke-opacity":F});L.add(p)}try{E.prepend(L);return 1}catch(j){var B=0}return -1}var radial_gradient;function cvjs_ApplyRelativeRadialGradientStandard2Colors(b,d,c,a){cvjs_ApplyRelativeRadialGradient(b,0.5,0.5,0.5,d,"",c,a)}function cvjs_ApplyRelativeRadialGradientStandard3Colors(b,f,d,c,a){cvjs_ApplyRelativeRadialGradient(b,0.5,0.5,0.5,f,d,c,a)}function cvjs_ApplyRelativeRadialGradient(c,g,j,a,h,f,d,b){if(f==""){radial_gradient=rPaper.gradient("r("+g+", "+j+", "+a+" )"+h+"-"+d)}else{radial_gradient=rPaper.gradient("r("+g+", "+j+", "+a+" )"+h+"-"+f+"-"+d)}c.attr({fill:radial_gradient,"fill-opacity":b,"stroke-opacity":b});window.alert("after "+c)}function cvjs_ApplyRelativeRadialGradientStandard2ColorsOnSpaceObjectId(c,a,f,d,b){var g=cvjs_getSpaceObjectNodefromId(a);cvjs_ApplyRelativeRadialGradientOnObject_layerSort(c,g,0.5,0.5,0.5,f,"",d,b,layer_vqrooms)}function cvjs_ApplyRelativeRadialGradientStandard2ColorsOnSpaceObjectNode(b,f,d,c,a){cvjs_ApplyRelativeRadialGradientOnObject_layerSort(b,f,0.5,0.5,0.5,d,"",c,a,layer_vqrooms)}function cvjs_ApplyRelativeRadialGradientStandard3ColorsOnSpaceObjectId(c,a,g,f,d,b){var h=cvjs_getSpaceObjectNodefromId(a);cvjs_ApplyRelativeRadialGradientOnObject_layerSort(c,h,0.5,0.5,0.5,g,f,d,b,layer_vqrooms)}function cvjs_ApplyRelativeRadialGradientStandard3ColorsOnSpaceObjectNode(b,g,f,d,c,a){cvjs_ApplyRelativeRadialGradientOnObject_layerSort(b,g,0.5,0.5,0.5,f,d,c,a,layer_vqrooms)}function cvjs_ApplyRelativeRadialGradientOnObject_layerSort(J,v,t,E,g,B,o,x,D,C){var A;for(spc in vqRooms){if(vqRooms[spc].data("node")==v){A=vqRooms[spc]}}var j=A.toString();var a;var u=true;var d;var b;var y;if(j.indexOf("path")>-1){u=true;var f=j.indexOf(" d=");var G=j.substring(f+4);var w=G.indexOf('" ');a=G.substring(0,w)}if(j.indexOf("circle")>-1){u=false;var s=j.indexOf(" cx=");var I=j.substring(s+5);var n=I.indexOf('"');d=I.substring(0,n);var q=j.indexOf(" cy=");var H=j.substring(q+5);var h=H.indexOf('"');b=H.substring(0,h);var F=j.indexOf(" r=");var c=j.substring(F+4);var m=c.indexOf('"');y=c.substring(0,m)}if(o==""){radial_gradient=rPaper.gradient("r("+t+", "+E+", "+g+" )"+B+"-"+x)}else{radial_gradient=rPaper.gradient("r("+t+", "+E+", "+g+" )"+B+"-"+o+"-"+x)}if(u){var l=rPaper.path(a);l.attr({fill:radial_gradient,"fill-opacity":D,"stroke-opacity":D});J.add(l)}else{var p=rPaper.circle(d,b,y,y);p.attr({fill:radial_gradient,"fill-opacity":D,"stroke-opacity":D});J.add(p)}try{C.prepend(J);return 1}catch(k){var z=0}return -1}var text_style_arial_11pt_bold={stroke:"#00539B",fill:"#00539B","font-family":"Arial","font-size":"11pt","font-weight":"bold",margin:0,cursor:"pointer","text-align":"left","z-index":1980};var text_style_arial_9pt_normal={stroke:"#00539B",fill:"#00539B","font-family":"Arial","font-size":"9pt","font-weight":"normal",margin:0,"margin-top":"-10px",cursor:"pointer","text-align":"left","vertical-align":"top",width:"128px","z-index":1980};var text_style_dialog={"text-font":"Dialog","font-family":"Dialog","font-size":"7pt","text-anchor":"start","font-weight":"normal","font-style":"italic",stroke:"#88539B",fill:"#88539B"};function setTextStyle(){var a;a={};return a}function cvjs_AddTextOnObject(E,u,n,s,m,G,z,q,l,F,w,p,j,D,v){var B;for(spc in vqRooms){if(vqRooms[spc].data("node")==u){B=vqRooms[spc]}}var k=B.getBBox();var t=k.x;var r=k.y;var C=k.width;var A=k.height;var H;var h;var f;var c;var a;var g;var d;var b;var o;H=t+C*n;g=A*G;h=r+g*1.05;f=rPaper.text(H,h,s).attr(m);f.attr({"font-size":g});o=g/15;f.attr({"stroke-width":o});f.attr({stroke:z});f.attr({fill:z});d=A*F;h=r+d*1.05+g*1.05;c=rPaper.text(H,h,q).attr(l);c.attr({"font-size":d});o=d/15;c.attr({"stroke-width":o});c.attr({stroke:w});c.attr({fill:w});b=A*D;h=r+b*1.05+d*1.05+g*1.05;a=rPaper.text(H,h,p).attr(j);a.attr({"font-size":b});o=b/15;a.attr({"stroke-width":o});a.attr({stroke:v});a.attr({fill:v});E.add(f);E.add(c);E.add(a)}function cvjs_AddTextAndTBorderOnSpaceObject3Lines(l,ac,o,H,R,ai,O,p,V,Q,ah,N,n,U,P,ag,M,m,T){var al;var k=0;var ad=0;var S=false;for(k in vqRooms){if(vqRooms[k].data("node")==ac){al=vqRooms[k];ad=k;S=true}}if(!S){return}var G=al.toString();var t;var ae=true;var J;var I;var Z;if(G.indexOf("path")>-1){ae=true;var j=G.indexOf(" d=");var B=G.substring(j+4);var af=B.indexOf('" ');t=B.substring(0,af)}if(G.indexOf("circle")>-1){ae=false;var F=G.indexOf(" cx=");var h=G.substring(F+5);var v=h.indexOf('"');J=h.substring(0,v);var E=G.indexOf(" cy=");var g=G.substring(E+5);var u=g.indexOf('"');I=g.substring(0,u);var aa=G.indexOf(" r=");var A=G.substring(aa+4);var ak=A.indexOf('"');Z=A.substring(0,ak)}var Y=al.toString();var K=al.getBBox();var X=K.x;var W=K.y;var a=K.width;var d=K.height;var w;var am;var D;var C;var z;var f;var c;var b;var aj;w=X+a*H;f=d*p;am=W+f*1.05;D=rPaper.text(w,am,ai).attr(O);D.attr({"font-size":f});aj=f/15;D.attr({"stroke-width":aj,"stroke-opacity":"1"});D.attr({stroke:V});D.attr({fill:V});vqText.push(D.data("node",R));var L=vqText.length;if(L>0){L--}vqText[L].data("name",R);vqText[L].data("id",R);vqText[L].data("layer",l);c=d*n;am=W+c*1.05+f*1.05;C=rPaper.text(w,am,ah).attr(N);C.attr({"font-size":c});aj=c/15;C.attr({"stroke-width":aj,"stroke-opacity":"1"});C.attr({stroke:U});C.attr({fill:U});vqText.push(C.data("node",Q));L=vqText.length;if(L>0){L--}vqText[L].data("name",Q);vqText[L].data("id",Q);vqText[L].data("layer",l);b=d*m;am=W+b*1.05+c*1.05+f*1.05;z=rPaper.text(w,am,ag).attr(M);z.attr({"font-size":b});aj=b/15;z.attr({"stroke-width":aj,"stroke-opacity":"1"});z.attr({stroke:T});z.attr({fill:T});vqText.push(z.data("node",P));L=vqText.length;if(L>0){L--}vqText[L].data("name",P);vqText[L].data("id",P);vqText[L].data("layer",l);var s=[];s[0]=R;s[1]=Q;s[2]=P;if(ae){var ab=rPaper.group(rPaper.path(t),D,C,z).data("node",o);vqTBorder.push(ab);var q=vqTBorder.length;if(q>0){q--}vqTBorder[q].data("name",o);vqTBorder[q].data("id",o);vqTBorder[q].data("layer",o);vqTBorder[q].attr(show).attr({fill:"none","stoke-width":"0.01",stroke:"#000000","stroke-opacity":"0.01"})}else{return -1}vqRooms[ad].data("tborderId",o);vqRooms[ad].data("textId",s)}function cvjs_AddTextAndTBorderOnSpaceObjectId(c,d,h,g,j,l,k,a){var b=cvjs_getSpaceObjectNodefromId(d);var f=vqTBorder.length;f++;var n="TBORDER_"+f;var m=new Array();for(ii in g){m[ii]="TEXT_"+n+"_"+(ii+1)}cvjs_AddTextAndTBorderOnSpaceObject(c,b,n,h,m,g,j,l,k,a)}function cvjs_AddTextAndTBorderOnSpaceObjectNode(c,b,g,f,h,k,j,a){var d=vqTBorder.length;d++;var m="TBORDER_"+d;var l=new Array();for(ii in f){l[ii]="TEXT_"+m+"_"+(ii+1)}cvjs_AddTextAndTBorderOnSpaceObject(c,b,m,g,l,f,h,k,j,a)}function cvjs_AddTextAndTBorderOnSpaceObject(k,W,n,H,O,B,l,K,S,C){var ac;var j=0;var X=0;var N=false;for(j in vqRooms){if(vqRooms[j].data("node")==W){ac=vqRooms[j];X=j;N=true}}if(!N){return}var G=ac.toString();var q;var Y=true;var J;var I;var T;var p;if(G.indexOf("path")>-1){Y=true;var h=G.indexOf(" d=");var w=G.substring(h+4);var aa=w.indexOf('" ');q=w.substring(0,aa);p=q}if(G.indexOf("circle")>-1){Y=false;var F=G.indexOf(" cx=");var g=G.substring(F+5);var t=g.indexOf('"');J=g.substring(0,t);var D=G.indexOf(" cy=");var f=G.substring(D+5);var s=f.indexOf('"');I=f.substring(0,s);var U=G.indexOf(" r=");var z=G.substring(U+4);var ad=z.indexOf('"');T=z.substring(0,ad)}var R=ac.toString();var L=ac.getBBox();var Q=L.x;var P=L.y;var a=L.width;var d=L.height;var m;var A;var v;var E=0;var c;var b;var ab;var V=rPaper.group(rPaper.path(q)).data("node",n);var u=Q;var ae=P;for(i=0;i<O.length;i++){var Z;if(C){Z=rPaper.path(p);Z.attr({fill:"#FFFFFF","fill-opacity":"1"})}u=Q+a*H;E=d*K[i];ae+=E*1.05;m=rPaper.text(u,ae,B[i]).attr(l[i]);m.attr({"font-size":E});ab=E/15;m.attr({"stroke-width":ab,"stroke-opacity":"1"});m.attr({stroke:S[i]});m.attr({fill:S[i]});if(C){m.attr({mask:Z})}m.attr({"pointer-events":"none"});vqText.push(m.data("node",O[i]));var M=vqText.length;if(M>0){M--}vqText[M].data("name",O[i]);vqText[M].data("id",O[i]);vqText[M].data("layer",k);V.add(m)}if(Y){vqTBorder.push(V);var o=vqTBorder.length;if(o>0){o--}vqTBorder[o].data("name",n);vqTBorder[o].data("id",n);vqTBorder[o].data("layer",n);vqTBorder[o].attr(show).attr({fill:"none","stoke-width":"0.01",stroke:"#000000","stroke-opacity":"0.01"})}else{return -1}vqRooms[X].data("tborderId",n);vqRooms[X].data("textId",O)}function cvjs_AddTextOnObjectScaleText(v,n,s,m,B,q,l,A,p,j,w){var k=v.getBBox();var t=k.x;var r=k.y;var z=k.width;var u=k.height;var C;var h;var f;var c;var a;var g;var d;var b;var o;window.alert(t+" "+r+"  "+z+" "+u);C=t+z*n;g=u*B;h=r+g*1.05;f=rPaper.text(C,h,s).attr(m);f.attr({"font-size":g});o=g/15;f.attr({"stroke-width":o});d=u*A;h=r+d*1.05+g*1.05;c=rPaper.text(C,h,q).attr(l);c.attr({"font-size":d});o=d/15;c.attr({"stroke-width":o});b=u*w;h=r+b*1.05+d*1.05+g*1.05;a=rPaper.text(C,h,p).attr(j);a.attr({"font-size":b});o=b/15;a.attr({"stroke-width":o})}var handleGroup;var canvas_width;var canvas_height;var global_scale_X;var global_scale_Y;var global_scale;var delta_x;var delta_y;var cvjs_supressPopUpModal=false;var cvjs_supressHyperlinkColors=false;var cvjs_callbackForModalDisplayVar=false;var cvjs_standardHighLightColors=true;var cvjs_customModalPopUpBody;var cvjs_customModalPopUpBody;var cvjs_populateMyCustomPopUpBody;function cvjs_setCallbackForModalDisplay(b,c,a){cvjs_callbackForModalDisplayVar=b;cvjs_customModalPopUpBody=c;cvjs_populateMyCustomPopUpBody=a}function cvjs_setCreationMode(c){cvjs_supressPopUpModal=c;if(c==true){cvjs_standardHighLightColors=false}else{cvjs_standardHighLightColors=true}if(cvjs_supressPopUpModal==true){for(var b in vqRooms){$(vqRooms[b].node).qtip({content:{text:"",title:""},style:{classes:"qtip-bootstrap qtip-shadow qtip-rounded qtip-zindex"},position:{my:"bottom center",at:"top left"},hideOnHTMLClick:"true"});$(vqRooms[b].node).qtip("destroy")}}else{for(var b in vqRooms){var a='<table width="100%"><tr><td class="cvjs_modal_header_1" onclick="cvjs_popupTitleClick(\''+vqRooms[b].data("id")+"');\">"+vqRooms[b].data("name")+'</td><td class="cvjs_modal_header_info_1" onclick="hideOnlyPop('+b+');"><i class="glyphicon glyphicon-remove"></i></td></tr><tr><td cols="2"><h4 id="cvjs_modal_header_info_2">'+vqRooms[b].data("type")+"</h4></td></tr></table>";if(dual_hbody_flag){if(parseInt(cvjs_currentNode_id)>=-1){$(vqRooms[b].node).qtip({content:{text:hbody,title:a},style:{classes:"qtip-bootstrap qtip-shadow qtip-rounded qtip-zindex"},position:{my:"bottom center",at:"top left"},hideOnHTMLClick:"false"})}else{$(vqRooms[b].node).qtip({content:{text:hbody_2,title:a},style:{classes:"qtip-bootstrap qtip-shadow qtip-rounded qtip-zindex"},position:{my:"bottom center",at:"top left"},hideOnHTMLClick:"false"})}}if(!dual_hbody_flag){$(vqRooms[b].node).qtip({content:{text:hbody,title:a},style:{classes:"qtip-bootstrap qtip-shadow qtip-rounded qtip-zindex"},position:{my:"bottom center",at:"top left"},hideOnHTMLClick:"false"})}}}}function cvjs_setNoModalMode(a){cvjs_supressPopUpModal=a;if(a==true){cvjs_standardHighLightColors=true}else{cvjs_standardHighLightColors=true}if(cvjs_supressPopUpModal==true){for(var c in vqRooms){$(vqRooms[c].node).qtip({content:{text:"",title:""},style:{classes:"qtip-bootstrap qtip-shadow qtip-rounded qtip-zindex"},position:{my:"bottom center",at:"top left"},hideOnHTMLClick:"true"});$(vqRooms[c].node).qtip("destroy")}}else{for(var c in vqRooms){var b='<table width="100%"><tr><td class="cvjs_modal_header_1" onclick="cvjs_popupTitleClick(\''+vqRooms[c].data("id")+"');\">"+vqRooms[c].data("name")+'</td><td class="cvjs_modal_header_info_1" onclick="hideOnlyPop('+c+');"><i class="glyphicon glyphicon-remove"></i></td></tr><tr><td cols="2"><h4 id="cvjs_modal_header_info_2">'+vqRooms[c].data("type")+"</h4></td></tr></table>";if(dual_hbody_flag){if(parseInt(cvjs_currentNode_id)>=-1){$(vqRooms[c].node).qtip({content:{text:hbody,title:b},style:{classes:"qtip-bootstrap qtip-shadow qtip-rounded qtip-zindex"},position:{my:"bottom center",at:"top left"},hideOnHTMLClick:"false"})}else{$(vqRooms[c].node).qtip({content:{text:hbody_2,title:b},style:{classes:"qtip-bootstrap qtip-shadow qtip-rounded qtip-zindex"},position:{my:"bottom center",at:"top left"},hideOnHTMLClick:"false"})}}if(!dual_hbody_flag){$(vqRooms[c].node).qtip({content:{text:hbody,title:b},style:{classes:"qtip-bootstrap qtip-shadow qtip-rounded qtip-zindex"},position:{my:"bottom center",at:"top left"},hideOnHTMLClick:"false"})}}}}var cvjs_currentNode_underbar="NODE_";var cvjs_currentNode_name="unassigned";var cvjs_currentNode_id="unassigned";var cvjs_currentNode_layer="unassigned";var cvjs_currentNode_group="unassigned";var cvjs_currentNode_attributes="unassigned";var cvjs_currentNode_attributeStatus="unassigned";var cvjs_currentNode_occupancy="unassigned";var cvjs_currentNode_type="unassigned";var cvjs_currentNode_tags="unassigned";var cvjs_currentNode_linked=false;var cvjs_currentNode_tborderId="unassigned";var cvjs_currentNode_textId=[];var cvjs_currentStickyNote_underbar="SNOTE_";var cvjs_currentStickyNote_name="unassigned";var cvjs_currentStickyNote_id="unassigned";var cvjs_currentStickyNote_layer="unassigned";var cvjs_currentStickyNote_group="unassigned";var cvjs_currentStickyNote_text="unassigned";var cvjs_currentStickyNote_userid="unassigned";var cvjs_currentStickyNote_date="unassigned";var cvjs_currentStickyNote_linked=true;var cvjs_currentStickyNote_transform="";var cvjs_currentRedline_underbar="RED_";var cvjs_currentRedline_name="unassigned";var cvjs_currentRedline_id="unassigned";var cvjs_currentRedline_layer="unassigned";var cvjs_currentRedline_group="unassigned";var cvjs_currentRedline_color="#FF0000";var cvjs_currentRedline_strokeWidth=3;var cvjs_currentTBorder_underbar="TBORDER_";var cvjs_currentTBorder_name="unassigned";var cvjs_currentTBorder_id="unassigned";var cvjs_currentTBorder_layer="unassigned";var cvjs_currentTBorder_group="unassigned";var cvjs_currentText_underbar="TEXT_";var cvjs_currentText_name="unassigned";var cvjs_currentText_id="unassigned";var cvjs_currentText_layer="unassigned";var cvjs_currentText_group="unassigned";var cvjs_currentUrl_underbar="URL_";var cvjs_currentUrl_name="unassigned";var cvjs_currentUrl_id="unassigned";var cvjs_currentUrl_comment="unassigned";var cvjs_currentUrl_url="unassigned";var cvjs_currentUrl_layer="unassigned";var cvjs_currentUrl_group="unassigned";var cvjs_currentUrl_linked=true;var cvjsStickyNoteBody='<table id="note_table">';cvjsStickyNoteBody+="<tr>";cvjsStickyNoteBody+="<td>";cvjsStickyNoteBody+='<div class="cvjs_stickynotes_text_1" onclick="cvjs_edit_note();">Text NOT initialized!</div>';cvjsStickyNoteBody+="</td>";cvjsStickyNoteBody+="</tr>";cvjsStickyNoteBody+="</table>";function cvjs_setStickyNoteText(a){cvjsStickyNoteBody='<table id="note_table">';cvjsStickyNoteBody+="<tr>";cvjsStickyNoteBody+="<td>";cvjsStickyNoteBody+='<div class="cvjs_stickynotes_text_1" onclick="cvjs_edit_note();">'+a+"</div>";cvjsStickyNoteBody+="</td>";cvjsStickyNoteBody+="</tr>";cvjsStickyNoteBody+="</table>"}function cvjs_setStickyNoteEditText(a){cvjsStickyNoteBody='<table id="note_table">';cvjsStickyNoteBody+="<tr>";cvjsStickyNoteBody+="<td>";cvjsStickyNoteBody+='<textarea class="cvjs_stickynotes_edit_text_1" id="sNote_text" cols="33" rows="3">'+a+"</textarea>";cvjsStickyNoteBody+="</td>";cvjsStickyNoteBody+="</tr>";cvjsStickyNoteBody+="</table>"}$("#stickyNoteSelectIcon").mouseover(function(){tip.css("left",e.clientX+document.body.scrollLeft+20).css("top",e.clientY+document.body.scrollTop-20);tip.html(tipText);tip.show()});var StickNoteQtipDiv="";function cvjs_showStickynoteTip(b,d,a){var f;var c="#"+StickNoteQtipDiv;var g=$(c).position();if(d==1){f=$("#stickyNoteIcon1").position()}if(d==2){f=$("#stickyNoteIcon2").position()}if(d==3){f=$("#stickyNoteIcon3").position()}if(d==4){f=$("#stickyNoteIcon4").position()}tip.css("left",g.left+f.left).css("top",g.top+f.top-35);tip.html(b);tip.show();if(d==3&&b.indexOf("Inactive")==-1){$("#stickyNoteIcon3").css("color","#FB5300")}}function noteIconChangeHighlight(b,a){if(b==3){$("#stickyNoteIcon3").css("color",a)}tip.hide()}var StickNoteEditMode=false;function cvjs_edit_note(){var g=cvjs_StickyNoteClicked();var b=cvjs_StickyNotes_arrayIndex(g);if(StickNoteEditMode==false){var a=vqStickyNotes[b].data("text");a=a.replace(/(<br>)/gm,"\n");cvjs_setStickyNoteEditText(a);var f='<table width="100%"><tr><td cols="3"><div class="cvjs_modal_header_stickynote_info_2">#'+vqStickyNotes[b].data("id")+'</div><td class="cvjs_modal_header_stickynote_info_2_background"></td><td class="cvjs_modal_header_1" >'+vqStickyNotes[b].data("name")+'</td><td class="cvjs_modal_header_sticky_note_info_1_nonselect" id="stickyNoteIcon1" onmouseout="javascript:tip.hide();" onmouseover="javascript:cvjs_showStickynoteTip(\'Inactive\',1,'+b+');" ><i class="glyphicon glyphicon-move"></i></td><td class="cvjs_modal_header_sticky_note_info_1_select" id="stickyNoteIcon2" onmouseout="javascript:tip.hide();" onclick="cvjs_edit_note();" onmouseover="javascript:cvjs_showStickynoteTip(\'Save Note\',2,'+b+');" ><i class="glyphicon glyphicon-edit"></i></td><td class="cvjs_modal_header_sticky_note_info_1_nonselect" id="stickyNoteIcon3" onmouseout="javascript:tip.hide();" onmouseover="javascript:cvjs_showStickynoteTip(\'Inactive\',3,'+b+');" ><i class="glyphicon glyphicon-trash"></i></td><td class="cvjs_modal_header_sticky_note_info_2_select" id="stickyNoteIcon4" onclick="hideOnlyStickyNote('+b+');" onmouseout="javascript:tip.hide();" onmouseover="javascript:cvjs_showStickynoteTip(\'Cancel Edit Note\',4,'+b+');" ><i class="glyphicon glyphicon-remove"></i></td></tr></table>';$(vqStickyNotes[b].node).qtip({content:{text:cvjsStickyNoteBody,title:f},style:{classes:"qtip-bootstrap qtip-shadow qtip-rounded qtip-zindex"},position:{my:"bottom center",at:"top left"},hideOnHTMLClick:"false"});$(vqStickyNotes[b].node).qtip("show");StickNoteEditMode=true;var d=document.getElementsByTagName("div");for(var c=0;c<d.length;c++){if(((d[c].id).indexOf("qtip-")>-1)&&((d[c].id).indexOf("-content")==-1)&&((d[c].id).indexOf("-title")==-1)){StickNoteQtipDiv=d[c].id}}}else{tip.hide();var a=$("#sNote_text").val();a=a.replace(/(\r\n|\n|\r)/gm,"<br>");vqStickyNotes[b].data("text",a);cvjs_setStickyNoteText(a);var f='<table width="100%"><tr><td cols="3"><div class="cvjs_modal_header_stickynote_info_2">#'+vqStickyNotes[b].data("id")+'</div><td class="cvjs_modal_header_stickynote_info_2_background"></td><td class="cvjs_modal_header_1" >'+vqStickyNotes[b].data("name")+'</td><td class="cvjs_modal_header_sticky_note_info_1" id="stickyNoteIcon1" onclick="cvjs_move_note();" onmouseout="javascript:tip.hide();" onmouseover="javascript:cvjs_showStickynoteTip(\'Move Note\',1,'+b+');" ><i class="glyphicon glyphicon-move"></i></td><td class="cvjs_modal_header_sticky_note_info_1" id="stickyNoteIcon2" onclick="cvjs_edit_note();" onmouseout="javascript:tip.hide();" onmouseover="javascript:cvjs_showStickynoteTip(\'Edit Note\',2,'+b+');" ><i class="glyphicon glyphicon-edit"></i></td><td class="cvjs_modal_header_sticky_note_info_1" id="stickyNoteIcon3" onclick="cvjs_delete_note();" onmouseout="javascript:noteIconChangeHighlight(3,\'#00539B\');" onmouseover="javascript:cvjs_showStickynoteTip(\'Delete Note\',3,'+b+');" ><i class="glyphicon glyphicon-trash"></i></td><td class="cvjs_modal_header_sticky_note_info_2" id="stickyNoteIcon4" onclick="hideOnlyStickyNote('+b+');" onmouseout="javascript:tip.hide();" onmouseover="javascript:cvjs_showStickynoteTip(\'Minimize Note\',4,'+b+');" ><i class="glyphicon glyphicon-remove"></i></td></tr></table>';$(vqStickyNotes[b].node).qtip({content:{text:cvjsStickyNoteBody,title:f},style:{classes:"qtip-bootstrap qtip-shadow qtip-rounded qtip-zindex"},position:{my:"bottom center",at:"top left"},hideOnHTMLClick:"false"});$(vqStickyNotes[b].node).qtip("show");StickNoteEditMode=false;var d=document.getElementsByTagName("div");for(var c=0;c<d.length;c++){if(((d[c].id).indexOf("qtip-")>-1)&&((d[c].id).indexOf("-content")==-1)&&((d[c].id).indexOf("-title")==-1)){StickNoteQtipDiv=d[c].id}}}}function cvjs_move_note(){var b=cvjs_StickyNoteClicked();var a=cvjs_StickyNotes_arrayIndex(b);$(vqStickyNotes[a].node).qtip("hide");vqStickyNotes[a].attr({"fill-opacity":"0.1","stroke-opacity":"0.3"});tip.hide();cvjs_addHandleFunc_MoveStickyNote()}function cvjs_delete_note(){var a=cvjs_StickyNoteClicked();cvjs_setUpStickyNotes_deleteNode(a)}function cvjs_currentMaxNodeId(){var a=0;for(spc in vqRooms){var c=vqRooms[spc].data("node");var c=c.substring(5);var b=parseInt(c);if(b>a){a=b}}return a}function cvjs_currentMaxSpaceNodeId(){var a=0;for(spc in vqRooms){var c=vqRooms[spc].data("node");var c=c.substring(5);var b=parseInt(c);if(b>a){a=b}}return a}function cvjs_setCurrentNodeValues(f,g,k,d,j,a,b,m,c,h,l){cvjs_currentNode_underbar=f;cvjs_currentNode_name=g;cvjs_currentNode_id=k;cvjs_currentNode_layer=d;cvjs_currentNode_group=j;cvjs_currentNode_attributes=a;cvjs_currentNode_attributeStatus=b;cvjs_currentNode_type=m;cvjs_currentNode_tags=c;cvjs_currentNode_occupancy=h;cvjs_currentNode_linked=l}function cvjs_setCurrentSpaceObjectNodeValues(f,g,k,d,j,a,b,m,c,h,l){cvjs_currentNode_underbar=f;cvjs_currentNode_name=g;cvjs_currentNode_id=k;cvjs_currentNode_layer=d;cvjs_currentNode_group=j;cvjs_currentNode_attributes=a;cvjs_currentNode_attributeStatus=b;cvjs_currentNode_type=m;cvjs_currentNode_tags=c;cvjs_currentNode_occupancy=h;cvjs_currentNode_linked=l}function cvjs_setCurrentStickyNoteValues(a,g,f,b,h,d,j,k,c){cvjs_currentStickyNote_underbar=a;cvjs_currentStickyNote_name=g;cvjs_currentStickyNote_id=f;cvjs_currentStickyNote_layer=b;cvjs_currentStickyNote_group=h;cvjs_currentStickyNote_text=d;cvjs_currentStickyNote_userid=j;cvjs_currentStickyNote_date=k;cvjs_currentStickyNote_linked=c}function cvjs_setCurrentRedlineValues(h,a,c,f,g,b,d){cvjs_currentRedline_underbar=h;cvjs_currentRedline_name=a;cvjs_currentRedline_id=c;cvjs_currentRedline_layer=f;cvjs_currentRedline_group=g;cvjs_currentRedline_color=b;cvjs_currentRedline_strokeWidth=d}function cvjs_setCurrentNodeValuesFromExistingNode(a){for(spc in vqRooms){var b=vqRooms[spc].data("node");if(b==a){cvjs_currentNode_underbar=a;cvjs_currentNode_name=vqRooms[spc].data("name");cvjs_currentNode_id=vqRooms[spc].data("id");cvjs_currentNode_layer=vqRooms[spc].data("layer");cvjs_currentNode_group=vqRooms[spc].data("group");cvjs_currentNode_attributes=vqRooms[spc].data("attributes");cvjs_currentNode_attributeStatus=vqRooms[spc].data("attributeStatus");cvjs_currentNode_type=vqRooms[spc].data("type");cvjs_currentNode_tags=vqRooms[spc].data("tags");cvjs_currentNode_occupancy=vqRooms[spc].data("occupancy");cvjs_currentNode_linked=vqRooms[spc].data("linked")}}}function cvjs_overwriteNodeValues(j,l,c,g,a,n,h,k,b,o,d){for(spc in vqRooms){var m=vqRooms[spc].data("node");if(m==j){vqRooms[spc].removeData("id");vqRooms[spc].removeData("name");vqRooms[spc].removeData("layer");vqRooms[spc].removeData("group");vqRooms[spc].removeData("attributes");vqRooms[spc].removeData("attributeStatus");vqRooms[spc].removeData("type");vqRooms[spc].removeData("tags");vqRooms[spc].removeData("occupancy");vqRooms[spc].removeData("linked");vqRooms[spc].data("id",l);vqRooms[spc].data("name",c);vqRooms[spc].data("layer",g);vqRooms[spc].data("group",a);vqRooms[spc].data("attributes",n);vqRooms[spc].data("attributeStatus",h);vqRooms[spc].data("type",k);vqRooms[spc].data("tags",b);vqRooms[spc].data("occupancy",o);vqRooms[spc].data("linked",d);if(cvjs_supressPopUpModal==true){$(vqRooms[spc].node).qtip({content:{text:"",title:""},style:{classes:"qtip-bootstrap qtip-shadow qtip-rounded qtip-zindex"},position:{my:"bottom center",at:"top left"},hideOnHTMLClick:"true"});$(vqRooms[spc].node).qtip("destroy")}else{var f='<table width="100%"><tr><td class="cvjs_modal_header_1" onclick="cvjs_popupTitleClick(\''+l+"');\">"+c+'</td><td class="cvjs_modal_header_info_1" onclick="hideOnlyPop('+spc+');"><i class="glyphicon glyphicon-remove"></i></td></tr><tr><td cols="2"><h4 id="cvjs_modal_header_info_2">'+k+"</h4></td></tr></table>";window.alert(f);window.alert(vqRooms[spc]);if(dual_hbody_flag){if(parseInt(l)>=-1){$(vqRooms[spc].node).qtip({content:{text:hbody,title:f},style:{classes:"qtip-bootstrap qtip-shadow qtip-rounded qtip-zindex"},position:{my:"bottom center",at:"top left"},hideOnHTMLClick:"false"})}else{$(vqRooms[spc].node).qtip({content:{text:hbody_2,title:f},style:{classes:"qtip-bootstrap qtip-shadow qtip-rounded qtip-zindex"},position:{my:"bottom center",at:"top left"},hideOnHTMLClick:"false"})}}if(!dual_hbody_flag){$(vqRooms[spc].node).qtip({content:{text:hbody,title:f},style:{classes:"qtip-bootstrap qtip-shadow qtip-rounded qtip-zindex"},position:{my:"bottom center",at:"top left"},hideOnHTMLClick:"false"})}}}}}function cvjs_addVqRoomsGraphics_newNode_polygon(c,a){var b=a.data("node",c);vqRooms.push(b)}function cvjs_addVqRoomsGraphics_newNode_circle(y,u){var j=u.toString();var a="S"+(0.001);u.attr({transform:a,opacity:"1"});u=rPaper.circle(0,0,1,1).attr({stroke:"#000000","stroke-width":"0.01",fill:"none","fill-opacity":"0.01",opacity:"0.01"});var q=j.indexOf(" cx=");var C=j.substring(q+5);var n=C.indexOf('"');var f=C.substring(0,n);var p=j.indexOf(" cy=");var B=j.substring(p+5);var h=B.indexOf('"');var c=B.substring(0,h);var A=j.indexOf(" r=");var d=j.substring(A+4);var l=d.indexOf('"');var v=d.substring(0,l);var z=j.indexOf("transform=");var b=j.substring(z+11);var g=b.indexOf('"');var s=b.substring(0,g);if(s.indexOf("matrix")>-1){var D=j.indexOf("(");var k=j.substring(D+1);var o=k.indexOf(",");var w=k.substring(0,o);v=w;for(var x=0;x<4;x++){D=k.indexOf(",");k=k.substring(D+1)}D=k.indexOf(",");f=k.substring(0,D);k=k.substring(D+1);D=k.indexOf(")");c=k.substring(0,D)}vqRooms.push(rPaper.circle(f,c,v,v).attr({fill:"#ff9999","fill-opacity":"0.5",stroke:"#ff9999","stroke-opacity":"1"}).data("node",y))}function cvjs_addVqStickyNotesGraphics_newNode(c,a){var b=a.data("node",c);vqStickyNotes.push(b)}function cvjs_addVqRedlinesGraphics_newNode(d,a){var b=a.data("node",d);vqRedlines.push(b);var c=vqRedlines.length-1;if(c>=0){vqRedlines[c].data("name",cvjs_currentRedline_name);vqRedlines[c].data("id",cvjs_currentRedline_id);vqRedlines[c].data("layer",cvjs_currentRedline_layer);vqRedlines[c].data("group",cvjs_currentRedline_group);vqRedlines[c].data("color",cvjs_currentRedline_color);vqRedlines[c].data("strokeWidth",cvjs_currentRedline_strokeWidth)}}function cvjs_setUpVqRooms_currentNode(b,m){floorplan_height=$(window).height()*0.9;floorplan_width=$(window).width()*0.9;var g=null;tip=$("#tip");tip.hide().css("left",floorplan_width).css("top",floorplan_height);var l="";var h=false;var n=null;var d=null;try{$.fn.qtip.defaults.show.event="click";$.fn.qtip.defaults.hide.event=null}catch(c){}if(layer_vqrooms==""){layer_vqrooms=b.g()}var a=vqRooms.length-1;rid=vqRooms[a].data("node");if(m==rid){var k=cvjs_currentNode_tags;if(cvjs_currentNode_tags=="unassigned"){vqRooms[a].data("tags","unassigned")}else{var p=1;for(var q in k){var o="tag"+p;var f=k[q];while(f.charAt(0)==" "){f=f.substr(1)}f=f.replace(/ /gi,"&nbsp;");vqRooms[a].data(o,f);p++}}vqRooms[a].data("occupancy",cvjs_currentNode_occupancy);vqRooms[a].data("name",cvjs_currentNode_name);vqRooms[a].data("type",cvjs_currentNode_type);vqRooms[a].data("id",cvjs_currentNode_id);try{vqRooms[a].data("layer",cvjs_currentNode_layer);vqRooms[a].data("group",cvjs_currentNode_group);vqRooms[a].data("linked",cvjs_currentNode_linked);vqRooms[a].data("attributes",cvjs_currentNode_attributes);vqRooms[a].data("attributeStatus",cvjs_currentNode_attributeStatus)}catch(c){window.alert(c)}if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){vqRooms[a].attr(defaultColor)}else{if(vqRooms[a].data("linked")){vqRooms[a].attr(defaultColor_linked)}else{vqRooms[a].attr(defaultColor_unlinked)}}if(cvjs_supressPopUpModal==true){$(vqRooms[a].node).qtip({content:{text:"",title:""},style:{classes:"qtip-bootstrap qtip-shadow qtip-rounded qtip-zindex"},position:{my:"bottom center",at:"top left"},hideOnHTMLClick:"true"});$(vqRooms[a].node).qtip("destroy")}else{var j='<table width="100%"><tr><td class="cvjs_modal_header_1" onclick="cvjs_popupTitleClick(\''+cvjs_currentNode_id+"');\">"+cvjs_currentNode_name+'</td><td class="cvjs_modal_header_info_1" onclick="hideOnlyPop('+a+');"><i class="glyphicon glyphicon-remove"></i></td></tr><tr><td cols="2"><h4 id="cvjs_modal_header_info_2">'+cvjs_currentNode_type+"</h4></td></tr></table>";if(dual_hbody_flag){if(parseInt(cvjs_currentNode_id)>=-1){$(vqRooms[a].node).qtip({content:{text:hbody,title:j},style:{classes:"qtip-bootstrap qtip-shadow qtip-rounded qtip-zindex"},position:{my:"bottom center",at:"top left"},hideOnHTMLClick:"false"})}else{$(vqRooms[a].node).qtip({content:{text:hbody_2,title:j},style:{classes:"qtip-bootstrap qtip-shadow qtip-rounded qtip-zindex"},position:{my:"bottom center",at:"top left"},hideOnHTMLClick:"false"})}}if(!dual_hbody_flag){$(vqRooms[a].node).qtip({content:{text:hbody,title:j},style:{classes:"qtip-bootstrap qtip-shadow qtip-rounded qtip-zindex"},position:{my:"bottom center",at:"top left"},hideOnHTMLClick:"false"})}}vqRooms[a].mousedown(function(r){vqRoomMouseSelect=true;DoMouseDown(r.clientX+document.body.scrollLeft,r.clientY+document.body.scrollTop)}).mousemove(function(s){currentRoomId=this.data("id");currentRoomName=this.data("name");if((bMouseDown)||(bTempMouseDown)){DoMouseMove(s.clientX+document.body.scrollLeft,s.clientY+document.body.scrollTop)}else{var r=findRoom(currentRoomId);if(r>=0){if(r!=lastObj&&cvjs_location_flag){if(tooltipLast!=lastObj&&tooltipLast!=-1){if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){vqRooms[tooltipLast].attr(defaultColor)}else{if(vqRooms[tooltipLast].data("linked")){vqRooms[tooltipLast].attr(defaultColor_linked)}else{vqRooms[tooltipLast].attr(defaultColor_unlinked)}}}if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){vqRooms[r].attr(highlight)}else{if(vqRooms[r].data("linked")){vqRooms[r].attr(highlight_linked)}else{vqRooms[r].attr(highlight_unlinked)}}tooltipLast=r}}if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){l=this.data("name")}else{l=this.data("id")}if(cvjs_customToolTip){l=cvjs_displayCustomToolTip(this.data("id"))}tip.html(l);tip.show();if(s.clientX>floorplan_width){tip.css("left",s.clientX+document.body.scrollLeft-tip_width-20).css("top",s.clientY+document.body.scrollTop-25)}else{tip.css("left",s.clientX+document.body.scrollLeft+10).css("top",s.clientY+document.body.scrollTop-25)}}}).mouseup(function(s){vqRoomMouseSelect=false;if(bPan){DoMouseUp(s.clientX+document.body.scrollLeft,s.clientY+ocument.body.scrollTop);if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){l=this.data("name")}else{l=this.data("id")}if(cvjs_customToolTip){l=cvjs_displayCustomToolTip(this.data("id"))}tip.html(l);bMouseDown=false;cvjs_clearDrawing();rid=this.data("id");change_space_fixed_location(rid)}else{try{layer_vqrooms.attr(show)}catch(r){}if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){l=this.data("name")}else{l=this.data("id")}if(cvjs_customToolTip){l=cvjs_displayCustomToolTip(this.data("id"))}tip.html(l);bMouseDown=false;cvjs_clearDrawing();rid=this.data("id");change_space_fixed_location(rid)}bPan=false}).touchstart(function(r){DoTouchStart(r,r.clientX+document.body.scrollLeft,r.clientY+document.body.scrollTop)}).touchend(function(s){if((!bPan)&&(!locked)){var r=this.data("id");cvjs_change_space(r);if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){l=this.data("name")}else{l=this.data("id")}if(cvjs_customToolTip){l=cvjs_displayCustomToolTip(this.data("id"))}tip.html(l)}DoTouchEnd(s,s.clientX+document.body.scrollLeft,s.clientY+document.body.scrollTop);if(!cvjs_supressPopUpModal){l=this.data("name")}else{l=this.data("id")}if(cvjs_customToolTip){l=cvjs_displayCustomToolTip(this.data("id"))}tip.html(l);bMouseDown=false;cvjs_clearDrawing();r=this.data("id");change_space_fixed_location(r)}).touchmove(function(r){if(!bPan){tip.css("left",r.clientX+document.body.scrollLeft+20).css("top",r.clientY+document.body.scrollTop-20);tip.html(l);if(cvjs_customToolTip){l=cvjs_displayCustomToolTip(this.data("id"))}}DoTouchMove(r,r.clientX+document.body.scrollLeft,r.clientY+document.body.scrollTop)}).dblclick(function(r){event.preventDefault();event.stopPropagation()})}layer_vqrooms.add(vqRooms[a])}function cvjs_setUpVqStickyNotes_currentNode_vqIndex(a,n,c){floorplan_height=$(window).height()*0.9;floorplan_width=$(window).width()*0.9;var h=null;tip=$("#tip");tip.hide().css("left",floorplan_width).css("top",floorplan_height);var m="";var j=false;var o=null;var g=null;try{$.fn.qtip.defaults.show.event="click";$.fn.qtip.defaults.hide.event=null}catch(d){}if(layer_vqstickynotes==""){layer_vqstickynotes=a.g()}var b=c;var p=vqStickyNotes[b].data("node");if(n==p){vqStickyNotes[b].data("name",cvjs_currentStickyNote_name);vqStickyNotes[b].data("id",cvjs_currentStickyNote_id);vqStickyNotes[b].data("text",cvjs_currentStickyNote_text);try{vqStickyNotes[b].data("layer",cvjs_currentStickyNote_layer);vqStickyNotes[b].data("group",cvjs_currentStickyNote_group);vqStickyNotes[b].data("linked",cvjs_currentStickyNote_linked);vqStickyNotes[b].data("userid",cvjs_currentStickyNote_userid);vqStickyNotes[b].data("date",cvjs_currentStickyNote_date);vqStickyNotes[b].data("transform",cvjs_currentStickyNote_transform)}catch(d){window.alert(d)}if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){vqStickyNotes[b].attr(defaultColor_StickyNotes)}else{if(vqStickyNotes[b].data("linked")){vqStickyNotes[b].attr(defaultColor_linked)}else{vqStickyNotes[b].attr(defaultColor_unlinked)}}if(cvjs_supressPopUpModal==true){$(vqStickyNotes[b].node).qtip({content:{text:"",title:""},style:{classes:"qtip-bootstrap qtip-shadow qtip-rounded qtip-zindex"},position:{my:"bottom center",at:"top left"},hideOnHTMLClick:"true"});$(vqStickyNotes[b].node).qtip("destroy")}else{var l='<table width="100%"><tr><td cols="3"><div class="cvjs_modal_header_stickynote_info_2">#'+cvjs_currentStickyNote_id+'</div><td class="cvjs_modal_header_stickynote_info_2_background"></td><td class="cvjs_modal_header_1" >'+cvjs_currentStickyNote_name+'</td><td class="cvjs_modal_header_sticky_note_info_1" id="stickyNoteIcon1" onclick="cvjs_move_note();" onmouseout="javascript:tip.hide();" onmouseover="javascript:cvjs_showStickynoteTip(\'Move Note\',1,'+b+');" ><i class="glyphicon glyphicon-move"></i></td><td class="cvjs_modal_header_sticky_note_info_1" id="stickyNoteIcon2" onclick="cvjs_edit_note();" onmouseout="javascript:tip.hide();" onmouseover="javascript:cvjs_showStickynoteTip(\'Edit Note\',2,'+b+');" ><i class="glyphicon glyphicon-edit"></i></td><td class="cvjs_modal_header_sticky_note_info_1" id="stickyNoteIcon3" onclick="cvjs_delete_note();" onmouseout="javascript:noteIconChangeHighlight(3,\'#00539B\');" onmouseover="javascript:cvjs_showStickynoteTip(\'Delete Note\',3,'+b+');" ><i class="glyphicon glyphicon-trash"></i></td><td class="cvjs_modal_header_sticky_note_info_2" id="stickyNoteIcon4" onclick="hideOnlyStickyNote('+b+');" onmouseout="javascript:tip.hide();" onmouseover="javascript:cvjs_showStickynoteTip(\'Minimize Note\',4,'+b+');" ><i class="glyphicon glyphicon-remove"></i></td></tr></table>';cvjs_setStickyNoteText(cvjs_currentStickyNote_text);$(vqStickyNotes[b].node).qtip({content:{text:cvjsStickyNoteBody,title:l},style:{classes:"qtip-bootstrap qtip-shadow qtip-rounded qtip-zindex"},position:{my:"bottom center",at:"top left"},hideOnHTMLClick:"false"});var k=document.getElementsByTagName("div");for(var f=0;f<k.length;f++){if(((k[f].id).indexOf("qtip-")>-1)&&((k[f].id).indexOf("-content")==-1)&&((k[f].id).indexOf("-title")==-1)){StickNoteQtipDiv=k[f].id}}}vqStickyNotes[b].mousedown(function(q){vqRoomMouseSelect=true;DoMouseDown(q.clientX+document.body.scrollLeft,q.clientY+document.body.scrollTop)}).mousemove(function(r){currentStickyNoteId=this.data("id");currentStickyNoteName=this.data("name");if((bMouseDown)||(bTempMouseDown)){DoMouseMove(r.clientX+document.body.scrollLeft,r.clientY+document.body.scrollTop)}else{var q=findStickyNotes(currentStickyNoteId);if(q>=0){if(q!=lastObjStickyNote&&cvjs_location_flag){if(tooltipLastStickyNote!=lastObjStickyNote){if(!cvjs_supressPopUpModal){vqStickyNotes[tooltipLastStickyNote].attr(defaultColor_StickyNotes)}else{if(vqStickyNotes[tooltipLastStickyNote].data("linked")){vqStickyNotes[tooltipLastStickyNote].attr(defaultColor_linked)}else{vqStickyNotes[tooltipLastStickyNote].attr(defaultColor_unlinked)}}}if(!cvjs_supressPopUpModal){vqStickyNotes[q].attr(highlight_StickyNotes)}else{if(vqStickyNotes[q].data("linked")){vqStickyNotes[q].attr(highlight_linked)}else{vqStickyNotes[q].attr(highlight_unlinked)}}tooltipLastStickyNote=q}}m="Note #"+this.data("id");tip.html(m);tip.show();if(r.clientX>floorplan_width){tip.css("left",r.clientX+document.body.scrollLeft-tip_width-20).css("top",r.clientY+document.body.scrollTop-25)}else{tip.css("left",r.clientX+document.body.scrollLeft+10).css("top",r.clientY+document.body.scrollTop-25)}}}).mouseup(function(r){vqRoomMouseSelect=false;if(bPan){DoMouseUp(r.clientX+document.body.scrollLeft,r.clientY+document.body.scrollTop);m="Note #"+this.data("id");tip.html(m);bMouseDown=false;cvjs_clearDrawingStickyNotes();p=this.data("id");change_space_fixed_locationStickyNotes(p)}else{try{layer_vqstickynotes.attr(show)}catch(q){}m="Note #"+this.data("id");tip.html(m);bMouseDown=false;cvjs_clearDrawingStickyNotes();p=this.data("id");change_space_fixed_locationStickyNotes(p)}bPan=false}).touchstart(function(q){DoTouchStart(q,q.clientX+document.body.scrollLeft,q.clientY+document.body.scrollTop)}).touchend(function(q){if((!bPan)&&(!locked)){p=this.data("id");cvjs_change_space(p);m="Note #"+this.data("id");tip.html(m)}DoTouchEnd(q,q.clientX+document.body.scrollLeft,q.clientY+document.body.scrollTop);m=this.data("id");tip.html(m);bMouseDown=false;cvjs_clearDrawingStickyNotes();p=this.data("id");change_space_fixed_locationStickyNotes(p)}).touchmove(function(q){if(!bPan){tip.css("left",q.clientX+document.body.scrollLeft+20).css("top",q.clientY+document.body.scrollTop-20);tip.html(m)}DoTouchMove(q,q.clientX+document.body.scrollLeft,q.clientY+document.body.scrollTop)}).dblclick(function(q){event.preventDefault();event.stopPropagation()})}layer_vqstickynotes.add(vqStickyNotes[b])}function cvjs_setUpVqStickyNotes_currentNode(a,k){floorplan_height=$(window).height()*0.9;floorplan_width=$(window).width()*0.9;var f=null;tip=$("#tip");tip.hide().css("left",floorplan_width).css("top",floorplan_height);var j="";var g=false;var l=null;var d=null;try{$.fn.qtip.defaults.show.event="click";$.fn.qtip.defaults.hide.event=null}catch(c){}if(layer_vqstickynotes==""){layer_vqstickynotes=a.g()}var b=vqStickyNotes.length-1;rid=vqStickyNotes[b].data("node");if(k==rid){vqStickyNotes[b].data("name",cvjs_currentStickyNote_name);vqStickyNotes[b].data("id",cvjs_currentStickyNote_id);vqStickyNotes[b].data("text",cvjs_currentStickyNote_text);try{vqStickyNotes[b].data("layer",cvjs_currentStickyNote_layer);vqStickyNotes[b].data("group",cvjs_currentStickyNote_group);vqStickyNotes[b].data("linked",cvjs_currentStickyNote_linked);vqStickyNotes[b].data("userid",cvjs_currentStickyNote_userid);vqStickyNotes[b].data("date",cvjs_currentStickyNote_date);vqStickyNotes[b].data("transform",cvjs_currentStickyNote_transform)}catch(c){window.alert(c)}if(!cvjs_supressPopUpModal){vqStickyNotes[b].attr(defaultColor_StickyNotes)}else{if(vqStickyNotes[b].data("linked")){vqStickyNotes[b].attr(defaultColor_linked)}else{vqStickyNotes[b].attr(defaultColor_unlinked)}}if(cvjs_supressPopUpModal==true){$(vqStickyNotes[b].node).qtip({content:{text:"",title:""},style:{classes:"qtip-bootstrap qtip-shadow qtip-rounded qtip-zindex"},position:{my:"bottom center",at:"top left"},hideOnHTMLClick:"true"});$(vqStickyNotes[b].node).qtip("destroy")}else{var h='<table width="100%"><tr><td cols="3"><div class="cvjs_modal_header_stickynote_info_2">#'+cvjs_currentStickyNote_id+'</div><td class="cvjs_modal_header_stickynote_info_2_background"></td><td class="cvjs_modal_header_1" >'+cvjs_currentStickyNote_name+'</td><td class="cvjs_modal_header_sticky_note_info_1" id="stickyNoteIcon1" onclick="cvjs_move_note();" onmouseout="javascript:tip.hide();" onmouseover="javascript:cvjs_showStickynoteTip(\'Move Note\',1,'+b+');" ><i class="glyphicon glyphicon-move"></i></td><td class="cvjs_modal_header_sticky_note_info_1" id="stickyNoteIcon2" onclick="cvjs_edit_note();" onmouseout="javascript:tip.hide();" onmouseover="javascript:cvjs_showStickynoteTip(\'Edit Note\',2,'+b+');" ><i class="glyphicon glyphicon-edit"></i></td><td class="cvjs_modal_header_sticky_note_info_1" id="stickyNoteIcon3" onclick="cvjs_delete_note();" onmouseout="javascript:noteIconChangeHighlight(3,\'#00539B\');" onmouseover="javascript:cvjs_showStickynoteTip(\'Delete Note\',3,'+b+');" ><i class="glyphicon glyphicon-trash"></i></td><td class="cvjs_modal_header_sticky_note_info_2" id="stickyNoteIcon4" onclick="hideOnlyStickyNote('+b+');" onmouseout="javascript:tip.hide();" onmouseover="javascript:cvjs_showStickynoteTip(\'Minimize Note\',4,'+b+');" ><i class="glyphicon glyphicon-remove"></i></td></tr></table>';cvjs_setStickyNoteText(cvjs_currentStickyNote_text);$(vqStickyNotes[b].node).qtip({content:{text:cvjsStickyNoteBody,title:h},style:{classes:"qtip-bootstrap qtip-shadow qtip-rounded qtip-zindex"},position:{my:"bottom center",at:"top left"},hideOnHTMLClick:"false"})}vqStickyNotes[b].mousedown(function(m){vqRoomMouseSelect=true;DoMouseDown(m.clientX+document.body.scrollLeft,m.clientY+document.body.scrollTop)}).mousemove(function(n){currentStickyNoteId=this.data("id");currentStickyNoteName=this.data("name");if((bMouseDown)||(bTempMouseDown)){DoMouseMove(n.clientX+document.body.scrollLeft,n.clientY+document.body.scrollTop)}else{var m=findStickyNotes(currentStickyNoteId);if(m>=0){if(m!=lastObjStickyNote&&cvjs_location_flag){if(tooltipLastStickyNote!=lastObjStickyNote){if(!cvjs_supressPopUpModal){vqStickyNotes[tooltipLastStickyNote].attr(defaultColor_StickyNotes)}else{if(vqStickyNotes[tooltipLastStickyNote].data("linked")){vqStickyNotes[tooltipLastStickyNote].attr(defaultColor_linked)}else{vqStickyNotes[tooltipLastStickyNote].attr(defaultColor_unlinked)}}}if(!cvjs_supressPopUpModal){vqStickyNotes[m].attr(highlight_StickyNotes)}else{if(vqStickyNotes[m].data("linked")){vqStickyNotes[m].attr(highlight_linked)}else{vqStickyNotes[m].attr(highlight_unlinked)}}tooltipLastStickyNote=m}}j="Note #"+this.data("id");tip.html(j);tip.show();if(n.clientX>floorplan_width){tip.css("left",n.clientX+document.body.scrollLeft-tip_width-20).css("top",n.clientY+document.body.scrollTop-25)}else{tip.css("left",n.clientX+document.body.scrollLeft+20).css("top",n.clientY+document.body.scrollTop-25)}}}).mouseup(function(n){vqRoomMouseSelect=false;if(bPan){DoMouseUp(n.clientX+document.body.scrollLeft,n.clientY+document.body.scrollTop);j="Note #"+this.data("id");tip.html(j);bMouseDown=false;cvjs_clearDrawingStickyNotes();rid=this.data("id");change_space_fixed_locationStickyNotes(rid)}else{try{layer_vqstickynotes.attr(show)}catch(m){}j="Note #"+this.data("id");tip.html(j);bMouseDown=false;cvjs_clearDrawingStickyNotes();rid=this.data("id");change_space_fixed_locationStickyNotes(rid)}bPan=false}).touchstart(function(m){DoTouchStart(m,m.clientX+document.body.scrollLeft,m.clientY+document.body.scrollTop)}).touchend(function(m){if((!bPan)&&(!locked)){rid=this.data("id");cvjs_change_space(rid);j="Note #"+this.data("id");tip.html(j)}DoTouchEnd(m,m.clientX+document.body.scrollLeft,m.clientY+document.body.scrollTop);j=this.data("id");tip.html(j);bMouseDown=false;cvjs_clearDrawingStickyNotes();rid=this.data("id");change_space_fixed_locationStickyNotes(rid)}).touchmove(function(m){if(!bPan){tip.css("left",m.clientX+document.body.scrollLeft+20).css("top",m.clientY+document.body.scrollTop-20);tip.html(j)}DoTouchMove(m,m.clientX+document.body.scrollLeft,m.clientY+document.body.scrollTop)}).dblclick(function(m){event.preventDefault();event.stopPropagation()})}layer_vqstickynotes.add(vqStickyNotes[b])}function cvjs_setUpVqRooms_deleteNode(b){var a;for(var d in vqRooms){a=vqRooms[d].data("node");if(a==b){vqRooms[d].data("deleted",true);var c="S0.001";vqRooms[d].attr({transform:c,opacity:"0.01"})}}}function cvjs_setUpStickyNotes_deleteNode(c){var b;for(var a in vqStickyNotes){b=vqStickyNotes[a].data("node");if(b==c){vqStickyNotes[a].data("deleted",true);var d="S0.001";vqStickyNotes[a].attr({transform:d,opacity:"0.01"});hideOnlyStickyNote(a);$(vqStickyNotes[a].node).qtip("destroy");vqStickyNotes.splice(a,1)}}}function cvjs_StickyNotes_arrayIndex(a){var c;for(var b in vqStickyNotes){c=vqStickyNotes[b].data("node");if(c==a){return b}}return -1}var firstX_c=0;var firstY_c=0;var lastX_c=0;var lastY_c=0;var flag_c=false;var tTransform_c="";var tRubberBand_c;var myText;var delta=0;function cvjs_drawSpaceObject_Circle(){cvjs_addHandleFunc_Circle()}function cvjs_addHandleFunc_Circle(){canvas_width=$("#"+floorPlan_div).width();canvas_height=$("#"+floorPlan_div).height();var a=$("#"+floorPlan_div).position();global_scale_X=canvas_width/viewBoxWidth;global_scale_Y=canvas_height/viewBoxHeight;if(global_scale_X<global_scale_Y){global_scale=global_scale_X}else{global_scale=global_scale_Y}delta_x=(canvas_width-viewBoxWidth*global_scale)/2-viewBox.X*global_scale+a.left;delta_y=(canvas_height-viewBoxHeight*global_scale)/2-viewBox.Y*global_scale+a.top;tRubberBand_c=rPaper.circle(0,0,1,1).attr({stroke:"#b00000","stroke-width":"0.01",fill:"none","fill-opacity":"0.01",opacity:"0.01"});handleGroup=rPaper.rect(actualLLX,actualLLY,actualURX-actualLLX,actualURY-actualLLY).attr({fill:"#fff","fill-opacity":"0.01"});handleGroup.drag(move_cvjs_create_circle,start_cvjs_create_circle,stop_cvjs_create_circle)}function cvjs_removeHandleFunc_Circle(){handleGroup.selectAll("handler").remove();handleGroup.remove()}var start_cvjs_create_circle=function(){flag_c=false;tRubberBand_c.attr({stroke:"#b00000","stroke-width":"0.01",fill:"none","fill-opacity":"0.01",opacity:"0.01"})};var move_cvjs_create_circle=function(c,b,a,f){var d=a+" "+f+" dx="+c+" dy="+b+" viewbox "+viewBox.X+" "+viewBox.Y+" "+viewBoxWidth+" "+viewBoxHeight;if(!flag_c){firstX_c=a;firstY_c=f;lastX_c=c;lastY_c=b;flag_c=true}else{lastX_c=c;lastY_c=b}delta=Math.sqrt(c*c+b*b);tTransform_c="t"+(firstX_c-delta_x)/global_scale+","+(firstY_c-delta_y)/global_scale;delta/=global_scale;tTransform_c+="S"+(delta);tRubberBand_c.attr({transform:tTransform_c,opacity:"1"})};var stop_cvjs_create_circle=function(){tRubberBand_c.attr({fill:"#ff9999","fill-opacity":"0.5",stroke:"#ff9999","stroke-opacity":"1"});cvjs_removeHandleFunc_Circle();cvjs_addVqRoomsGraphics_newNode_circle(cvjs_currentNode_underbar,tRubberBand_c);cvjs_setUpVqRooms_currentNode(rPaper,cvjs_currentNode_underbar);cvjs_graphicalObjectCreated("Circle")};var firstX_r=0;var firstY_r=0;var lastX_r=0;var lastY_r=0;var flag_rectangle=false;var tPath_r;var tRubberBand_r;function cvjs_drawSpaceObject_Rectangle(){cvjs_addHandleFunc_Rectangle()}function cvjs_addHandleFunc_Rectangle(){tPath_r="M"+firstX_r+","+firstY_r;tRubberBand_r=rPaper.path(tPath_r).attr({stroke:"#b00000",fill:"none"});canvas_width=$("#"+floorPlan_div).width();canvas_height=$("#"+floorPlan_div).height();var a=$("#"+floorPlan_div).position();global_scale_X=canvas_width/viewBoxWidth;global_scale_Y=canvas_height/viewBoxHeight;if(global_scale_X<global_scale_Y){global_scale=global_scale_X}else{global_scale=global_scale_Y}delta_x=(canvas_width-viewBoxWidth*global_scale)/2-viewBox.X*global_scale+a.left;delta_y=(canvas_height-viewBoxHeight*global_scale)/2-viewBox.Y*global_scale+a.top;handleGroup=rPaper.rect(actualLLX,actualLLY,actualURX-actualLLX,actualURY-actualLLY).attr({fill:"#fff","fill-opacity":"0.01"});handleGroup.drag(move_cvjs_create_rectangle,start_cvjs_create_rectangle,stop_cvjs_create_rectangle)}function cvjs_removeHandleFunc_Rectangle(){handleGroup.selectAll("handler").remove();handleGroup.remove()}var start_cvjs_create_rectangle=function(){flag_rectangle=false;tRubberBand_r.attr({stroke:"#b00000",fill:"none"})};var move_cvjs_create_rectangle=function(c,b,a,f){var d=a+" "+f+" dx="+c+" dy="+b;if(!flag_rectangle){firstX_r=a;firstY_r=f;lastX_r=c;lastY_r=b;flag_rectangle=true}else{lastX_r=c;lastY_r=b}tPath_r="M"+(firstX_r-delta_x)/global_scale+","+(firstY_r-delta_y)/global_scale;tPath_r+="h"+lastX_r/global_scale+"v"+lastY_r/global_scale+"h"+(-lastX_r/global_scale)+"v"+(-lastY_r/global_scale+" Z");tRubberBand_r.attr({path:tPath_r})};var stop_cvjs_create_rectangle=function(){tRubberBand_r.attr({fill:"#ff9999","fill-opacity":"0.5",stroke:"#ff9999","stroke-opacity":"1"});cvjs_removeHandleFunc_Rectangle();cvjs_addVqRoomsGraphics_newNode_polygon(cvjs_currentNode_underbar,tRubberBand_r);cvjs_setUpVqRooms_currentNode(rPaper,cvjs_currentNode_underbar);cvjs_graphicalObjectCreated("Rectangle")};var firstX_mr=0;var firstY_mr=0;var lastX_mr=0;var lastY_mr=0;var flag_mrectangle=false;var tPath_mr;var tRubberBand_mr;var x_mr;var y_mr;var width_mr;var height_mr;function cvjs_addHandleFunc_ModifyRectangle(m){var t;for(spc in vqRooms){if(vqRooms[spc].data("node")==m){t=vqRooms[spc]}}var j=t.toString();var g=t.getBBox();x_mr=g.x;y_mr=g.y;width_mr=g.width;height_mr=g.height;var a;var p=true;var d;var b;var s;if(j.indexOf("path")>-1){p=true;var f=j.indexOf(" d=");var v=j.substring(f+4);var q=v.indexOf('" ');a=v.substring(0,q)}if(j.indexOf("circle")>-1){p=false;var o=j.indexOf(" cx=");var x=j.substring(o+5);var l=x.indexOf('"');d=x.substring(0,l);var n=j.indexOf(" cy=");var w=j.substring(n+5);var h=w.indexOf('"');b=w.substring(0,h);var u=j.indexOf(" r=");var c=j.substring(u+4);var k=c.indexOf('"');s=c.substring(0,k)}tPath_mr=a;tRubberBand_mr=rPaper.path(tPath_mr).attr({stroke:"#FF00AA",fill:"none","stroke-width":4});canvas_width=$("#"+floorPlan_div).width();canvas_height=$("#"+floorPlan_div).height();var y=$("#"+floorPlan_div).position();global_scale_X=canvas_width/viewBoxWidth;global_scale_Y=canvas_height/viewBoxHeight;if(global_scale_X<global_scale_Y){global_scale=global_scale_X}else{global_scale=global_scale_Y}delta_x=(canvas_width-viewBoxWidth*global_scale)/2-viewBox.X*global_scale+y.left;delta_y=(canvas_height-viewBoxHeight*global_scale)/2-viewBox.Y*global_scale+y.top;handleGroup=rPaper.rect(actualLLX,actualLLY,actualURX-actualLLX,actualURY-actualLLY).attr({fill:"#fff","fill-opacity":"0.01"});handleGroup.drag(move_cvjs_modify_rectangle,start_cvjs_modify_rectangle,stop_cvjs_modify_rectangle)}function cvjs_removeHandleFunc_ModifyRectangle(){handleGroup.selectAll("handler").remove();handleGroup.remove()}var start_cvjs_modify_rectangle=function(){flag_mrectangle=false;tRubberBand_mr.attr({stroke:"#FF00AA",fill:"none","stroke-width":4})};var move_cvjs_modify_rectangle=function(d,c,a,j){var f=(a-delta_x)/global_scale;var h=(j-delta_y)/global_scale;var g=height_mr/2;var b=width_mr/2;if(f<(x_mr+b)&&h<(y_mr+g)){if(!flag_mrectangle){flag_mrectangle=true;firstX_mr=x_mr+width_mr;firstY_mr=y_mr+height_mr;lastX_mr=-width_mr;lastY_mr=-height_mr}else{}}if(f>=(x_mr+b)&&h<(y_mr+g)){if(!flag_mrectangle){flag_mrectangle=true;firstX_mr=x_mr;firstY_mr=y_mr+height_mr;lastX_mr=width_mr;lastY_mr=-height_mr}else{}}if(f<(x_mr+b)&&h>=(y_mr+g)){if(!flag_mrectangle){flag_mrectangle=true;firstX_mr=x_mr+width_mr;firstY_mr=y_mr;lastX_mr=-width_mr;lastY_mr=height_mr}else{}}if(f>=(x_mr+b)&&h>=(y_mr+g)){if(!flag_mrectangle){flag_mrectangle=true;firstX_mr=x_mr;firstY_mr=y_mr;lastX_mr=width_mr;lastY_mr=height_mr}else{}}tPath_mr="M"+firstX_mr+","+firstY_mr;tPath_mr+="h"+(lastX_mr+(d/global_scale))+"v"+(lastY_mr+(c/global_scale))+"h"+(-lastX_mr-(d/global_scale))+"v"+(-lastY_mr-(c/global_scale))+" Z";tRubberBand_mr.attr({path:tPath_mr})};var stop_cvjs_modify_rectangle=function(){};var tb_nodeUnderbarIndex=0;var tborderIndex=0;var quardrant=0;var tTransform_tb="";var tTransform_tborder="";function cvjs_dynamicResizeTextOnSpaceObject(a){cvjs_addHandleFunc_ModifyTborderWithTextOnSpaceObject(a)}function cvjs_dynamicResizeTextOnSpaceObject_Name(a){var b=-1;for(spc in vqRooms){if(vqRooms[spc].data("name")==a){b=vqRooms[spc].data("node")}}cvjs_addHandleFunc_ModifyTborderWithTextOnSpaceObject(b)}function cvjs_dynamicResizeTextOnSpaceObject_Id(b){var a=-1;for(spc in vqRooms){if(vqRooms[spc].data("id")==b){a=vqRooms[spc].data("node")}}cvjs_addHandleFunc_ModifyTborderWithTextOnSpaceObject(b)}function cvjs_addHandleFunc_ModifyTborderWithTextOnSpaceObject(f){var d=0;var c=[];for(spc in vqRooms){if(vqRooms[spc].data("node")==f){d=vqRooms[spc].data("tborderId");c=vqRooms[spc].data("textId");vqRooms[spc].attr(hide);tb_nodeUnderbarIndex=spc}}var b;for(bdr in vqTBorder){if(vqTBorder[bdr].data("node")==d){b=vqTBorder[bdr];tborderIndex=bdr;vqTBorder[bdr].attr({fill:"none","stoke-width":"12.0",stroke:"#ff00dd","stroke-opacity":"1"});vqTBorder[bdr].attr(show)}}tTransform_c="";tTransform_tb="";canvas_width=$("#"+floorPlan_div).width();canvas_height=$("#"+floorPlan_div).height();var a=$("#"+floorPlan_div).position();global_scale_X=canvas_width/viewBoxWidth;global_scale_Y=canvas_height/viewBoxHeight;if(global_scale_X<global_scale_Y){global_scale=global_scale_X}else{global_scale=global_scale_Y}delta_x=(canvas_width-viewBoxWidth*global_scale)/2-viewBox.X*global_scale+a.left;delta_y=(canvas_height-viewBoxHeight*global_scale)/2-viewBox.Y*global_scale+a.top;handleGroup=rPaper.rect(actualLLX,actualLLY,actualURX-actualLLX,actualURY-actualLLY).attr({fill:"#fff","fill-opacity":"0.01"});handleGroup.drag(move_cvjs_modify_tbordertext,start_cvjs_modify_tbordertext,stop_cvjs_modify_tbordertext);handleGroup.dblclick(finish_cvjs_modify_tbordertext)}function cvjs_removeHandleFunc_ModifyTBorderWithText(){handleGroup.selectAll("handler").remove();handleGroup.remove()}var finish_cvjs_modify_tbordertext=function(){cvjs_removeHandleFunc_ModifyTBorderWithText();vqRooms[tb_nodeUnderbarIndex].attr(show);vqTBorder[tborderIndex].attr({fill:"none","stoke-width":"0.1",stroke:"#000000","stroke-opacity":"0.01"})};var start_cvjs_modify_tbordertext=function(a,g){flag_mrectangle=false;x_mr=vqTBorder[tborderIndex].getBBox().x;y_mr=vqTBorder[tborderIndex].getBBox().y;width_mr=vqTBorder[tborderIndex].getBBox().w;height_mr=vqTBorder[tborderIndex].getBBox().h;var c=(a-delta_x)/global_scale;var f=(g-delta_y)/global_scale;var d=height_mr/2;var b=width_mr/2;if(c<(x_mr+b)&&f<(y_mr+d)){if(!flag_mrectangle){flag_mrectangle=true;quardrant=1}else{}}if(c>=(x_mr+b)&&f<(y_mr+d)){if(!flag_mrectangle){flag_mrectangle=true;quardrant=2}else{}}if(c>=(x_mr+b)&&f>=(y_mr+d)){if(!flag_mrectangle){flag_mrectangle=true;quardrant=3}else{}}if(c<(x_mr+b)&&f>=(y_mr+d)){if(!flag_mrectangle){flag_mrectangle=true;quardrant=4}else{}}};var move_cvjs_modify_tbordertext=function(c,b,a,d){switch(quardrant){case 1:tTransform_c=tTransform_tb+"t"+((+c)/global_scale-(width_mr*0.5*(b/global_scale)/(height_mr)))+","+((+b)/global_scale-(height_mr*0.5*(b/global_scale)/(height_mr)));tTransform_c+="S"+((height_mr-b/global_scale)/(height_mr));tTransform_tborder="t"+((+c)/global_scale-(width_mr*0.5*(b/global_scale)/(height_mr)))+","+((+b)/global_scale-(height_mr*0.5*(b/global_scale)/(height_mr)));tTransform_tborder+="S"+((height_mr-b/global_scale)/(height_mr));vqTBorder[tborderIndex].attr({transform:tTransform_c,opacity:"1"});break;case 2:tTransform_c=tTransform_tb+"t"+((+c)/global_scale+(width_mr*0.5*(b/global_scale)/(height_mr)))+","+((+b)/global_scale-(height_mr*0.5*(b/global_scale)/(height_mr)));tTransform_c+="S"+((height_mr-b/global_scale)/(height_mr));tTransform_tborder="t"+((+c)/global_scale+(width_mr*0.5*(b/global_scale)/(height_mr)))+","+((+b)/global_scale-(height_mr*0.5*(b/global_scale)/(height_mr)));tTransform_tborder+="S"+((height_mr-b/global_scale)/(height_mr));vqTBorder[tborderIndex].attr({transform:tTransform_c,opacity:"1"});break;case 3:tTransform_c=tTransform_tb+"t"+((+c)/global_scale-(width_mr*0.5*(b/global_scale)/(height_mr)))+","+((+b)/global_scale-(height_mr*0.5*(b/global_scale)/(height_mr)));tTransform_c+="S"+((height_mr+b/global_scale)/(height_mr));tTransform_tborder="t"+((+c)/global_scale-(width_mr*0.5*(b/global_scale)/(height_mr)))+","+((+b)/global_scale-(height_mr*0.5*(b/global_scale)/(height_mr)));tTransform_tborder+="S"+((height_mr+b/global_scale)/(height_mr));vqTBorder[tborderIndex].attr({transform:tTransform_c,opacity:"1"});break;case 4:tTransform_c=tTransform_tb+"t"+((+c)/global_scale+(width_mr*0.5*(b/global_scale)/(height_mr)))+","+((+b)/global_scale-(height_mr*0.5*(b/global_scale)/(height_mr)));tTransform_c+="S"+((height_mr+b/global_scale)/(height_mr));tTransform_tborder="t"+((+c)/global_scale+(width_mr*0.5*(b/global_scale)/(height_mr)))+","+((+b)/global_scale-(height_mr*0.5*(b/global_scale)/(height_mr)));tTransform_tborder+="S"+((height_mr+b/global_scale)/(height_mr));vqTBorder[tborderIndex].attr({transform:tTransform_c,opacity:"1"});break;default:window.alert("Default quardrant move")}};var stop_cvjs_modify_tbordertext=function(){tTransform_tb=tTransform_tb+tTransform_tborder};function cvjs_resetTextOnSpaceObject(d){var c=0;var a=0;var b=false;for(spc in vqRooms){if(vqRooms[spc].data("node")==d){c=vqRooms[spc].data("tborderId")}}for(bdr in vqTBorder){if(vqTBorder[bdr].data("node")==c){a=bdr;b=true}}if(b){vqTBorder[a].attr({transform:"T0,0S1.0"})}}function cvjs_resetTextOnSpaceObject_Name(c){var d=0;var a=0;var b=false;for(spc in vqRooms){if(vqRooms[spc].data("name")==c){d=vqRooms[spc].data("tborderId")}}for(bdr in vqTBorder){if(vqTBorder[bdr].data("node")==d){a=bdr;b=true}}if(b){vqTBorder[a].attr({transform:"T0,0S1.0"})}}function cvjs_resetTextOnSpaceObject_Id(d){var b=false;var c=0;var a=0;for(spc in vqRooms){if(vqRooms[spc].data("id")==d){c=vqRooms[spc].data("tborderId")}}for(bdr in vqTBorder){if(vqTBorder[bdr].data("node")==c){a=bdr;b=true}}if(b){vqTBorder[a].attr({transform:"T0,0S1.0"})}}var originX_poly=0;var originY_poly=0;var firstX_poly=0;var firstY_poly=0;var lastX_poly=400;var lastY_poly=300;var tPath_poly;var tRubberBand_poly;var polyPath;var tPolygon;var draw_poly=false;var first_point_poly=true;function cvjs_drawSpaceObject_Polygon(){cvjs_addHandleFunc_Polygon()}function cvjs_addHandleFunc_Polygon(){tPath_poly="M"+firstX_poly+","+firstY_poly;tRubberBand_poly=rPaper.path(tPath_poly).attr({stroke:"#b00000"});polyPath="M"+firstX_poly+","+firstY_poly;tPolygon=rPaper.path(polyPath).attr({stroke:"#b00000",fill:"none"});canvas_width=$("#"+floorPlan_div).width();canvas_height=$("#"+floorPlan_div).height();var a=$("#"+floorPlan_div).position();global_scale_X=canvas_width/viewBoxWidth;global_scale_Y=canvas_height/viewBoxHeight;if(global_scale_X<global_scale_Y){global_scale=global_scale_X}else{global_scale=global_scale_Y}delta_x=(canvas_width-viewBoxWidth*global_scale)/2-viewBox.X*global_scale+a.left;delta_y=(canvas_height-viewBoxHeight*global_scale)/2-viewBox.Y*global_scale+a.top;draw_poly=false;first_point_poly=true;handleGroup=rPaper.rect(actualLLX,actualLLY,actualURX-actualLLX,actualURY-actualLLY).attr({fill:"#fff","fill-opacity":"0.01"});handleGroup.mousedown(mousedown_polygon);handleGroup.mousemove(mousemove_polygon);handleGroup.dblclick(polygon_finish)}function cvjs_removeHandleFunc_Polygon(){handleGroup.selectAll("handler").remove();handleGroup.remove()}var polygon_finish=function(){polyPath+="L"+(lastX_poly-delta_x)/global_scale+","+(lastY_poly-delta_y)/global_scale+"L"+(originX_poly-delta_x)/global_scale+","+(originY_poly-delta_y)/global_scale;tPolygon.attr({path:polyPath});tPolygon.attr({fill:"#ff9999","fill-opacity":"0.5",stroke:"#ff9999","stroke-opacity":"1"});cvjs_removeHandleFunc_Polygon();tRubberBand_poly.attr({path:"M0,0"});draw_poly=false;first_point_poly=true;cvjs_addVqRoomsGraphics_newNode_polygon(cvjs_currentNode_underbar,tPolygon);cvjs_setUpVqRooms_currentNode(rPaper,cvjs_currentNode_underbar);cvjs_graphicalObjectCreated("Polygon")};var mousedown_polygon=function(){if(draw_poly){polyPath+="L"+(lastX_poly-delta_x)/global_scale+","+(lastY_poly-delta_y)/global_scale;tPolygon.attr({path:polyPath});firstX_poly=lastX_poly;firstY_poly=lastY_poly}else{polyPath="M"+(firstX_poly-delta_x)/global_scale+","+(firstY_poly-delta_y)/global_scale;tPolygon.attr({path:polyPath});tPolygon.attr({stroke:"#b00000",fill:"none"});draw_poly=true}};var mousemove_polygon=function(b,a,c){if(draw_poly){if(first_point_poly){first_point_poly=false;firstX_poly=a;firstY_poly=c;lastX_poly=a;lastY_poly=c;originX_poly=a;originY_poly=c;polyPath="M"+(firstX_poly-delta_x)/global_scale+","+(firstY_poly-delta_y)/global_scale}else{lastX_poly=a;lastY_poly=c}tPath_poly="M"+(firstX_poly-delta_x)/global_scale+","+(firstY_poly-delta_y)/global_scale;tPath_poly+="L"+(lastX_poly-delta_x)/global_scale+","+(lastY_poly-delta_y)/global_scale;tRubberBand_poly.attr({path:tPath_poly})}};var originX_poly_red=0;var originY_poly_red=0;var firstX_poly_red=0;var firstY_poly_red=0;var lastX_poly_red=400;var lastY_poly_red=300;var tPath_poly_red;var tRubberBand_poly_red;var polyPath_red;var tPolygon_red;var draw_poly_red=false;var first_point_poly_red=true;var scaleRedline_LineSize=1;var scaleFactor_RedlineLineSize=200;function cvjs_drawRedline_Freehand(){cvjs_addHandleFunc_RedlinePolygon()}function cvjs_addHandleFunc_RedlinePolygon(){if((actualURX-actualLLX)>(actualURY-actualLLY)){scaleRedline_LineSize=(actualURY-actualLLY)/scaleFactor_RedlineLineSize}else{scaleRedline_LineSize=(actualURX-actualLLX)/scaleFactor_RedlineLineSize}tPath_poly_red="M"+firstX_poly_red+","+firstY_poly_red;tRubberBand_poly_red=rPaper.path(tPath_poly_red).attr({stroke:cvjs_currentRedline_color,"stroke-width":cvjs_currentRedline_strokeWidth,fill:"none"});polyPath_red="M"+firstX_poly_red+","+firstY_poly_red;tPolygon_red=rPaper.path(polyPath_red).attr({stroke:cvjs_currentRedline_color,"stroke-width":cvjs_currentRedline_strokeWidth,fill:"none"});canvas_width=$("#"+floorPlan_div).width();canvas_height=$("#"+floorPlan_div).height();var a=$("#"+floorPlan_div).position();global_scale_X=canvas_width/viewBoxWidth;global_scale_Y=canvas_height/viewBoxHeight;if(global_scale_X<global_scale_Y){global_scale=global_scale_X}else{global_scale=global_scale_Y}delta_x=(canvas_width-viewBoxWidth*global_scale)/2-viewBox.X*global_scale+a.left;delta_y=(canvas_height-viewBoxHeight*global_scale)/2-viewBox.Y*global_scale+a.top;draw_poly_red=false;first_point_poly_red=true;handleGroup=rPaper.rect(actualLLX,actualLLY,actualURX-actualLLX,actualURY-actualLLY).attr({fill:"#fff","fill-opacity":"0.01"});handleGroup.mousedown(mousedown_redlinepolygon);handleGroup.mousemove(mousemove_redlinepolygon);handleGroup.mouseup(redlinepolygon_finish)}function cvjs_removeHandleFunc_RedlinePolygon(){handleGroup.selectAll("handler").remove();handleGroup.remove()}var redlinepolygon_finish=function(){polyPath_red+="L"+(lastX_poly_red-delta_x)/global_scale+","+(lastY_poly_red-delta_y)/global_scale+"L"+(originX_poly_red-delta_x)/global_scale+","+(originY_poly_red-delta_y)/global_scale;tPolygon_red.attr({path:polyPath_red});cvjs_removeHandleFunc_RedlinePolygon();tRubberBand_poly_red.attr({path:"M0,0"});draw_poly_red=false;first_point_poly_red=true;cvjs_addVqRedlinesGraphics_newNode(cvjs_currentRedline_underbar,tPolygon_red);cvjs_graphicalObjectCreated("RedlinePolygon")};function cvjs_setUpVqRedlines_currentNode(a,c){for(var b in vqRedlines){redline_node=vqRedlines[b].data("node");if(redline_node==c){vqRedlines[b].data("name",cvjs_currentRedline_name);vqRedlines[b].data("id",cvjs_currentRedline_id);vqRedlines[b].data("layer",cvjs_currentRedline_layer);vqRedlines[b].data("group",cvjs_currentRedline_group);vqRedlines[b].data("color",cvjs_currentRedline_color);vqRedlines[b].data("strokeWidth",cvjs_currentRedline_strokeWidth)}}}function cvjs_setUpVqRedlines_deleteNode(c){var a;for(var b in vqRedlines){a=vqRedlines[b].data("node");if(a==c){vqRedlines[b].data("deleted",true);var d="S0.001";vqRedlines[b].attr({transform:d,opacity:"0.01"})}}}var mousedown_redlinepolygon=function(b,a,c){a=a+document.body.scrollLeft;c=c+document.body.scrollTop;if(draw_poly_red){}else{polyPath_red="M"+(a-delta_x)/global_scale+","+(c-delta_y)/global_scale;draw_poly_red=true}};var mousemove_redlinepolygon=function(f,a,g){a=a+document.body.scrollLeft;g=g+document.body.scrollTop;if(draw_poly_red){if(first_point_poly_red){first_point_poly_red=false;firstX_poly_red=a;firstY_poly_red=g;lastX_poly_red=a;lastY_poly_red=g;originX_poly_red=a;originY_poly_red=g}else{lastX_poly_red=a;lastY_poly_red=g}tPath_poly_red="M"+(firstX_poly_red-delta_x)/global_scale+","+(firstY_poly_red-delta_y)/global_scale;tPath_poly_red+="L"+(lastX_poly_red-delta_x)/global_scale+","+(lastY_poly_red-delta_y)/global_scale;tRubberBand_poly_red.attr({path:tPath_poly_red});var c=Math.pow((firstX_poly_red-delta_x)/global_scale-(lastX_poly_red-delta_x)/global_scale,2);var b=Math.pow((firstY_poly_red-delta_y)/global_scale-(lastY_poly_red-delta_y)/global_scale,2);var d=Math.sqrt(c+b);if(d>scaleRedline_LineSize){polyPath_red+="L"+(lastX_poly_red-delta_x)/global_scale+","+(lastY_poly_red-delta_y)/global_scale;tPolygon_red.attr({path:polyPath_red});first_point_poly_red=true}}};function cvjs_drawSpaceObject_CopyCircle(){cvjs_addHandleFunc_CopyCircle()}function cvjs_addHandleFunc_CopyCircle(){canvas_width=$("#"+floorPlan_div).width();canvas_height=$("#"+floorPlan_div).height();var a=$("#"+floorPlan_div).position();global_scale_X=canvas_width/viewBoxWidth;global_scale_Y=canvas_height/viewBoxHeight;if(global_scale_X<global_scale_Y){global_scale=global_scale_X}else{global_scale=global_scale_Y}delta_x=(canvas_width-viewBoxWidth*global_scale)/2-viewBox.X*global_scale+a.left;delta_y=(canvas_height-viewBoxHeight*global_scale)/2-viewBox.Y*global_scale+a.top;handleGroup=rPaper.rect(actualLLX,actualLLY,actualURX-actualLLX,actualURY-actualLLY).attr({fill:"#fff","fill-opacity":"0.01"});handleGroup.mousedown(mousedown_copycircle)}function cvjs_removeHandleFunc_CopyCircle(){handleGroup.selectAll("handler").remove();handleGroup.remove()}var mousedown_copycircle=function(b,a,c){tRubberBand_c=rPaper.circle(0,0,1,1).attr({stroke:"#b00000","stroke-width":"0.01",fill:"none","fill-opacity":"0.01",opacity:"0.01"});tTransform_c="t"+(a-delta_x)/global_scale+","+(c-delta_y)/global_scale;tTransform_c+="S"+(delta);tRubberBand_c.attr({transform:tTransform_c,opacity:"1"});tRubberBand_c.attr({fill:"#ff9999","fill-opacity":"0.5",stroke:"#ff9999","stroke-opacity":"1"});cvjs_removeHandleFunc_CopyCircle();cvjs_addVqRoomsGraphics_newNode_circle(cvjs_currentNode_underbar,tRubberBand_c);cvjs_setUpVqRooms_currentNode(rPaper,cvjs_currentNode_underbar);cvjs_graphicalObjectCreated("CopyCircle")};var mouseMoveStickyNote=false;var tRubberBand_sn;function cvjs_drawStickyNote(){cvjs_addHandleFunc_StickyNote()}function cvjs_addHandleFunc_StickyNote(){canvas_width=$("#"+floorPlan_div).width();canvas_height=$("#"+floorPlan_div).height();var a=$("#"+floorPlan_div).position();global_scale_X=canvas_width/viewBoxWidth;global_scale_Y=canvas_height/viewBoxHeight;if(global_scale_X<global_scale_Y){global_scale=global_scale_X}else{global_scale=global_scale_Y}delta_x=(canvas_width-viewBoxWidth*global_scale)/2-viewBox.X*global_scale+a.left;delta_y=(canvas_height-viewBoxHeight*global_scale)/2-viewBox.Y*global_scale+a.top;handleGroup=rPaper.rect(actualLLX,actualLLY,actualURX-actualLLX,actualURY-actualLLY).attr({fill:"#fff","fill-opacity":"0.01"});handleGroup.mousedown(mousedown_stickynote);mouseMoveStickyNote=false;handleGroup.mousemove(mousemove_stickynote)}function cvjs_removeHandleFunc_StickyNote(){handleGroup.selectAll("handler").remove();handleGroup.remove()}var mousemove_stickynote=function(f,a,g){if(mouseMoveStickyNote==false){var d=0;if(cvjs_currentStickyNote_id<10){d=3}tRubberBand_sn=rPaper.group(rPaper.path("M-24,-24h24v24h-24v-24Z").attr({stroke:"#FFF","stroke-width":"0.01",fill:"none","stroke-opacity":"0.01"}),rPaper.path("M0,0h20v20h-20v-20Z").attr({stroke:"#000000","stroke-width":"1.0",fill:"none"}),rPaper.path("M7,12h1.3M9.5,12h3.5M11.25,12v5M9.75,12v1.75M12.75,12v1.75M10.5,17h1.5M7,13.5h1.3M7,15.25h3M7,17.0h2.2").attr({stroke:"#000000","stroke-width":"0.5",fill:"none"}),rPaper.text(3+d,9,"#"+cvjs_currentStickyNote_id).attr({"font-size":"8px","font-style":"italic",stroke:"#000000","stroke-width":"2",stroke:"1.8",fill:"#000000"}));mouseMoveStickyNote=true}a=a+document.body.scrollLeft;g=g+document.body.scrollTop;tTransform_c="t"+(a-delta_x)/global_scale+","+(g-delta_y)/global_scale;var b=1;var c=600;if((actualURX-actualLLX)>(actualURY-actualLLY)){b=(actualURY-actualLLY)/c}else{b=(actualURX-actualLLX)/c}tTransform_c+="S"+(b);tRubberBand_sn.attr({transform:tTransform_c})};var mousedown_stickynote=function(f,a,g){tTransform_c="t0,0S"+(b/100);tRubberBand_sn.attr({transform:tTransform_c,opacity:"0.0"});tRubberBand_sn.attr({fill:"none","fill-opacity":"0.0",stroke:"#000","stroke-opacity":"0.0"});var d=0;if(cvjs_currentStickyNote_id<10){d=3}tRubberBand_c=rPaper.group(rPaper.path("M0,0h20v20h-20v-20Z").attr({stroke:"#000000","stroke-width":"1.0"}),rPaper.path("M7,12h1.3M9.5,12h3.5M11.25,12v5M9.75,12v1.75M12.75,12v1.75M10.5,17h1.5M7,13.5h1.3M7,15.25h3M7,17.0h2.2").attr({stroke:"#000000","stroke-width":"0.5"}),rPaper.text(3+d,9,"#"+cvjs_currentStickyNote_id).attr({"font-size":"8px","font-style":"italic",stroke:"#000000","stroke-width":"0.3",stroke:"0.3",fill:"#000000","fill-opacity":1}));a=a+document.body.scrollLeft;g=g+document.body.scrollTop;tTransform_c="t"+(a+6*global_scale-delta_x)/global_scale+","+(g+6*global_scale-delta_y)/global_scale;var b=1;var c=600;if((actualURX-actualLLX)>(actualURY-actualLLY)){b=(actualURY-actualLLY)/c}else{b=(actualURX-actualLLX)/c}tTransform_c+="S"+(b);tRubberBand_c.attr({transform:tTransform_c,opacity:"1"});tRubberBand_c.attr({fill:"#FFF","fill-opacity":"0.8",stroke:"#000","stroke-opacity":"1"});cvjs_currentStickyNote_transform=tTransform_c;cvjs_removeHandleFunc_StickyNote();cvjs_addVqStickyNotesGraphics_newNode(cvjs_currentStickyNote_underbar,tRubberBand_c);cvjs_setUpVqStickyNotes_currentNode(rPaper,cvjs_currentStickyNote_underbar);cvjs_graphicalObjectCreated("StickyNote")};var mouseMoveFlagStickyNote=false;function cvjs_addHandleFunc_MoveStickyNote(){canvas_width=$("#"+floorPlan_div).width();canvas_height=$("#"+floorPlan_div).height();var a=$("#"+floorPlan_div).position();global_scale_X=canvas_width/viewBoxWidth;global_scale_Y=canvas_height/viewBoxHeight;if(global_scale_X<global_scale_Y){global_scale=global_scale_X}else{global_scale=global_scale_Y}delta_x=(canvas_width-viewBoxWidth*global_scale)/2-viewBox.X*global_scale+a.left;delta_y=(canvas_height-viewBoxHeight*global_scale)/2-viewBox.Y*global_scale+a.top;handleGroup=rPaper.rect(actualLLX,actualLLY,actualURX-actualLLX,actualURY-actualLLY).attr({fill:"#fff","fill-opacity":"0.01"});mouseMoveFlagStickyNote=false;handleGroup.mousemove(mousemove_movestickynote);handleGroup.mousedown(mousedown_movestickynote)}function cvjs_removeHandleFunc_MoveStickyNote(){handleGroup.selectAll("handler").remove();handleGroup.remove()}var mousemove_movestickynote=function(d,k,g){if(mouseMoveFlagStickyNote==false){var l=cvjs_StickyNoteClicked();var b=0;for(var f in vqStickyNotes){var j=vqStickyNotes[f].data("node");if(l==j){b=vqStickyNotes[f].data("id")}}var h=0;if(cvjs_currentStickyNote_id<10){h=3}tRubberBand_c=rPaper.group(rPaper.path("M-24,-24h24v24h-24v-24Z").attr({stroke:"#FFF","stroke-width":"0.01",fill:"none","stroke-opacity":"0.01"}),rPaper.path("M0,0h20v20h-20v-20Z").attr({stroke:"#000000","stroke-width":"1.0",fill:"none"}),rPaper.path("M7,12h1.3M9.5,12h3.5M11.25,12v5M9.75,12v1.75M12.75,12v1.75M10.5,17h1.5M7,13.5h1.3M7,15.25h3M7,17.0h2.2").attr({stroke:"#000000","stroke-width":"0.5",fill:"none"}),rPaper.text(3+h,9,"#"+b).attr({"font-size":"8px","font-style":"italic",stroke:"#000000","stroke-width":"0.3",stroke:"0.3",fill:"#000000","fill-opacity":1}));mouseMoveFlagStickyNote=true}tTransform_c="t"+(k-delta_x)/global_scale+","+(g-delta_y)/global_scale;var a=1;var c=600;if((actualURX-actualLLX)>(actualURY-actualLLY)){a=(actualURY-actualLLY)/c}else{a=(actualURX-actualLLX)/c}tTransform_c+="S"+(a);tRubberBand_c.attr({transform:tTransform_c,opacity:"0.5"})};var mousedown_movestickynote=function(f,b,h){tTransform_c="t"+(b+24*global_scale-delta_x)/global_scale+","+(h+24*global_scale-delta_y)/global_scale;var c=1;var d=600;if((actualURX-actualLLX)>(actualURY-actualLLY)){c=(actualURY-actualLLY)/d}else{c=(actualURX-actualLLX)/d}tTransform_c+="S"+(c);var g=cvjs_StickyNoteClicked();var a=cvjs_StickyNotes_arrayIndex(g);vqStickyNotes[a].attr({transform:tTransform_c,"fill-opacity":"0.8","stroke-opacity":"1"});vqStickyNotes[a].data("transform",tTransform_c);cvjs_removeHandleFunc_MoveStickyNote();tTransform_c+="t0,0S"+(c/100);tRubberBand_c.attr({transform:tTransform_c,opacity:"0.0"});tRubberBand_c.attr({fill:"#FFF","fill-opacity":"0.0",stroke:"#000","stroke-opacity":"0.0"})};var dragInsidePolygon=false;function AbsDiff(d,c){return Math.abs(d-c)}function DoMouseDown(a,g){pdx=0;pdy=0;basex=0;basey=0;firstx=a;firsty=g;dx=0;dy=0;bMouseDown=true;bTempMouseDown=false;bPan=false;thumbsMode=true;var b=document.getElementsByTagName("svg")[0];var f=b.getAttribute("viewBox");var c=f.split(" ");vbx=parseInt(c[0]);vby=parseInt(c[1]);if(!thumb_loaded){thumb_loaded=true;try{}catch(d){}}}function DoMouseOut(c,b){if(bMouseDown){if(bPan){dx=c-firstx;dy=b-firsty;pdx=dx*zoomScale;pdy=dy*zoomScale;basex=dx;basey=dy;viewBox.X=vbx-pdx;viewBox.Y=vby-pdy;var a='{"viewBox" : "'+viewBox.X+" "+viewBox.Y+" "+viewBoxWidth+" "+viewBoxHeight+'" }';var d=$.parseJSON(a);rPaper.attr(d);bTempMouseDown=true}}}function DoMouseOver(b,a){if((bTempMouseDown)||(bMouseDown)){bTempMouseDown=false;bMouseDown=true}}function DoMouseUp(a,f){bMouseDown=false;bTempMouseDown=false;if(bPan){viewBox.X=vbx-pdx;viewBox.Y=vby-pdy;var b='{"viewBox" : "'+viewBox.X+" "+viewBox.Y+" "+viewBoxWidth+" "+viewBoxHeight+'" }';var d=$.parseJSON(b);rPaper.attr(d)}if(bPan){try{if(panWithThumb){layers_all.attr(show);layer_thumb.attr(hide)}layer_vqrooms.attr(show)}catch(c){window.alert("txx "+c)}}else{tip.show()}preventDrag=true;try{if(totalDragStart==2){e.preventDefault();e.stopPropagation()}}catch(c){bPan=false}try{if(totalDragStart==2){viewBox.X=viewBox_initX;viewBox.Y=viewBox_initY;vBHo=viewBoxHeight_init;vBWo=viewBoxWidth_init;viewBoxWidth=viewBoxWidth_init;viewBoxHeight=viewBoxHeight_init;viewBoxWidth/=deltaDynamic/deltaBase;viewBoxHeight/=deltaDynamic/deltaBase;viewBox.X-=(viewBoxWidth-vBWo)/2;viewBox.Y-=(viewBoxHeight-vBHo)/2;zoomScale=viewBoxWidth/rpWidth;var b='{"viewBox" : "'+viewBox.X+" "+viewBox.Y+" "+viewBoxWidth+" "+viewBoxHeight+'" }';var d=$.parseJSON(b);rPaper.attr(d)}}catch(c){}try{if(panWithThumb){layers_all.attr(show);layer_thumb.attr(hide)}layer_vqrooms.attr(show)}catch(c){window.alert(c)}bPan=false}var basemx=0;var basemy=0;function DoMouseMove(h,f){if(!bPan){basemx=h;basemy=f}if(thumbsMode&&bPan&&((basemx-h)!=0)&&((basemy-f)!=0)){try{thumbsMode=false;if(panWithThumb){layers_all.attr(hide);layer_thumb.attr(show)}layer_vqrooms.attr(hide)}catch(d){window.alert("t1 "+d)}}if(bMouseDown&&!bPan){bPan=true;dragInsidePolygon=true;try{}catch(d){window.alert(d)}}try{if(bMouseDown&&totalDragStart<2){dx=h-firstx;dy=f-firsty;if((Math.abs(basex-dx)>4)||(Math.abs(basey-dy)>4)){hideOnlyPop();tip.hide();cvjs_clearDrawing();hideOnlyStickyNote();cvjs_clearDrawingStickyNotes();bPan=true;var b=viewBoxWidth/$("#floorPlan").width();var a=viewBoxHeight/$("#floorPlan").height();var g=1;if(b>a){g=b}else{g=a}pdx=dx*g;pdy=dy*g;basex=dx;basey=dy;viewBox.X=vbx-pdx;viewBox.Y=vby-pdy;var c='{"viewBox" : "'+viewBox.X+" "+viewBox.Y+" "+viewBoxWidth+" "+viewBoxHeight+'" }';var j=$.parseJSON(c);rPaper.attr(j)}}}catch(d){window.alert(d)}}function DoTouchMove(a,j,h){try{if(panWithThumb){layers_all.attr(hide);layer_thumb.attr(show)}}catch(b){window.alert("t2 "+b)}if(preventDrag){a.stopPropagation();a.preventDefault()}if(totalDragStart==2){a.stopPropagation();a.preventDefault();tip.hide();hideOnlyPop();hideOnlyStickyNote()}if(totalDragStart==2){try{firstFingerX=a.touches[0].pageX;firstFingerY=a.touches[0].pageY;totalDragStart=1;preventDrag=false;secondFingerX=a.touches[1].pageX;secondFingerY=a.touches[1].pageY;totalDragStart=2;preventDrag=true;allowPinchWithNoPolygons=false;deltaX=secondFingerX-firstFingerX;deltaY=secondFingerY-firstFingerY;deltaDynamic=Math.sqrt(deltaX*deltaX+deltaY*deltaY);if((deltaDynamic-deltaDynamicPre>4||deltaDynamic-deltaDynamicPre<-4)&&flagOK){flagOK=false;deltaDynamicPre=deltaDynamic;viewBox.X=viewBox_initX;viewBox.Y=viewBox_initY;vBHo=viewBoxHeight_init;vBWo=viewBoxWidth_init;viewBoxWidth=viewBoxWidth_init;viewBoxHeight=viewBoxHeight_init;viewBoxWidth/=deltaDynamic/deltaBase;viewBoxHeight/=deltaDynamic/deltaBase;viewBox.X-=(viewBoxWidth-vBWo)/2;viewBox.Y-=(viewBoxHeight-vBHo)/2;zoomScale=viewBoxWidth/rpWidth;var k='{"viewBox" : "'+viewBox.X+" "+viewBox.Y+" "+viewBoxWidth+" "+viewBoxHeight+'" }';var d=$.parseJSON(k);rPaper.attr(d);var g=viewBox.X;var f=viewBox.Y;firstFingerX1=firstFingerX;firstFingerY1=firstFingerY;flagOK=true}}catch(b){var c=1}}}function DoTouchStart(c,a,f){preventDrag=true;ttest=0;c.preventDefault();c.stopPropagation();if(!thumb_loaded){thumb_loaded=true;try{}catch(b){window.alert("t3 "+b)}}try{firstFingerX=c.touches[0].pageX;firstFingerY=c.touches[0].pageY;totalDragStart=1;preventDrag=false;secondFingerX=c.touches[1].pageX;secondFingerY=c.touches[1].pageY;totalDragStart=2;preventDrag=true;allowPinchWithNoPolygons=false;deltaXinit=secondFingerX-firstFingerX;deltaYinit=secondFingerY-firstFingerY;deltaBase=Math.sqrt(deltaXinit*deltaXinit+deltaYinit*deltaYinit);deltaDynamicPre=deltaBase;viewBoxWidthPre=viewBoxWidth;viewBoxheightPre=viewBoxHeight;firstFingerX1=firstFingerX;firstFingerY1=firstFingerY;firstFingerX_init=firstFingerX;firstFingerY_init=firstFingerY;viewBox_initX=viewBox.X;viewBox_initY=viewBox.Y;viewBoxWidth_init=viewBoxWidth;viewBoxHeight_init=viewBoxHeight;flagOK=true}catch(b){var d=1}}function DoTouchEnd(b,h,g){preventDrag=true;if(totalDragStart==2){b.preventDefault();b.stopPropagation();tip.hide();hideOnlyPop();hideOnlyStickyNote()}try{if(totalDragStart==2){viewBox.X=viewBox_initX;viewBox.Y=viewBox_initY;vBHo=viewBoxHeight_init;vBWo=viewBoxWidth_init;viewBoxWidth=viewBoxWidth_init;viewBoxHeight=viewBoxHeight_init;viewBoxWidth/=deltaDynamic/deltaBase;viewBoxHeight/=deltaDynamic/deltaBase;viewBox.X-=(viewBoxWidth-vBWo)/2;viewBox.Y-=(viewBoxHeight-vBHo)/2;zoomScale=viewBoxWidth/rpWidth;var k='{"viewBox" : "'+viewBox.X+" "+viewBox.Y+" "+viewBoxWidth+" "+viewBoxHeight+'" }';var f=$.parseJSON(k);rPaper.attr(f)}var a='{"display" : "none" }';var d=$.parseJSON(a);var k='{"display" : "inline" }';var j=$.parseJSON(k);if(panWithThumb){layers_all.attr(j);layer_thumb.attr(d)}layer_vqrooms.attr(j)}catch(c){window.alert("t4 "+c)}}var currentRoomId;var currentRoomName;var tooltipLast=-1;var currentStickyNoteId;var currentStickyNoteName;var tooltipLastStickyNote=-1;var tooltipLastHyperlink=-1;var currentUrlId;var currentUrlName;function setRoomAfterPanPC(){tip.html(currentRoomName);bMouseDown=false;cvjs_clearDrawing();change_space_fixed_location(currentRoomId)}function setUpVqRooms(b){floorplan_height=$(window).height()*0.9;floorplan_width=$(window).width()*0.9;var h=null;tip=$("#tip");tip.hide().css("left",floorplan_width).css("top",floorplan_height);var m="";var j=false;var n=null;var f=null;try{$.fn.qtip.defaults.show.event="click";$.fn.qtip.defaults.hide.event=null}catch(d){}if(vqBuilding in buildings){n=buildings[vqBuilding];if(vqFloor in n.floors){f=n.floors[vqFloor]}}layer_vqrooms=b.g();for(var a in vqRooms){var p=0;for(bRoom in f.rooms){rid=vqRooms[a].data("node");if(bRoom==rid){p=1;var l=f.rooms[bRoom].tags;var q=1;for(var r in l){var o="tag"+q;var g=l[r];while(g.charAt(0)==" "){g=g.substr(1)}g=g.replace(/ /gi,"&nbsp;");vqRooms[a].data(o,g);q++}vqRooms[a].data("occupancy",f.rooms[bRoom].occupancy);vqRooms[a].data("name",f.rooms[bRoom].name);vqRooms[a].data("type",f.rooms[bRoom].type);if(f.rooms[bRoom].id==-1){vqRooms[a].data("id",rid)}else{vqRooms[a].data("id",f.rooms[bRoom].id)}try{vqRooms[a].data("layer",f.rooms[bRoom].layer);vqRooms[a].data("group",f.rooms[bRoom].group);vqRooms[a].data("attributes",f.rooms[bRoom].attributes);vqRooms[a].data("attributeStatus",f.rooms[bRoom].attributeStatus);if(f.rooms[bRoom].linked!=undefined){vqRooms[a].data("linked",f.rooms[bRoom].linked)}else{vqRooms[a].data("linked",false)}}catch(d){window.alert(d)}if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){vqRooms[a].attr(defaultColor)}else{if(vqRooms[a].data("linked")){vqRooms[a].attr(defaultColor_linked)}else{vqRooms[a].attr(defaultColor_unlinked)}}var k='<table width="100%"><tr><td class="cvjs_modal_header_1" onclick="cvjs_popupTitleClick(\''+f.rooms[bRoom].id+"');\">"+f.rooms[bRoom].name+'</td><td class="cvjs_modal_header_info_1" onclick="hideOnlyPop('+a+');"><i class="glyphicon glyphicon-remove"></i></td></tr><tr><td cols="2"><h4 id="cvjs_modal_header_info_2">'+f.rooms[bRoom].type+"</h4></td></tr></table>";if(dual_hbody_flag){if(parseInt(f.rooms[bRoom].id)>=-1){$(vqRooms[a].node).qtip({content:{text:hbody,title:k},style:{classes:"qtip-bootstrap qtip-shadow qtip-rounded qtip-zindex"},position:{my:"bottom center",at:"top left"},hideOnHTMLClick:"false"})}else{$(vqRooms[a].node).qtip({content:{text:hbody_2,title:k},style:{classes:"qtip-bootstrap qtip-shadow qtip-rounded qtip-zindex"},position:{my:"bottom center",at:"top left"},hideOnHTMLClick:"false"})}}if(!dual_hbody_flag){$(vqRooms[a].node).qtip({content:{text:hbody,title:k},style:{classes:"qtip-bootstrap qtip-shadow qtip-rounded qtip-zindex"},position:{my:"bottom center",at:"top left"},hideOnHTMLClick:"false"})}vqRooms[a].mousedown(function(s){vqRoomMouseSelect=true;DoMouseDown(s.clientX+document.body.scrollLeft,s.clientY+document.body.scrollTop)}).mousemove(function(t){currentRoomId=this.data("id");currentRoomName=this.data("name");if((bMouseDown)||(bTempMouseDown)){DoMouseMove(t.clientX+document.body.scrollLeft,t.clientY+document.body.scrollTop)}else{var s=findRoom(currentRoomId);if(s>=0){if(s!=lastObj&&cvjs_location_flag){if(tooltipLast!=lastObj&&tooltipLast!=-1){if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){vqRooms[tooltipLast].attr(defaultColor)}else{if(vqRooms[tooltipLast].data("linked")){vqRooms[tooltipLast].attr(defaultColor_linked)}else{vqRooms[tooltipLast].attr(defaultColor_unlinked)}}}if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){vqRooms[s].attr(highlight)}else{if(vqRooms[s].data("linked")){vqRooms[s].attr(highlight_linked)}else{vqRooms[s].attr(highlight_unlinked)}}tooltipLast=s}}if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){m=this.data("name")}else{m=this.data("id")}if(cvjs_customToolTip){m=cvjs_displayCustomToolTip(this.data("id"))}tip.html(m);tip.show();if(t.clientX>floorplan_width){tip.css("left",t.clientX+document.body.scrollLeft-tip_width-20).css("top",t.clientY+document.body.scrollTop-25)}else{tip.css("left",t.clientX+document.body.scrollLeft+10).css("top",t.clientY+document.body.scrollTop-25)}}}).mouseup(function(t){vqRoomMouseSelect=false;if(bPan){DoMouseUp(t.clientX+document.body.scrollLeft,t.clientY+document.body.scrollTop);if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){m=this.data("name")}else{m=this.data("id")}if(cvjs_customToolTip){m=cvjs_displayCustomToolTip(this.data("id"))}tip.html(m);bMouseDown=false;cvjs_clearDrawing();rid=this.data("id");change_space_fixed_location(rid)}else{try{layer_vqrooms.attr(show);if(panWithThumb){layers_all.attr(show);layer_thumb.attr(hide)}}catch(s){window.alert("t5 "+s)}if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){m=this.data("name")}else{m=this.data("id")}if(cvjs_customToolTip){m=cvjs_displayCustomToolTip(this.data("id"))}tip.html(m);bMouseDown=false;cvjs_clearDrawing();rid=this.data("id");change_space_fixed_location(rid)}bPan=false}).touchstart(function(s){DoTouchStart(s,s.clientX+document.body.scrollLeft,s.clientY+document.body.scrollTop)}).touchend(function(s){if((!bPan)&&(!locked)){rid=this.data("id");cvjs_change_space(rid);if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){m=this.data("name")}else{m=this.data("id")}if(cvjs_customToolTip){m=cvjs_displayCustomToolTip(this.data("id"))}tip.html(m)}DoTouchEnd(s,s.clientX+document.body.scrollLeft,s.clientY+document.body.scrollTop);if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){m=this.data("name")}else{m=this.data("id")}tip.html(m);bMouseDown=false;cvjs_clearDrawing();rid=this.data("id");change_space_fixed_location(rid)}).touchmove(function(s){if(!bPan){tip.css("left",s.clientX+document.body.scrollLeft+20).css("top",s.clientY+document.body.scrollTop-20);tip.html(m);if(cvjs_customToolTip){m=cvjs_displayCustomToolTip(this.data("id"))}}DoTouchMove(s,s.clientX+document.body.scrollLeft,s.clientY+document.body.scrollTop)}).dblclick(function(s){event.preventDefault();event.stopPropagation()})}}if(p==0){var c=vqRooms[a].data("node");window.alert("room not found "+c);vqRooms[a].data("occupancy","undefined");vqRooms[a].data("name","undefined");vqRooms[a].data("type","undefined");vqRooms[a].data("id",c);$(vqRooms[a].node).qtip({title:"Undefined",content:"",placement:"top"});vqRooms[a].data("layer","undefined");vqRooms[a].data("group","undefined");vqRooms[a].data("attributes","undefined");vqRooms[a].data("attributeStatus","undefined");vqRooms[a].data("linked",false)}layer_vqrooms.add(vqRooms[a])}}function setUpVqStickyNotes(a){}function setUpVqRedlines(a){}function setUpVqURLs(a){var f=null;tip=$("#tip");tip.hide().css("left",floorplan_width).css("top",floorplan_height);var h="";var g=false;var j=null;var d=null;try{$.fn.qtip.defaults.show.event="click";$.fn.qtip.defaults.hide.event=null}catch(c){}if(vqBuilding in buildings){j=buildings[vqBuilding];if(vqFloor in j.floors){d=j.floors[vqFloor]}}layer_hyperlinks=a.g();for(var l in vqURLs){var k=0;for(bRoom in d.rooms){rid=vqURLs[l].data("node");if(bRoom==rid){k=1;vqURLs[l].data("name",d.rooms[bRoom].name);if(d.rooms[bRoom].id==-1){vqURLs[l].data("id",rid)}else{vqURLs[l].data("id",d.rooms[bRoom].id)}try{vqURLs[l].data("layer",d.rooms[bRoom].layer);vqURLs[l].data("group",d.rooms[bRoom].group);vqURLs[l].data("url",d.rooms[bRoom].url);if(d.rooms[bRoom].linked!=undefined){vqURLs[l].data("linked",d.rooms[bRoom].linked)}else{vqURLs[l].data("linked",false)}}catch(c){window.alert(c)}vqURLs[l].attr(defaultColor_Hyperlinks);if(!cvjs_supressHyperlinkColors){vqURLs[l].attr(defaultColor_Hyperlinks)}else{vqURLs[l].attr(defaultColor_Hyperlinks_blank)}vqURLs[l].mousedown(function(m){vqRoomMouseSelect=true;DoMouseDown(m.clientX+document.body.scrollLeft,m.clientY+document.body.scrollTop)}).mousemove(function(n){currentUrlId=this.data("id");currentUrlName=this.data("name");if((bMouseDown)||(bTempMouseDown)){DoMouseMove(n.clientX+document.body.scrollLeft,n.clientY+document.body.scrollTop)}else{var m=findUrl(currentUrlId);if(m>=0){if(m!=lastObjHyperlink&&cvjs_location_flag){if(tooltipLastHyperlink!=lastObjHyperlink){if(!cvjs_supressHyperlinkColors){vqURLs[tooltipLastHyperlink].attr(defaultColor_Hyperlinks)}else{vqURLs[tooltipLastHyperlink].attr(defaultColor_Hyperlinks_blank)}}if(!cvjs_supressHyperlinkColors){vqURLs[m].attr(highlight_Hyperlinks)}else{vqURLs[m].attr(defaultColor_Hyperlinks_blank)}tooltipLastHyperlink=m}}if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){h=this.data("name")}else{h=this.data("id")}tip.html(h);tip.show();if(n.clientX>floorplan_width){tip.css("left",n.clientX+document.body.scrollLeft-tip_width-20).css("top",n.clientY+document.body.scrollTop-25)}else{tip.css("left",n.clientX+document.body.scrollLeft+10).css("top",n.clientY+document.body.scrollTop-25)}}}).mouseup(function(n){vqRoomMouseSelect=false;if(bPan){DoMouseUp(n.clientX+document.body.scrollLeft,n.clientY+document.body.scrollTop);if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){h=this.data("name")}else{h=this.data("id")}tip.html(h);bMouseDown=false;cvjs_clearDrawingHyperlinks();rid=this.data("id")}else{try{layer_hyperlinks.attr(show);if(panWithThumb){layers_all.attr(show);layer_thumb.attr(hide)}}catch(m){window.alert("t6 "+m)}if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){h=this.data("name")}else{h=this.data("id")}tip.html(h);bMouseDown=false;cvjs_clearDrawingHyperlinks();rid=this.data("id")}bPan=false}).touchstart(function(m){DoTouchStart(m,m.clientX+document.body.scrollLeft,m.clientY+document.body.scrollTop)}).touchend(function(p){if((!bPan)&&(!locked)){rid=this.data("id");try{cvjs_change_space(rid)}catch(n){var m=0}if(!cvjs_supressHyperlinkColors){h=this.data("name")}else{h=this.data("name")}tip.html(h)}DoTouchEnd(p,p.clientX+document.body.scrollLeft,p.clientY+document.body.scrollTop);if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){h=this.data("name")}else{h=this.data("id")}tip.html(h);bMouseDown=false;rid=this.data("id");var o=findUrl(rid);if(totalDragStart==1){if(o.indexOf("http://")==-1){if(cvjs_Url_encapsulate_callback){cvjs_Url_callback(vqURLs[o].data("url"));change_space_fixed_locationHyperlink(rid)}else{change_space_fixed_locationHyperlink(rid)}}else{if(cvjs_Url_encapsulate_callback){cvjs_Url_callback(vqURLs[o].data("url"));change_space_fixed_locationHyperlink(rid)}else{change_space_fixed_locationHyperlink(rid)}}}}).touchmove(function(m){if(!bPan){tip.css("left",m.clientX+document.body.scrollLeft+20).css("top",m.clientY+document.body.scrollTop-20);tip.html(h)}DoTouchMove(m,m.clientX+document.body.scrollLeft,m.clientY+document.body.scrollTop)}).dblclick(function(n){if(cvjs_Url_click_control==2){currentUrlId=this.data("id");currentUrlName=this.data("name");var m=findUrl(currentUrlId);if(m.indexOf("http://")==-1){if(cvjs_Url_encapsulate_callback){cvjs_Url_callback(vqURLs[m].data("url"))}else{if(openHyperlinkInNewWindow){window.open(current_FileNamePath+vqURLs[m].data("url"),"CADViewerJS","width="+hyperlinkNewWindowWidth+", height="+hyperlinkNewWindowHeight)}else{document.location.href=current_FileNamePath+vqURLs[m].data("url")}}}else{if(cvjs_Url_encapsulate_callback){cvjs_Url_callback(vqURLs[m].data("url"))}else{if(openHyperlinkInNewWindow){window.open(vqURLs[m].data("url"),"CADViewerJS","width="+hyperlinkNewWindowWidth+", height="+hyperlinkNewWindowHeight)}else{document.location.href=vqURLs[m].data("url")}}}cvjs_clearDrawingHyperlinks();rid=this.data("id");change_space_fixed_locationHyperlink(rid)}vqRoomMouseSelect=false}).click(function(n){if(cvjs_Url_click_control==1){currentUrlId=this.data("id");currentUrlName=this.data("name");var m=findUrl(currentUrlId);if(m.indexOf("http://")==-1){if(cvjs_Url_encapsulate_callback){cvjs_Url_callback(vqURLs[m].data("url"))}else{if(openHyperlinkInNewWindow){window.open(current_FileNamePath+vqURLs[m].data("url"),"CADViewerJS","width="+hyperlinkNewWindowWidth+", height="+hyperlinkNewWindowHeight)}else{document.location.href=current_FileNamePath+vqURLs[m].data("url")}}}else{if(cvjs_Url_encapsulate_callback){cvjs_Url_callback(vqURLs[m].data("url"))}else{if(openHyperlinkInNewWindow){window.open(vqURLs[m].data("url"),"CADViewerJS","width="+hyperlinkNewWindowWidth+", height="+hyperlinkNewWindowHeight)}else{document.location.href=vqURLs[m].data("url")}}}cvjs_clearDrawingHyperlinks();rid=this.data("id");change_space_fixed_locationHyperlink(rid)}vqRoomMouseSelect=false})}}if(k==0){var b=vqURLs[l].data("node");window.alert("room not found "+b);vqURLs[l].data("name","undefined");vqURLs[l].data("id",b);vqRooms[l].data("layer","undefined");vqRooms[l].data("group","undefined");vqRooms[l].data("url","undefined");vqRooms[l].data("linked",false)}layer_hyperlinks.add(vqURLs[l])}};