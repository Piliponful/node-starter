var cvjs_versionNumber="CADViewer JS - v2.1.66";var winHeight=0;var winWidth=0;var fpWidth=0;var isSmartPhoneOrTablet=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Touch/i.test(navigator.userAgent);var lastElem=null;var lastStroke=null;var lastStrokeWidth=null;var mousex=100;var mousey=100;var lastLink="";var flip=0;var spaceId=-1;var spaceIdStickyNote=-1;var viewBoxWidth=100;var viewBoxHeight=100;var viewBox={X:0,Y:0,width:100,height:100};var viewBox_initX=0;var viewBox_initY=0;var viewBoxWidth_init=100;var viewBoxHeight_init=100;var deltaX=0;var deltaY=0;var deltaXinit=0;var deltaYinit=0;var deltaBase=1;var deltaDynamic=1;var deltaDynamicPre=1;var rpWidth=100;var rpHeight=100;var zoomScale=1;var panWithThumb=false;var dragMoveControl=true;var masterBackground;var cvjs_Url_click_control=1;var cvjs_Url_encapsulate_callback=false;var VqSetup=false;var defaultColor={fill:"#FFF","fill-opacity":"0.1",stroke:"#CCC","stroke-width":1,"stroke-linejoin":"round"};var highlight={fill:"#a4d7f4","fill-opacity":"0.5",stroke:"#a4d7f4","stroke-width":3};var selectColor={fill:"#5BBEF6","fill-opacity":"0.5",stroke:"#5BBEF6","stroke-width":3};var defaultColor_Hyperlinks={fill:"#FFF","fill-opacity":"0.1",stroke:"#FFF","stroke-width":3,"stroke-opacity":0.01,"stroke-linejoin":"round"};var highlight_Hyperlinks={fill:"#a4d7f4","fill-opacity":"0.6",stroke:"#FFd7f4","stroke-width":3,"stroke-opacity":0.6,"stroke-linejoin":"round"};var selectColor_Hyperlinks={fill:"#FFBEF6","fill-opacity":"0.6",stroke:"#FFd7f4","stroke-width":3,"stroke-opacity":0.6,"stroke-linejoin":"round"};var defaultColor_Hyperlinks_blank={fill:"#FFF","fill-opacity":"0.1",stroke:"#FFF","stroke-width":3,"stroke-opacity":0.01,"stroke-linejoin":"round"};var defaultColor_StickyNotes={fill:"#E7E7E7"};var highlight_StickyNotes={fill:"#a4d7f4"};var selectColor_StickyNotes={fill:"#5BBEF6"};var defaultColor_unlinked={fill:"#ffff99","fill-opacity":"0.3",stroke:"#ffff99","stroke-width":1,"stroke-opacity":"0.1","stroke-linejoin":"round"};var highlight_unlinked={fill:"#ffff99","fill-opacity":"0.5",stroke:"#ffff99","stroke-width":3,"stroke-opacity":"1"};var selectColor_unlinked={fill:"#ff9999","fill-opacity":"0.5",stroke:"#ff9999","stroke-width":3,"stroke-opacity":"1"};var defaultColor_linked={fill:"#a4d7f4","fill-opacity":"0.3",stroke:"#a4d7f4","stroke-width":1,"stroke-opacity":"0.1","stroke-linejoin":"round"};var highlight_linked={fill:"#a4d7f4","fill-opacity":"0.5",stroke:"#a4d7f4","stroke-width":3,"stroke-opacity":"1"};var selectColor_linked={fill:"#41A458","fill-opacity":"0.5",stroke:"#41A458","stroke-width":3,"stroke-opacity":"1"};function cvjs_currentURL(){var a=window.location.href;return(a)}function cvjs_currentHost(){var a=window.location.hostname;return(a)}function cvjs_mysimple_encode(b){b=ABC.toAscii(b);var d="";key=0;var h=b.charAt(0);var m=h;d="";for(var g=0;g<m;g++){var a="";for(var f=0;f<3;f++){var e=b.charAt(1+(g*3)+f);var k=e.toString();a+=k}var c=parseInt(a);c=256-c;d+=String.fromCharCode(c)}key=parseInt(d);var l="";for(var g=0;g<(b.length-1-m*3)/3;g++){var a="";for(var f=0;f<3;f++){var e=b.charAt(1+m*3+(g*3)+f);var k=e.toString();a+=k}var c=parseInt(a);c=256-c;l+=String.fromCharCode(c)}return l}var ABC={toAscii:function(a){return a.replace(/\s*[01]{8}\s*/g,function(b){return String.fromCharCode(parseInt(b,2))})},toBinary:function(b,a){return b.replace(/[\s\S]/g,function(c){c=ABC.zeroPad(c.charCodeAt().toString(2));return !1==a?c:c+" "})},zeroPad:function(a){return"00000000".slice(String(a).length)+a}};var cvjs_LicenseKeyPath="../javascripts/";var cvjs_isLicensed=false;function cvjs_setLicenseKeyPath(a){cvjs_LicenseKeyPath=a;try{loadJSbase(cvjs_LicenseKeyPath+"cvlicense.js")}catch(b){window.alert("Could not find license key at path "+a);cvjs_isLicensed=false}}var cvjs_licenseKeyLoaded=false;function CheckLicenseLoad(h,a,c,b,e){if(cvjs_licenseKeyLoaded){load_failures=0;try{if(cvjsLicenseKey.cvKey==undefined){cvjs_isLicensed=false}}catch(f){cvjs_isLicensed=false}var d=cvjs_currentURL();var g=cvjs_mysimple_encode(cvjsLicenseKey.cvKey);if(d.indexOf(g)>-1){cvjs_isLicensed=true}else{cvjs_isLicensed=false}cvjs_LoadDrawing_Conversion_original(h,a,c,b,e)}else{if(load_failures<5){load_failures++;setTimeout(function(){CheckLicenseLoad(h,a,c,b,e)},256)}else{cvjs_isLicensed=false;load_failures=0;cvjs_LoadDrawing_Conversion_original(h,a,c,b,e)}}}function cvjs_checkLicensePreThenLoad(e,a,c,b,d){load_failures=0;CheckLicenseLoad(e,a,c,b,d)}function cvjs_checkLicense(){try{if(cvjsLicenseKey.cvKey==undefined){var i=$("#floorPlan").height();var a=$("#floorPlan").width();var d=actualURY-actualLLY;var b=d*0.04;var j='{ "font-size" : "'+b+'" , "font-family": "arial" }';var f;try{f=$.parseJSON(j)}catch(c){window.alert(c)}var g=rPaper.text(actualLLX+(actualURX-actualLLX)*0.2,actualLLY+(actualURY-actualLLY)*0.2,"CADViewer JS Trial Version").attr(f).attr({fill:"rgb(237,137,137)",stroke:"rgb(237,137,137)","fill-opacity":"1"});masterBackground.add(g);window.alert("License key not found or corrupt! Your CADViewer JS URl is: "+cvjs_currentURL());return}}catch(c){var d=actualURY-actualLLY;var b=d*0.04;var j='{ "font-size" : "'+b+'" , "font-family": "arial" }';var f;try{f=$.parseJSON(j)}catch(c){window.alert(c)}var g=rPaper.text(actualLLX+(actualURX-actualLLX)*0.2,actualLLY+(actualURY-actualLLY)*0.2,"CADViewer JS Trial Version").attr(f).attr({fill:"rgb(237,137,137)",stroke:"rgb(237,137,137)","fill-opacity":"1"});masterBackground.add(g);cvjs_isLicensed=false;window.alert("License key not found or corrupt! Your CADViewer JS URl is: "+cvjs_currentURL());return}var h=cvjs_currentURL();var e=cvjs_mysimple_encode(cvjsLicenseKey.cvKey);if(h.indexOf(e)>-1){cvjs_isLicensed=true}else{var d=actualURY-actualLLY;var b=d*0.04;var j='{ "font-size" : "'+b+'" , "font-family": "arial" }';var f;try{f=$.parseJSON(j)}catch(c){window.alert(c)}var g=rPaper.text(actualLLX+(actualURX-actualLLX)*0.2,actualLLY+(actualURY-actualLLY)*0.2,"CADViewer JS Trial Version").attr(f).attr({fill:"rgb(237,137,137)",stroke:"rgb(237,137,137)","fill-opacity":"1"});masterBackground.add(g);window.alert(e+" is NOT licensed for: "+h);cvjs_isLicensed=false}}function cvjs_version(){return(cvjs_versionNumber)}var cvjs_stickynote=0;var cvjs_redline=0;var cvjs_StickyNoteRedlineUrl="";var cvjs_StickyNoteSaveRedlineUrl="";var cvjs_phpSaveRedlineUrlLocation="../php/save-file-p1.php";function cvjs_setPhpSaveRedlineUrlLocation(a){cvjs_phpSaveRedlineUrlLocation=a}function cvjs_setStickyNoteRedlineUrl(a){cvjs_StickyNoteRedlineUrl=a}function cvjs_setStickyNoteSaveRedlineUrl(a){cvjs_StickyNoteSaveRedlineUrl=a}function cvjs_drawRedline_Freehand_setValues(){cvjs_redline++;cvjs_setCurrentRedlineValues("RED_"+cvjs_redline,"redline"+cvjs_redline,cvjs_redline,"RedLineLayer","unassigned","#AA0055",3);cvjs_drawRedline_Freehand()}function cvjs_drawStickyNote_setValues(){var a=new Date();cvjs_stickynote++;cvjs_setCurrentStickyNoteValues("SNOTE_"+cvjs_stickynote,"myName",cvjs_stickynote,"StickNoteLayer","unassigned","","X201",a,true);cvjs_drawStickyNote()}function cvjs_deleteLastRedline(){var a="RED_"+cvjs_redline;cvjs_setUpVqRedlines_deleteNode(a);cvjs_redline--}function cvjs_deleteAllRedlines(){while(cvjs_redline>0){var a="RED_"+cvjs_redline;cvjs_setUpVqRedlines_deleteNode(a);cvjs_redline--}}function cvjs_deleteAllStickyNotes(){while(cvjs_stickynote>0){cvjs_stickynote--;try{var a=vqStickyNotes[cvjs_stickynote].data("node");cvjs_setUpStickyNotes_deleteNode(a)}catch(b){}}}var stickyNotetimer;function cvjs_loadStickyNotesRedlines(){if(current_redline_js_initialized==0){current_redline_js_initialized=1;current_jsRedlinename=cvjs_StickyNoteRedlineUrl;loadJSbase(cvjs_StickyNoteRedlineUrl)}else{replacejscssfile(current_jsRedlinename,cvjs_StickyNoteRedlineUrl,"js");current_jsRedlinename=cvjs_StickyNoteRedlineUrl}if(stickynotesRedlines_loaded){load_failures=0;cvjs_setUpStickyNotesRedlines(rPaper);for(var b in vqStickyNotes){for(var a in cvjs_stickyNotesRedlines){if(a==vqStickyNotes[b].data("node")){cvjs_setCurrentStickyNoteValues(a,cvjs_stickyNotesRedlines[a].name,cvjs_stickyNotesRedlines[a].id,cvjs_stickyNotesRedlines[a].layer,cvjs_stickyNotesRedlines[a].group,cvjs_stickyNotesRedlines[a].text,cvjs_stickyNotesRedlines[a].userid,cvjs_stickyNotesRedlines[a].date,cvjs_stickyNotesRedlines[a].linked);cvjs_setUpVqStickyNotes_currentNode_vqIndex(rPaper,cvjs_currentStickyNote_underbar,b)}}}for(var b in vqRedlines){for(var a in cvjs_stickyNotesRedlines){if(a==vqRedlines[b].data("node")){cvjs_setCurrentRedlineValues(a,cvjs_stickyNotesRedlines[a].name,cvjs_stickyNotesRedlines[a].id,cvjs_stickyNotesRedlines[a].layer,cvjs_stickyNotesRedlines[a].group,cvjs_stickyNotesRedlines[a].color,cvjs_stickyNotesRedlines[a].lineWidth);cvjs_setUpVqRedlines_currentNode(rPaper,cvjs_currentRedline_underbar)}}}stickynote=vqStickyNotes.length;redline=vqRedlines.length}else{if(load_failures<80){setTimeout(function(){cvjs_loadStickyNotesRedlines()},256)}else{window.alert("Readline Load Failed! - please check if redline Url is set correct: cvjs_setStickyNoteRedlineUrl()")}}}function cvjs_saveStickyNotesRedlines(){var e="";var a=0;e=e+"var cvjs_stickyNotesRedlines = {\n";for(spc in vqRedlines){if(vqRedlines[spc].data("deleted")==true){window.alert("file.js deleted node "+vqRedlines[spc].data("node"))}else{if(a==0){a=1}else{e=e+"						,\n"}e=e+"					"+vqRedlines[spc].data("node")+": {\n";e=e+'						name: "'+vqRedlines[spc].data("name")+'",\n';e=e+'						id: "'+vqRedlines[spc].data("id")+'",\n';e=e+'						layer: "'+vqRedlines[spc].data("layer")+'",\n';e=e+'						group: "'+vqRedlines[spc].data("group")+'",\n';e=e+'						color: "'+vqRedlines[spc].data("color")+'",\n';e=e+'						strokeWidth: "'+vqRedlines[spc].data("strokeWidth")+'"\n';e=e+"					}\n"}}if(vqRedlines.length>0){e=e+"						,\n"}a=0;for(spc in vqStickyNotes){if(vqStickyNotes[spc].data("deleted")==true){window.alert("file.js deleted node "+vqStickyNotes[spc].data("node"))}else{if(a==0){a=1}else{e=e+"						,\n"}e=e+"					"+vqStickyNotes[spc].data("node")+": {\n";e=e+'						name: "'+vqStickyNotes[spc].data("name")+'",\n';e=e+'						id: "'+vqStickyNotes[spc].data("id")+'",\n';e=e+'						layer: "'+vqStickyNotes[spc].data("layer")+'",\n';e=e+'						group: "'+vqStickyNotes[spc].data("group")+'",\n';e=e+'						text: "'+vqStickyNotes[spc].data("text")+'",\n';e=e+'						userid: "'+vqStickyNotes[spc].data("userid")+'",\n';e=e+'						date: "'+vqStickyNotes[spc].data("date")+'",\n';e=e+"						linked: "+vqStickyNotes[spc].data("linked")+"\n";e=e+"					}\n"}}e=e+"}\n\n";e=e+"function cvjs_setUpStickyNotesRedlines(paper){\n\n";var d=0;for(spc in vqRedlines){if(vqRedlines[spc].data("deleted")==true){window.alert("file.js deleted node "+vqRedlines[spc].data("node"))}else{d++;var c="cItemRed"+d;var h=vqRedlines[spc].toString();if(h.indexOf("path")>-1){h=h.substring(h.indexOf("d=")+3);h=h.substring(0,h.indexOf('"'));e=e+"var "+c+'= paper.path("';e=e+h+' ")';e=e+'.attr({stroke: "'+vqRedlines[spc].data("color")+'", "stroke-width": '+vqRedlines[spc].data("strokeWidth")+', fill: "none"})';e=e+'\n.data("node","'+vqRedlines[spc].data("node")+'");\n';e=e+"vqRedlines.push("+c+");\n\n"}}}e=e+" cvjs_redline="+d+"; \n\n";var d=0;for(spc in vqStickyNotes){if(vqStickyNotes[spc].data("deleted")==true){window.alert("file.js deleted node "+vqStickyNotes[spc].data("node"))}else{d++;var b="itemSNote"+d;var h=vqStickyNotes[spc].toString();var f=0;if(vqStickyNotes[spc].data("id")<10){f=3}var g='paper.group(paper.path("M0,0h20v20h-20v-20Z").attr({stroke: "#000000", "stroke-width" : "1.0"}),paper.path("M7,12h1.3M9.5,12h3.5M11.25,12v5M9.75,12v1.75M12.75,12v1.75M10.5,17h1.5M7,13.5h1.3M7,15.25h3M7,17.0h2.2").attr({stroke: "#000000", "stroke-width" : "0.5"}),paper.text('+(3+f)+',9,"#'+vqStickyNotes[spc].data("id")+'").attr({"font-size": "8px", "font-style": "italic", stroke: "#000000", "stroke-width" : "0.3", "stroke" : "0.3", "fill" : "#000000", "fill-opacity" : 1.0}))';g=g+".attr({'transform': \""+vqStickyNotes[spc].data("transform")+'" , "opacity" : "1"})';g=g+".attr({	fill: '#FFF', \"fill-opacity\": \"0.8\", stroke: '#000', 'stroke-opacity': \"1\" })";e=e+"var "+b+"="+g+'\n.data("node","'+vqStickyNotes[spc].data("node")+'");\n';e=e+"vqStickyNotes.push("+b+");\n\n"}}e=e+" cvjs_stickynote="+d+"; \n\n";e=e+"}\n";e=e+"\n$(document).ready(function() { \n";e=e+"	stickynotesRedlines_loaded = true; \n";e=e+"}); \n";e=e+"stickynotesRedlines_loaded = true; \n";var i={};i.file=encodeURIComponent(cvjs_StickyNoteSaveRedlineUrl);i.file_content=e;$.ajax({url:cvjs_phpSaveRedlineUrlLocation,type:"post",data:i,success:function(j){window.alert("save redline: "+j)}})}function cvjs_printCanvas(){var a=$("#floorPlan").html();var i=a.substring(a.indexOf("<rect"));i=i.substring(5,i.indexOf("</rect>"));var f;var c;var o;var l;f=i.substring(i.indexOf("x=")+3);f=f.substring(0,f.indexOf('"'));c=i.substring(i.indexOf("y=")+3);c=c.substring(0,c.indexOf('"'));o=i.substring(i.indexOf("width=")+7);o=o.substring(0,o.indexOf('"'));l=i.substring(i.indexOf("height=")+8);l=l.substring(0,l.indexOf('"'));var e=Number(f);var d=Number(c);var g=Number(o);var j=Number(l);var e=viewBox.X;var d=viewBox.Y;var g=viewBoxWidth;var j=viewBoxHeight;var k=d+j;var n=e+g;a='<svg height="'+k+'" width="'+n+'" viewBox="'+e+" "+d+" "+g+" "+j+'">'+a+"</svg>";var m=$("#floorPlanCanvasObject")[0].getContext("2d");m.canvas.height=j;m.canvas.width=g;$("#floorPlanCanvasObject").width(g);$("#floorPlanCanvasObject").height(j);canvg("floorPlanCanvasObject",a);var b=document.getElementById("floorPlanCanvasObject");var h=b.toDataURL("image/png");$("#floorPlanCanvasObject").hide();if(cvjs_printOrientation.indexOf("landscape")==0){cvjs_printImageRotated(h,screen.width*0.5,screen.height*0.75)}else{cvjs_printImage(h,screen.width*0.5,screen.height*0.75)}}function cvjs_printImage(c,d,b){var a=window.open("","CADViewer JS - Print","height="+b+",width="+d);a.document.write("<html><head><title>CADViewer JS - Print</title>");a.document.write("<style>");a.document.write(" body {");a.document.write("     height: 269mm;");a.document.write("     width: 210mm;");a.document.write("     /* to centre page on screen*/");a.document.write("     margin-left: auto;");a.document.write("     margin-right: auto;");a.document.write(" }");a.document.write(" </style> ");a.document.write("</head><body ><img src='");a.document.write(c);a.document.write('\'  style="max-width: 95%;" /></body></html>');a.document.close();a.print()}function cvjs_printImageRotated(c,e,b){var a=window.open("","CADViewer JS - Print","height="+b+",width="+e);a.document.write("<html><head><title>CADViewer JS - Print</title>");var d=(269-210)/2;a.document.write("<style>");a.document.write(" body {");a.document.write("     height: 269mm;");a.document.write("     width: 210mm;");a.document.write("     /* to centre page on screen*/");a.document.write("     margin-left: auto;");a.document.write("     margin-right: auto;");a.document.write("     -webkit-transform: rotate(90deg);");a.document.write("     -moz-transform: rotate(90deg);");a.document.write("     transform: rotate(90deg) translate("+d+"mm, 0mm);");a.document.write(" }");a.document.write(" </style> ");a.document.write("</head><body ><img src='");a.document.write(c);a.document.write('\'  style="max-height: 95%; style="max-width: 95%;" /></body></html>');a.document.close();a.print()}function cvjs_printImagePDF(c,d,b){var a=window.open("./testpdf.html","CADViewer JS - Print","height="+b+",width="+d)}var cvjs_printPaperSize="A4";var cvjs_printPaperWidth_mm=297;var cvjs_printPaperHeight_mm=210;var cvjs_printOrientation="portrait";var cvjs_printResolutionDpi=300;var cvjs_printPixelWidth=3508;var cvjs_printPixelHeight=2480;var cvjs_objectIsZoomedExtents=true;function cvjs_setPrintPaperSize(a){a=a.toLowerCase();if(a.indexOf("a4")==0){cvjs_printPaperSize="A4";cvjs_printPaperWidth_mm=297;cvjs_printPaperHeight_mm=210}if(a.indexOf("a3")==0){cvjs_printPaperSize="A3";cvjs_printPaperWidth_mm=420;cvjs_printPaperHeight_mm=297}if(a.indexOf("a2")==0){cvjs_printPaperSize="A2";cvjs_printPaperWidth_mm=594;cvjs_printPaperHeight_mm=420}if(a.indexOf("ansi a")==0){cvjs_printPaperSize="ANSI A";cvjs_printPaperWidth_mm=279.4;cvjs_printPaperHeight_mm=215.9}if(a.indexOf("ansi b")==0){cvjs_printPaperSize="ANSI B";cvjs_printPaperWidth_mm=431.8;cvjs_printPaperHeight_mm=279.4}if(a.indexOf("ansi c")==0){cvjs_printPaperSize="ANSI C";cvjs_printPaperWidth_mm=555.8;cvjs_printPaperHeight_mm=431.8}if(a.indexOf("us letter")==0){cvjs_printPaperSize="US Letter";cvjs_printPaperWidth_mm=279.4;cvjs_printPaperHeight_mm=215.9}cvjs_printPixelWidth=Math.round(cvjs_printPaperWidth_mm*cvjs_printResolutionDpi/(2.54*10));cvjs_printPixelHeight=Math.round(cvjs_printPaperHeight_mm*cvjs_printResolutionDpi/(2.54*10))}function cvjs_setPrintResolutionDpi(a){if(a>75){cvjs_printResolutionDpi=a;cvjs_printPixelWidth=Math.round(cvjs_printPaperWidth_mm*cvjs_printResolutionDpi/(2.54*10));cvjs_printPixelHeight=Math.round(cvjs_printPaperHeight_mm*cvjs_printResolutionDpi/(2.54*10))}}function cvjs_setPrintOrientation(a){a=a.toLowerCase();if(a.indexOf("landscape")==0){cvjs_printOrientation="landscape"}if(a.indexOf("portrait")==0){cvjs_printOrientation="portrait"}}function cvjs_printCanvasPaperSize(){if(!cvjs_objectIsZoomedExtents){cvjs_printCanvas();return}var n=$("#floorPlan").html();var s=n.substring(n.indexOf("<rect"));s=s.substring(5,s.indexOf("</rect>"));var o;var e;var d;var f;o=s.substring(s.indexOf("x=")+3);o=o.substring(0,o.indexOf('"'));e=s.substring(s.indexOf("y=")+3);e=e.substring(0,e.indexOf('"'));d=s.substring(s.indexOf("width=")+7);d=d.substring(0,d.indexOf('"'));f=s.substring(s.indexOf("height=")+8);f=f.substring(0,f.indexOf('"'));var q=Number(o);var j=Number(e);var c=Number(d);var a=Number(f);var q=viewBox.X;var j=viewBox.Y;var c=viewBoxWidth;var a=viewBoxHeight;var k=j+a;var i=q+c;n='<svg height="'+k+'" width="'+i+'" viewBox="'+q+" "+j+" "+c+" "+a+'">'+n+"</svg>";var b='<svg height="'+k+'" width="'+i+'" viewBox="'+q+" "+j+" "+c+" "+a+'"></svg>';var r=i/k;var m=cvjs_printPixelWidth/cvjs_printPixelHeight;var p=$("#floorPlanCanvasObject")[0].getContext("2d");if(r<m){var h=cvjs_printPixelHeight/k/1.01;if(cvjs_printPaperSize.toLowerCase().indexOf("us letter")==0||cvjs_printPaperSize.toLowerCase().indexOf("ansi a")==0||cvjs_printPaperSize.toLowerCase().indexOf("ansi b")==0||cvjs_printPaperSize.toLowerCase().indexOf("ansi c")==0){h=h/(297/279.4)}k=k*h;i=i*h;q=q;j=j;p.canvas.height=Math.round(cvjs_printPixelHeight);p.canvas.width=Math.round(cvjs_printPixelWidth);$("#floorPlanCanvasObject").height(Math.round(cvjs_printPixelHeight));$("#floorPlanCanvasObject").width(Math.round(cvjs_printPixelWidth))}else{var h=cvjs_printPixelWidth/i/1.01;if(cvjs_printPaperSize.toLowerCase().indexOf("us letter")==0||cvjs_printPaperSize.toLowerCase().indexOf("ansi a")==0||cvjs_printPaperSize.toLowerCase().indexOf("ansi b")==0||cvjs_printPaperSize.toLowerCase().indexOf("ansi c")==0){h=h/(297/279.4)}k=k*h;i=i*h;q=q;j=j;p.canvas.height=Math.round(cvjs_printPixelHeight);p.canvas.width=Math.round(cvjs_printPixelWidth);$("#floorPlanCanvasObject").height(Math.round(cvjs_printPixelHeight));$("#floorPlanCanvasObject").width(Math.round(cvjs_printPixelWidth))}$("#floorPlanCanvasObject").hide();canvg("floorPlanCanvasObject",n,{ignoreMouse:true,ignoreAnimation:true,ignoreDimensions:true,log:true,scaleWidth:i,scaleHeight:k,offsetX:q,offSetY:j});var g=document.getElementById("floorPlanCanvasObject");var t=g.toDataURL("image/png");var l=(cvjs_printPixelWidth-cvjs_printPixelHeight)/2;if(cvjs_printOrientation.indexOf("landscape")==0){cvjs_printImagePaperSizeRotated(t,screen.width*0.5,screen.height*0.75)}else{cvjs_printImagePaperSize(t,screen.width*0.5,screen.height*0.75)}}function cvjs_printImagePaperSizeRotated(e,g,c){var a=window.open("","CADViewer JS - Print","height="+c+",width="+g);a.document.write("<html><head><title>CADViewer JS - Print</title>");a.document.write("<style>");a.document.write(" body {");var d=cvjs_printPaperWidth_mm-10;var b=cvjs_printPaperHeight_mm-10;var f=(cvjs_printPaperWidth_mm-cvjs_printPaperHeight_mm)/2;a.document.write("     height: "+b+"mm;");a.document.write("     width: "+d+"mm;");a.document.write("     /* to centre page on screen*/");a.document.write("     margin-left: auto;");a.document.write("     margin-right: auto;");a.document.write("     -webkit-transform: rotate(90deg);");a.document.write("     -moz-transform: rotate(90deg);");a.document.write("     transform: rotate(90deg) translate("+f+"mm, 0mm);");a.document.write(" }");a.document.write(" </style> ");a.document.write("</head><body ><img src='");a.document.write(e);a.document.write('\'  style="max-height: 95%; style="max-width: 95%;" /></body></html>');a.document.close();a.print()}function cvjs_printImagePaperSize(e,f,c){var a=window.open("","CADViewer JS - Print","height="+c+",width="+f);a.document.write("<html><head><title>CADViewer JS - Print</title>");a.document.write("<style>");a.document.write(" body {");var b=cvjs_printPaperWidth_mm-10;var d=cvjs_printPaperHeight_mm-10;a.document.write("     height: "+d+"mm;");a.document.write("     width: "+b+"mm;");a.document.write("     /* to centre page on screen*/");a.document.write("     margin-left: auto;");a.document.write("     margin-right: auto;");a.document.write(" }");a.document.write(" </style> ");a.document.write("</head><body ><img src='");a.document.write(e);a.document.write('\'  style="max-height: 95%; style="max-width: 95%;" /></body></html>');a.document.close();a.print()}function cvjs_firstPage(){try{var d=multiPages.multiPages;var f=multiPages.currentPage;var e=0;if(e==f-1){window.alert("First page");return}var b=multiPages.pages[e].fileName;if(cvjs_loadDrawing_conversionMode){if(cvjs_conversion_getContentResponse()=="file"){cvjs_LoadDrawing("floorPlan",cvjs_loaddrawing_FileNamePath,b)}if(cvjs_conversion_getContentResponse()=="stream"){if(multiPages.pages[e].pageName=="ModelSpace"){var g=true;for(var a=0;a<rest_nname.length;a++){if(rest_nname[a]=="layout"&&g){g=false;rest_nname[a]="model";rest_vvalue[a]=""}}if(g){rest_nname[rest_nname.length]="model";rest_vvalue[rest_nname.length]=""}}else{var g=true;for(var a=0;a<rest_nname.length;a++){if(rest_nname[a]=="basic"){g=false;rest_nname[a]="layout";rest_vvalue[a]=multiPages.pages[e].pageName}if(rest_nname[a]=="layout"&&g){g=false;rest_nname[a]="layout";rest_vvalue[a]=multiPages.pages[e].pageName}if(rest_nname[a]=="model"&&g){g=false;rest_nname[a]="layout";rest_vvalue[a]=multiPages.pages[e].pageName}}if(g){rest_nname[rest_nname.length]="layout";rest_vvalue[rest_nname.length]=multiPages.pages[e].pageName}}cvjs_LoadDrawing_Conversion("floorPlan",cvjs_conversion_originatingFile,b,cvjs_conversion_originatingUsername,cvjs_conversion_originatingPassword)}}else{cvjs_LoadDrawing("floorPlan",cvjs_loaddrawing_FileNamePath,b)}}catch(c){var a=0}}function cvjs_lastPage(){try{var d=multiPages.multiPages;var f=multiPages.currentPage;var e=d-1;if(e==f-1){window.alert("Last page");return}var b=multiPages.pages[e].fileName;if(cvjs_loadDrawing_conversionMode){if(cvjs_conversion_getContentResponse()=="file"){cvjs_LoadDrawing("floorPlan",cvjs_loaddrawing_FileNamePath,b)}if(cvjs_conversion_getContentResponse()=="stream"){var g=true;if(multiPages.pages[e].pageName=="ModelSpace"){var g=true;for(var a=0;a<rest_nname.length;a++){if(rest_nname[a]=="layout"&&g){g=false;rest_nname[a]="model";rest_vvalue[a]=""}}if(g){rest_nname[rest_nname.length]="model";rest_vvalue[rest_nname.length]=""}}else{var g=true;for(var a=0;a<rest_nname.length;a++){if(rest_nname[a]=="basic"){g=false;rest_nname[a]="layout";rest_vvalue[a]=multiPages.pages[e].pageName}if(rest_nname[a]=="layout"&&g){g=false;rest_nname[a]="layout";rest_vvalue[a]=multiPages.pages[e].pageName}if(rest_nname[a]=="model"&&g){g=false;rest_nname[a]="layout";rest_vvalue[a]=multiPages.pages[e].pageName}}if(g){rest_nname[rest_nname.length]="layout";rest_vvalue[rest_nname.length]=multiPages.pages[e].pageName}}cvjs_LoadDrawing_Conversion("floorPlan",cvjs_conversion_originatingFile,b,cvjs_conversion_originatingUsername,cvjs_conversion_originatingPassword)}}else{cvjs_LoadDrawing("floorPlan",cvjs_loaddrawing_FileNamePath,b)}}catch(c){var a=0}}function cvjs_nextPage(){try{var d=multiPages.multiPages;var f=multiPages.currentPage;var e=f+1;e=e-1;if(e>d-1){window.alert("Last page");return}var b=multiPages.pages[e].fileName;if(cvjs_loadDrawing_conversionMode){if(cvjs_conversion_getContentResponse()=="file"){cvjs_LoadDrawing("floorPlan",cvjs_loaddrawing_FileNamePath,b)}if(cvjs_conversion_getContentResponse()=="stream"){if(multiPages.pages[e].pageName=="ModelSpace"){var g=true;for(var a=0;a<rest_nname.length;a++){if(rest_nname[a]=="layout"&&g){g=false;rest_nname[a]="model";rest_vvalue[a]=""}}if(g){rest_nname[rest_nname.length]="model";rest_vvalue[rest_nname.length]=""}}else{var g=true;for(var a=0;a<rest_nname.length;a++){if(rest_nname[a]=="basic"){g=false;rest_nname[a]="layout";rest_vvalue[a]=multiPages.pages[e].pageName}if(rest_nname[a]=="layout"&&g){g=false;rest_nname[a]="layout";rest_vvalue[a]=multiPages.pages[e].pageName}if(rest_nname[a]=="model"&&g){g=false;rest_nname[a]="layout";rest_vvalue[a]=multiPages.pages[e].pageName}}if(g){rest_nname[rest_nname.length]="layout";rest_vvalue[rest_nname.length]=multiPages.pages[e].pageName}}cvjs_LoadDrawing_Conversion("floorPlan",cvjs_conversion_originatingFile,b,cvjs_conversion_originatingUsername,cvjs_conversion_originatingPassword)}}else{cvjs_LoadDrawing("floorPlan",cvjs_loaddrawing_FileNamePath,b)}}catch(c){var a=0}}function cvjs_previousPage(){try{var d=multiPages.multiPages;var f=multiPages.currentPage;var e=f-1;e=e-1;if(e<0){window.alert("First page");return}var b=multiPages.pages[e].fileName;if(cvjs_loadDrawing_conversionMode){if(cvjs_conversion_getContentResponse()=="file"){cvjs_LoadDrawing("floorPlan",cvjs_loaddrawing_FileNamePath,b)}if(cvjs_conversion_getContentResponse()=="stream"){if(multiPages.pages[e].pageName=="ModelSpace"){var g=true;for(var a=0;a<rest_nname.length;a++){if(rest_nname[a]=="layout"&&g){g=false;rest_nname[a]="model";rest_vvalue[a]=""}}if(g){rest_nname[rest_nname.length]="model";rest_vvalue[rest_nname.length]=""}}else{var g=true;for(var a=0;a<rest_nname.length;a++){if(rest_nname[a]=="basic"){g=false;rest_nname[a]="layout";rest_vvalue[a]=multiPages.pages[e].pageName}if(rest_nname[a]=="layout"&&g){g=false;rest_nname[a]="layout";rest_vvalue[a]=multiPages.pages[e].pageName}if(rest_nname[a]=="model"&&g){g=false;rest_nname[a]="layout";rest_vvalue[a]=multiPages.pages[e].pageName}}if(g){rest_nname[rest_nname.length]="layout";rest_vvalue[rest_nname.length]=multiPages.pages[e].pageName}}cvjs_LoadDrawing_Conversion("floorPlan",cvjs_conversion_originatingFile,b,cvjs_conversion_originatingUsername,cvjs_conversion_originatingPassword)}}else{cvjs_LoadDrawing("floorPlan",cvjs_loaddrawing_FileNamePath,b)}}catch(c){var a=0}}function cvjs_setSupressHyperlinkColors(a){cvjs_supressHyperlinkColors=a}function cvjs_setUrl_singleDoubleClick(a){cvjs_Url_click_control=1;if(a==1){cvjs_Url_click_control=1}if(a==2){cvjs_Url_click_control=2}}var cvjs_Url_encapsulate_callback=false;function cvjs_encapsulateUrl_callback(a){cvjs_Url_encapsulate_callback=a}function cvjs_setPanState(a){panWithThumb=a}function cvjs_idObjectClicked(){if(lastObj>=0){var a=vqRooms[lastObj].data("id");return a}return -1}function cvjs_IdObjectClicked(){if(lastObj>=0){var a=vqRooms[lastObj].data("id");return a}return -1}function cvjs_NameObjectClicked(){if(lastObj>=0){var a=vqRooms[lastObj].data("name");return a}return -1}function cvjs_NodeObjectClicked(){if(lastObj>=0){var a=vqRooms[lastObj].data("node");return a}return -1}function cvjs_StickyNoteClicked(){if(lastObjStickyNote>=0){var a=vqStickyNotes[lastObjStickyNote].data("node");return a}return -1}function hoverIn(c){if(lastElem!=null){var a='{"stroke" : "'+lastStroke+'" , "stroke-opacity" : '+lastStrokeWidth+" }";var e=$.parseJSON(a);lastElem.attr(e);lastLink="";$("#display_tip").empty().hide()}lastElem=c;lastStroke=c.attr("stroke");lastStrokeWidth=c.attr("stroke-width");c.attr({stroke:"cyan","stroke-opacity":4});var b=c.data("hyperlink");var d={left:mousex+10,top:mousey+10};$("#tool_tip").html('<img src="../drawings/'+b+'" border="0" />').show().offset(d)}function hoverOut(a){}function doHyperlink(b){var c={left:mousex+10,top:mousey+10};var a=b.data("hyperlink");if(flip==0){flip=1;layer_all.drag();rPaper.attr({viewBox:"0 0 800 600"})}else{flip=0;layer_1.attr({transform:"rotate(10),scale(0.5)"});layer_2.attr({transform:"rotate(10),scale(0.5)"});layer_all.undrag()}if(lastLink!=a){lastLink=a;$("#display_tip").html('<img src="../drawings/'+a+'" border="0" >').show().offset(c)}else{lastLink="";$("#display_tip").empty().hide()}}function cvjs_windowResize(j,g,b,n,a){n="#"+n;a="#"+a;var f=0;var l=0;var i=navigator.userAgent.indexOf("Chrome")>-1;var e=navigator.userAgent.indexOf("Firefox")>-1;var d=(navigator.userAgent.indexOf("MSIE")>-1)||(navigator.userAgent.indexOf("Trident")>-1);var c=navigator.userAgent.indexOf("Safari")>-1;var k=navigator.userAgent.indexOf("Presto")>-1;if((i)&&(c)){c=false}if(d){l=2}winHeight=$(window).height()-g-l;winWidth=$(window).width()-f;var m=b;fpWidth=winWidth-m;rpWidth=fpWidth;rpHeight=winHeight;var h=0;$(a).width(fpWidth-h);$(a).height(winHeight);$(n).width(fpWidth-h-10);$(n).height(winHeight-12);floorplan_width=$(floorPlan).width()*0.9;floorplan_height=$(floorPlan).height()*0.9;if(j){ResizeVq(fpWidth-10,winHeight-10)}}function cvjs_windowResize_scrollbar(k,h,c,o,b,a){o="#"+o;b="#"+b;var g=a;var m=0;var j=navigator.userAgent.indexOf("Chrome")>-1;var f=navigator.userAgent.indexOf("Firefox")>-1;var e=(navigator.userAgent.indexOf("MSIE")>-1)||(navigator.userAgent.indexOf("Trident")>-1);var d=navigator.userAgent.indexOf("Safari")>-1;var l=navigator.userAgent.indexOf("Presto")>-1;if((j)&&(d)){d=false}if(e){m=2}winHeight=$(window).height()-h-m;winWidth=$(window).width()-g;var n=c;fpWidth=winWidth-n;rpWidth=fpWidth;rpHeight=winHeight;var i=0;$(b).width(fpWidth-i);$(b).height(winHeight);$(o).width(fpWidth-i-10);$(o).height(winHeight-12);floorplan_width=$(floorPlan).width()*0.9;floorplan_height=$(floorPlan).height()*0.9;if(k){ResizeVq(fpWidth-10,winHeight-10)}}function cvjs_windowResize_scrollbar_bordermargin(l,i,c,p,b,a,q){p="#"+p;b="#"+b;var h=a;var n=0;var e=q;var k=navigator.userAgent.indexOf("Chrome")>-1;var g=navigator.userAgent.indexOf("Firefox")>-1;var f=(navigator.userAgent.indexOf("MSIE")>-1)||(navigator.userAgent.indexOf("Trident")>-1);var d=navigator.userAgent.indexOf("Safari")>-1;var m=navigator.userAgent.indexOf("Presto")>-1;if((k)&&(d)){d=false}if(f){n=2}winHeight=$(window).height()-i-n;winWidth=$(window).width()-h;var o=c;fpWidth=winWidth-o;rpWidth=fpWidth;rpHeight=winHeight;var j=0;$(b).width(fpWidth-j);$(b).height(winHeight);$(p).width(fpWidth-j-e);$(p).height(winHeight-e);floorplan_width=$(floorPlan).width()*0.9;floorplan_height=$(floorPlan).height()*0.9;if(l){ResizeVq(fpWidth-e,winHeight-e)}}function cvjs_windowResize_position(d,f){f="#"+f;var h=navigator.userAgent.indexOf("Chrome")>-1;var b=navigator.userAgent.indexOf("Firefox")>-1;var g=(navigator.userAgent.indexOf("MSIE")>-1)||(navigator.userAgent.indexOf("Trident")>-1);var e=navigator.userAgent.indexOf("Safari")>-1;var c=navigator.userAgent.indexOf("Presto")>-1;if((h)&&(e)){e=false}var a=$(f).position();$(f).width($(window).width()-a.left);$(f).height($(window).height()-a.top);fpWidth=$(f).width();fpHeight=$(f).height();rpWidth=fpWidth;rpHeight=fpHeight;floorplan_width=$(f).width()*0.9;floorplan_height=$(f).height()*0.9;if(d){ResizeVq(fpWidth,fpHeight)}}function cvjs_windowResize_position_fixedHeightWidthRelation(i,a,k){k="#"+k;var h=navigator.userAgent.indexOf("Chrome")>-1;var f=navigator.userAgent.indexOf("Firefox")>-1;var e=(navigator.userAgent.indexOf("MSIE")>-1)||(navigator.userAgent.indexOf("Trident")>-1);var b=navigator.userAgent.indexOf("Safari")>-1;var j=navigator.userAgent.indexOf("Presto")>-1;if((h)&&(b)){b=false}var d=$(k).position();var g=$(window).width();var c=$(window).height();if(((c-d.top)/(g-d.left))>a){$(k).width($(window).width()-d.left);if((($(window).width()-d.left)*a)<($(window).height()-d.top)){$(k).height(($(window).width()-d.left)*a)}else{$(k).height($(window).height()-d.top)}}else{$(k).height($(window).height()-d.top);if((($(window).height()-d.top)/a)<($(window).width()-d.left)){$(k).width(($(window).height()-d.top)/a)}else{$(k).width($(window).width()-d.left)}}fpWidth=$(k).width();fpHeight=$(k).height();rpWidth=fpWidth;rpHeight=fpHeight;floorplan_width=$(k).width()*0.9;floorplan_height=$(k).height()*0.9;if(i){ResizeVq(fpWidth,fpHeight)}}function cvjs_windowResize_position_border(g,b,i){i="#"+i;var f=navigator.userAgent.indexOf("Chrome")>-1;var e=navigator.userAgent.indexOf("Firefox")>-1;var d=(navigator.userAgent.indexOf("MSIE")>-1)||(navigator.userAgent.indexOf("Trident")>-1);var a=navigator.userAgent.indexOf("Safari")>-1;var h=navigator.userAgent.indexOf("Presto")>-1;if((f)&&(a)){a=false}var c=$(i).position();$(i).width($(window).width()-c.left-b);$(i).height($(window).height()-c.top-b);fpWidth=$(i).width();fpHeight=$(i).height();rpWidth=fpWidth;rpHeight=fpHeight;floorplan_width=$(i).width()*0.9;floorplan_height=$(i).height()*0.9;if(g){ResizeVq(fpWidth,fpHeight)}}function cvjs_windowResize_fixedSize(h,b,a,j){j="#"+j;var g=navigator.userAgent.indexOf("Chrome")>-1;var f=navigator.userAgent.indexOf("Firefox")>-1;var e=(navigator.userAgent.indexOf("MSIE")>-1)||(navigator.userAgent.indexOf("Trident")>-1);var c=navigator.userAgent.indexOf("Safari")>-1;var i=navigator.userAgent.indexOf("Presto")>-1;if((g)&&(c)){c=false}var d=$(j).position();$(j).width(b);$(j).height(a);fpWidth=$(j).width();fpHeight=$(j).height();rpWidth=fpWidth;rpHeight=fpHeight;floorplan_width=$(j).width()*0.9;floorplan_height=$(j).height()*0.9;if(h){ResizeVq(fpWidth,fpHeight)}}if(!(window.console&&console.log)){console={log:function(){},debug:function(){},info:function(){},warn:function(){},error:function(){}}}var rPaper;var masterBackground;var lastObj;var popObj;var lastObjHyperlink=-1;var popObjHyperlink=-1;var lastObjStickyNote=-1;var popObjStickyNote=-1;var touchCount=0;var x1=0;var y1=0;var x2=0;var y2=0;var pdx=0;var pdy=0;var vbx=0;var vby=0;var basex,basey;var lastDx=0;var lastDy=0;var initFlagPolygons=true;var DefaultZoomFactor=1.3;function CheckPt(a,b){if(a<viewBox.X){return false}if(a>(viewBox.X+viewBox._viewBox[2])){return false}if(b<viewBox.Y){return false}if(b>(viewBox.Y+viewBox._viewBox[3])){return false}return true}function CheckRoomOnScreen(a){var c=a.getBBox();var b=CheckPt(c.x,c.y);b=b&&CheckPt(c.x2,c.y2);if(!b){if((c.width>viewBoxWidth)||(c.height>viewBoxHeight)){zoomHere()}else{viewBox.X=c.x+((c.width-viewBoxWidth)/2);viewBox.Y=c.y+((c.height-viewBoxHeight)/2);setView(rPaper,viewBox.X,viewBox.Y,viewBoxWidth,viewBoxHeight)}}}function findRoom(a){for(spc in vqRooms){var b=vqRooms[spc].data("id");if(b==a){return spc}}return -1}function findStickyNotes(a){for(spc in vqStickyNotes){var b=vqStickyNotes[spc].data("id");if(b==a){return spc}}return -1}function findUrl(a){for(spc in vqURLs){var b=vqURLs[spc].data("id");if(b==a){return spc}}return -1}function findRoomById(a){for(spc in vqRooms){if(vqRooms[spc].data("id")==a){return spc}}return -1}function findIdFromNode(a){for(spc in vqRooms){if(vqRooms[spc].data("node")==a){return vqRooms[spc].data("id")}}return -1}function hidePop(){if(lastObj>=0){$(vqRooms[lastObj].node).qtip("hide");if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){vqRooms[lastObj].attr(defaultColor)}else{if(vqRooms[lastObj].data("linked")){vqRooms[lastObj].attr(defaultColor_linked)}else{vqRooms[lastObj].attr(defaultColor_unlinked)}}lastObj=-1}if(popObj>=0){$(vqRooms[popObj].node).qtip("hide");if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){vqRooms[popObj].attr(defaultColor)}else{if(vqRooms[popObj].data("linked")){vqRooms[popObj].attr(defaultColor_linked)}else{vqRooms[popObj].attr(defaultColor_unlinked)}}popObj=-1}}function hidePopStickyNotes(){if(lastObjStickyNote>=0){$(vqStickyNotes[lastObjStickyNote].node).qtip("hide");if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){vqStickyNotes[lastObjStickyNote].attr(defaultColor_StickyNotes)}else{if(vqStickyNotes[lastObjStickyNote].data("linked")){vqStickyNotes[lastObjStickyNote].attr(defaultColor_linked)}else{vqStickyNotes[lastObjStickyNote].attr(defaultColor_unlinked)}}lastObjStickyNote=-1}if(popObjStickyNote>=0){$(vqStickyNotes[popObjStickyNote].node).qtip("hide");if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){vqStickyNotes[popObjStickyNote].attr(defaultColor_StickyNotes)}else{if(vqStickyNotes[popObjStickyNote].data("linked")){vqStickyNotes[popObjStickyNote].attr(defaultColor_linked)}else{vqStickyNotes[popObjStickyNote].attr(defaultColor_unlinked)}}popObjStickyNote=-1}}function cvjs_hidePop(){window.alert("cvjs_hidePop  lastObj="+lastObj);try{if(lastObj>=0){$(vqRooms[lastObj].node).qtip("hide");if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){vqRooms[lastObj].attr(defaultColor)}else{if(vqRooms[lastObj].data("linked")){vqRooms[lastObj].attr(defaultColor_linked)}else{vqRooms[lastObj].attr(defaultColor_unlinked)}}lastObj=-1}if(popObj>=0){$(vqRooms[popObj].node).qtip("hide");if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){vqRooms[popObj].attr(defaultColor)}else{if(vqRooms[popObj].data("linked")){vqRooms[popObj].attr(defaultColor_linked)}else{vqRooms[popObj].attr(defaultColor_unlinked)}}popObj=-1}}catch(a){return(a)}return true}function cvjs_redrawPop(){if(lastObj>=0){if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){vqRooms[lastObj].attr(selectColor)}else{if(vqRooms[lastObj].data("linked")){vqRooms[lastObj].attr(selectColor_linked)}else{vqRooms[lastObj].attr(selectColor_unlinked)}}lastObj=-1;try{cvjs_NoObjectSelected()}catch(b){var a=0}}if(popObj>=0){if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){vqRooms[popObj].attr(selectColor)}else{if(vqRooms[popObj].data("linked")){vqRooms[popObj].attr(selectColor_linked)}else{vqRooms[popObj].attr(selectColor_unlinked)}}popObj=-1;try{cvjs_NoObjectSelected()}catch(b){var a=0}}}function hideOnlyPop(){if(lastObj>=0){$(vqRooms[lastObj].node).qtip("hide");if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){vqRooms[lastObj].attr(defaultColor)}else{if(vqRooms[lastObj].data("linked")){vqRooms[lastObj].attr(defaultColor_linked)}else{vqRooms[lastObj].attr(defaultColor_unlinked)}}lastObj=-1;try{cvjs_NoObjectSelected()}catch(b){var a=0}}if(popObj>=0){$(vqRooms[popObj].node).qtip("hide");if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){vqRooms[popObj].attr(defaultColor)}else{if(vqRooms[popObj].data("linked")){vqRooms[popObj].attr(defaultColor_linked)}else{vqRooms[popObj].attr(defaultColor_unlinked)}}popObj=-1;try{cvjs_NoObjectSelected()}catch(b){var a=0}}}function hideOnlyStickyNote(){if(lastObjStickyNote>=0){StickNoteEditMode=false;var a=vqStickyNotes[lastObjStickyNote].data("text");cvjs_setStickyNoteText(a);var d='<table width="100%"><tr><td cols="3"><div class="cvjs_modal_header_stickynote_info_2">#'+vqStickyNotes[lastObjStickyNote].data("id")+'</div><td class="cvjs_modal_header_stickynote_info_2_background"></td><td class="cvjs_modal_header_1" >'+vqStickyNotes[lastObjStickyNote].data("name")+'</td><td class="cvjs_modal_header_sticky_note_info_1" id="stickyNoteIcon1" onclick="cvjs_move_note();" onmouseout="javascript:tip.hide();" onmouseover="javascript:cvjs_showStickynoteTip(\'Move Note\',1,'+lastObjStickyNote+');" ><i class="glyphicon glyphicon-move"></i></td><td class="cvjs_modal_header_sticky_note_info_1" id="stickyNoteIcon2" onclick="cvjs_edit_note();" onmouseout="javascript:tip.hide();" onmouseover="javascript:cvjs_showStickynoteTip(\'Edit Note\',2,'+lastObjStickyNote+');" ><i class="glyphicon glyphicon-edit"></i></td><td class="cvjs_modal_header_sticky_note_info_1" id="stickyNoteIcon3" onclick="cvjs_delete_note();" onmouseout="javascript:tip.hide();" onmouseover="javascript:cvjs_showStickynoteTip(\'Delete Note\',3,'+lastObjStickyNote+');" ><i class="glyphicon glyphicon-trash"></i></td><td class="cvjs_modal_header_sticky_note_info_2" id="stickyNoteIcon4" onclick="hideOnlyStickyNote('+lastObjStickyNote+');" onmouseout="javascript:tip.hide();" onmouseover="javascript:cvjs_showStickynoteTip(\'Minimize Note\',4,'+lastObjStickyNote+');" ><i class="glyphicon glyphicon-remove"></i></td></tr></table>';$(vqStickyNotes[lastObjStickyNote].node).qtip({content:{text:cvjsStickyNoteBody,title:d},style:{classes:"qtip-bootstrap qtip-shadow qtip-rounded qtip-zindex"},position:{my:"bottom center",at:"top left"},hideOnHTMLClick:"false"});$(vqStickyNotes[lastObjStickyNote].node).qtip("hide");if(!cvjs_supressPopUpModal){vqStickyNotes[lastObjStickyNote].attr(defaultColor_StickyNotes)}else{if(vqStickyNotes[lastObjStickyNote].data("linked")){vqStickyNotes[lastObjStickyNote].attr(defaultColor_linked)}else{vqStickyNotes[lastObjStickyNote].attr(defaultColor_unlinked)}}lastObjStickyNote=-1;try{cvjs_NoObjectSelected()}catch(c){var b=0}}if(popObjStickyNote>=0){StickNoteEditMode=false;var a=vqStickyNotes[popObjStickyNote].data("text");cvjs_setStickyNoteText(a);var d='<table width="100%"><tr><td cols="3"><div class="cvjs_modal_header_stickynote_info_2">#'+vqStickyNotes[popObjStickyNote].data("id")+'</div><td class="cvjs_modal_header_stickynote_info_2_background"></td><td class="cvjs_modal_header_1" >'+vqStickyNotes[popObjStickyNote].data("name")+'</td><td class="cvjs_modal_header_sticky_note_info_1" id="stickyNoteIcon1" onclick="cvjs_move_note();" onmouseout="javascript:tip.hide();" onmouseover="javascript:cvjs_showStickynoteTip(\'Move Note\',1,'+popObjStickyNote+');" ><i class="glyphicon glyphicon-move"></i></td><td class="cvjs_modal_header_sticky_note_info_1" id="stickyNoteIcon2" onclick="cvjs_edit_note();" onmouseout="javascript:tip.hide();" onmouseover="javascript:cvjs_showStickynoteTip(\'Edit Note\',2,'+popObjStickyNote+');" ><i class="glyphicon glyphicon-edit"></i></td><td class="cvjs_modal_header_sticky_note_info_1" id="stickyNoteIcon3" onclick="cvjs_delete_note();" onmouseout="javascript:tip.hide();" onmouseover="javascript:cvjs_showStickynoteTip(\'Delete Note\',3,'+popObjStickyNote+');" ><i class="glyphicon glyphicon-trash"></i></td><td class="cvjs_modal_header_sticky_note_info_2" id="stickyNoteIcon4" onclick="hideOnlyStickyNote('+popObjStickyNote+');" onmouseout="javascript:tip.hide();" onmouseover="javascript:cvjs_showStickynoteTip(\'Minimize Note\',4,'+popObjStickyNote+');" ><i class="glyphicon glyphicon-remove"></i></td></tr></table>';$(vqStickyNotes[popObjStickyNote].node).qtip({content:{text:cvjsStickyNoteBody,title:d},style:{classes:"qtip-bootstrap qtip-shadow qtip-rounded qtip-zindex"},position:{my:"bottom center",at:"top left"},hideOnHTMLClick:"false"});$(vqStickyNotes[popObjStickyNote].node).qtip("hide");if(!cvjs_supressPopUpModal){vqStickyNotes[popObjStickyNote].attr(defaultColor_StickyNotes)}else{if(vqStickyNotes[popObjStickyNote].data("linked")){vqStickyNotes[popObjStickyNote].attr(defaultColor_linked)}else{vqStickyNotes[popObjStickyNote].attr(defaultColor_unlinked)}}popObjStickyNote=-1;try{cvjs_NoObjectSelected()}catch(c){var b=0}}}function closeAllPopups(a){window.alert("closeAllPopups");for(spc in vqRooms){if(spc!=a){$(vqRooms[spc].node).qtip("hide")}}}function closeAllPopupsStickyNotes(a){for(spc in vqStickyNotes){if(spc!=a){$(vqStickyNotes[spc].node).qtip("hide")}}}function pick_space(a){$("#SearchResultsPanel").hide();cvjs_change_space(a);var b=findRoom(a);if(b){$(vqRooms[b].node).qtip("show");popObj=b}}function cvjs_pick_space(a){cvjs_change_space(a);var b=findRoom(a);if(b){$(vqRooms[b].node).qtip("show");popObj=b}}function cvjs_zoomHere(){zoomHere()}function zoomHere(){if(lastObj>=0){$(vqRooms[lastObj].node).qtip("hide");if(popObj>=0){$(vqRooms[popObj].node).qtip("hide")}bbox=vqRooms[lastObj].getBBox();var d=viewBoxWidth/viewBoxHeight;var e;var c;var a=bbox.x+(bbox.width/2);var g=bbox.y+(bbox.height/2);if(bbox.width>bbox.height){e=bbox.width*2;c=e/d}else{c=bbox.height*2;e=c*d}viewBox.X=a-e/2;viewBox.Y=g-c/2;viewBoxWidth=e;viewBoxHeight=c;var b='{"viewBox" : "'+viewBox.X+" "+viewBox.Y+" "+viewBoxWidth+" "+viewBoxHeight+'" }';var f=$.parseJSON(b);rPaper.attr(f);zoomScale=viewBoxWidth/rpWidth;lastObj=-1}}function cvjs_clearDrawingSpaceObjects(){cvjs_clearDrawing()}function cvjs_clearDrawing(){for(room in vqRooms){try{if(room!=lastObj||room!=popObj){$(vqRooms[room].node).qtip("hide");if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){vqRooms[room].attr(defaultColor)}else{if(vqRooms[room].data("linked")){vqRooms[room].attr(defaultColor_linked)}else{vqRooms[room].attr(defaultColor_unlinked)}}}}catch(a){}}}function cvjs_clearDrawingStickyNotes(){try{for(room in vqStickyNotes){if(room!=lastObjStickyNote||room!=popObjStickyNote){$(vqStickyNotes[room].node).qtip("hide");if(!cvjs_supressPopUpModal){vqStickyNotes[room].attr(defaultColor_StickyNotes)}else{if(vqStickyNotes[room].data("linked")){vqStickyNotes[room].attr(defaultColor_linked)}else{vqStickyNotes[room].attr(defaultColor_unlinked)}}}}}catch(a){}}function cvjs_clearDrawingHyperlinks(){for(room in vqURLs){try{if(room!=lastObjHyperlink||room!=popObjHyperlink){$(vqURLs[room].node).qtip("hide")}if(!cvjs_supressHyperlinkColors){vqURLs[room].attr(defaultColor_Hyperlinks)}else{vqURLs[room].attr(defaultColor_Hyperlinks_blank)}}catch(a){}}}function cvjs_clearDrawingRedlines(){}function cvjs_clearAllDrawing(){for(room in vqRooms){if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){vqRooms[room].attr(defaultColor)}else{if(vqRooms[room].data("linked")){vqRooms[room].attr(defaultColor_linked)}else{vqRooms[room].attr(defaultColor_unlinked)}}try{if(room!=lastObj||room!=popObj){$(vqRooms[room].node).qtip("hide")}}catch(a){}}}function cvjs_highlightRoomCSS(a,b){var c=findRoom(a);if(c>=0){lastObj=c;vqRooms[c].attr(b)}}function cvjs_highlightAllSpaceObjects(b,a){for(spc in vqRooms){cvjs_highlightRoomCSS_layer(vqRooms[spc].data("id"),b,a)}}function cvjs_highlightAllRooms_layer(b,a){for(spc in vqRooms){cvjs_highlightRoomCSS_layer(vqRooms[spc].data("id"),b,a)}}function cvjs_highlightSpaceObjectId(a,c,b){cvjs_highlightRoomCSS_layersort(a,c,b,layer_vqrooms)}function cvjs_highlightRoomCSS_layer(a,c,b){cvjs_highlightRoomCSS_layersort(a,c,b,layer_vqrooms)}function cvjs_highlightRoomCSS_layersort(I,A,e,w){var B=findFixture(I);if(B>=0){lastObj=B;var t=(vqRooms[B].attr()).toString();var O=e.toString();var j="";var K=true;var v=0;var u=0;var E=0;if(t.indexOf("path")>-1){K=true;var d=t.indexOf(" d=");var n=t.substring(d+4);var N=n.indexOf('" ');j=n.substring(0,N)}if(t.indexOf("circle")>-1){K=false;var q=t.indexOf(" cx=");var b=t.substring(q+5);var l=b.indexOf('"');v=b.substring(0,l);var p=t.indexOf(" cy=");var a=t.substring(p+5);var k=a.indexOf('"');u=a.substring(0,k);var G=t.indexOf(" r=");var o=t.substring(G+4);var P=o.indexOf('"');E=o.substring(0,P)}var c=t.indexOf(" fill=");var H=t.substring(c+1);var m=JSON.stringify(A);m=m.toString();var C=m.split(",");var M="#fff";var g="#0.5";var z="#fff";var s=1;var f="round";var y="1";for(var J=0;J<C.length;J++){var D=C[J];if(D.indexOf('"fill"')>-1){M=D.substring(D.indexOf(":")+1);if(M.indexOf("}")>-1){M=M.substring(0,M.indexOf("}"))}}if(D.indexOf('"fill-opacity"')>-1){g=D.substring(D.indexOf(":")+1);if(g.indexOf("}")>-1){g=g.substring(0,g.indexOf("}"))}}if(D.indexOf('"stroke"')>-1){z=D.substring(D.indexOf(":")+1);if(z.indexOf("}")>-1){z=z.substring(0,z.indexOf("}"))}}if(D.indexOf('"stroke-width"')>-1){s=D.substring(D.indexOf(":")+1);if(s.indexOf("}")>-1){s=s.substring(0,s.indexOf("}"))}}if(D.indexOf('"stroke-opacity"')>-1){y=D.substring(D.indexOf(":")+1);if(y.indexOf("}")>-1){y=y.substring(0,y.indexOf("}"))}}if(D.indexOf('"stroke-linejoin"')>-1){f=D.substring(D.indexOf(":")+1);if(f.indexOf("}")>-1){f=f.substring(0,f.indexOf("}"))}}}try{var h='{ "fill" : '+M+' , "fill-opacity": '+g+' , "stroke": '+z+', "stroke-width": '+s+', "stroke-opacity": '+y+',  "stroke-linejoin": '+f+" }";var F=$.parseJSON(h);if(K){e.add(rPaper.path(j).attr(F))}else{e.add(rPaper.circle(v,u,E,E).attr(F))}try{w.prepend(e)}catch(L){var x=0}return 1}catch(L){window.alert("A2 "+L);return -1}}return -1}function findFixture(a){for(spc in vqRooms){var b=vqRooms[spc].data("id");if(b==a){return spc}}return -1}function cvjs_highlightFixtureCSS_layersort(J,A,e,w,B){var C=findFixture(J);if(C>=0){lastObj=C;var t=(vqRooms[C].attr()).toString();var P=e.toString();var j;var L=true;var v;var u;var F;if(t.indexOf("path")>-1){L=true;var d=t.indexOf(" d=");var n=t.substring(d+4);var O=n.indexOf('" ');j=n.substring(0,O)}if(t.indexOf("circle")>-1){L=false;var q=t.indexOf(" cx=");var b=t.substring(q+5);var l=b.indexOf('"');v=b.substring(0,l);var p=t.indexOf(" cy=");var a=t.substring(p+5);var k=a.indexOf('"');u=a.substring(0,k);var H=t.indexOf(" r=");var o=t.substring(H+4);var Q=o.indexOf('"');F=o.substring(0,Q)}var c=t.indexOf(" fill=");var I=t.substring(c+1);var m=JSON.stringify(A);m=m.toString();var D=m.split(",");var N="#fff";var g="#0.5";var z="#fff";var s=1;var f="round";var y="1";for(var K=0;K<D.length;K++){var E=D[K];if(E.indexOf('"fill"')>-1){N=E.substring(E.indexOf(":")+1);if(N.indexOf("}")>-1){N=N.substring(0,N.indexOf("}"))}}if(E.indexOf('"fill-opacity"')>-1){g=E.substring(E.indexOf(":")+1);if(g.indexOf("}")>-1){g=g.substring(0,g.indexOf("}"))}}if(E.indexOf('"stroke"')>-1){z=E.substring(E.indexOf(":")+1);if(z.indexOf("}")>-1){z=z.substring(0,z.indexOf("}"))}}if(E.indexOf('"stroke-width"')>-1){s=E.substring(E.indexOf(":")+1);if(s.indexOf("}")>-1){s=s.substring(0,s.indexOf("}"))}}if(E.indexOf('"stroke-opacity"')>-1){y=E.substring(E.indexOf(":")+1);if(y.indexOf("}")>-1){y=y.substring(0,y.indexOf("}"))}}if(E.indexOf('"stroke-linejoin"')>-1){f=E.substring(E.indexOf(":")+1);if(f.indexOf("}")>-1){f=f.substring(0,f.indexOf("}"))}}}try{var h='{ "fill" : '+N+' , "fill-opacity": '+g+' , "stroke": '+z+', "stroke-width": '+s+', "stroke-opacity": '+y+',  "stroke-linejoin": '+f+" }";var G=$.parseJSON(h);if(L){e.add(rPaper.path(j).transform(B).attr(G))}else{e.add(rPaper.circle(v,u,F,F).transform(B).attr(G))}try{w.prepend(e)}catch(M){var x=0}return 1}catch(M){window.alert("A2 "+M);return -1}}return -1}function cvjs_highlightRoomRGB(c,e,d,a){var f=findRoom(c);if(f>=0){lastObj=f;vqRooms[f].attr({fill:rgb(e,d,a),"fill-opacity":"0.7"})}}function cvjs_highlightRoomHex(a,b){var c=findRoom(a);if(c>=0){lastObj=c;vqRooms[c].attr({fill:"#"+b,"fill-opacity":"0.7"})}}function cvjs_highlightRoomByIdHex(a,b){var c=findRoomById(a);if(c>=0){lastObj=c;vqRooms[c].attr({fill:"#"+b,"fill-opacity":"0.7"})}}function clearRoom(a){var b=findRoom(a);if(b>=0){if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){vqRooms[b].attr(defaultColor)}else{if(vqRooms[b].data("linked")){vqRooms[b].attr(defaultColor_linked)}else{vqRooms[b].attr(defaultColor_unlinked)}}}}function cvjs_highlightRoomImmediate(a){cvjs_clearDrawing();var b=findRoom(a);if(b>=0){lastObj=b;if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){vqRooms[b].attr(selectColor)}else{if(vqRooms[b].data("linked")){vqRooms[b].attr(selectColor_linked)}else{vqRooms[b].attr(selectColor_unlinked)}}return b}return b}function cvjs_highlightRoomImmediateHyperlinks(a){cvjs_clearDrawingHyperlinks();var b=findUrl(a);if(b>=0){lastObjHyperlink=b;if(!cvjs_supressPopUpModal){if(!cvjs_supressHyperlinkColors){vqURLs[b].attr(selectColor)}else{vqURLs[b].attr(defaultColor_Hyperlinks_blank)}}else{if(!cvjs_supressHyperlinkColors){vqURLs[b].attr(defaultColor_Hyperlinks)}else{vqURLs[b].attr(defaultColor_Hyperlinks_blank)}}return b}return b}function cvjs_highlightRoomImmediateStickyNotes(a){cvjs_clearDrawingStickyNotes();var b=findStickyNotes(a);if(b>=0){lastObjStickyNote=b;if(!cvjs_supressPopUpModal){vqStickyNotes[b].attr(selectColor_StickyNotes)}else{if(vqStickyNotes[b].data("linked")){vqStickyNotes[b].attr(selectColor_linked)}else{vqStickyNotes[b].attr(selectColor_unlinked)}}return b}return b}function cvjs_highlightRoomImmediateNoClearDrawing(a){var b=findRoom(a);if(b>=0){lastObj=b;if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){vqRooms[b].attr(selectColor)}else{if(vqRooms[b].data("linked")){vqRooms[b].attr(selectColor_linked)}else{vqRooms[b].attr(selectColor_unlinked)}}return b}}function highlightRoomVqId(a){cvjs_clearDrawing();lastObj=a;vqRooms[a].attr(highlight)}function highlightRoom(a){cvjs_clearDrawing();var b=findRoom(a);if(b>=0){lastObj=b;vqRooms[b].animate(highlight,300);return b}}function cvjs_activateSpaceObjectModal_Id(a){change_space_fixed_location(a)}function cvjs_activateSpaceObjectModal_Node(b){var a=findIdFromNode(b);change_space_fixed_location(a)}function change_space_fixed_location(b){if(cvjs_callbackForModalDisplayVar){var f=cvjs_customModalPopUpBody(b);var a=findRoom(b);var g='<table width="100%"><tr><td class="cvjs_modal_header_1" onclick="cvjs_popupTitleClick(\''+vqRooms[a].data("id")+"');\">"+vqRooms[a].data("name")+'</td><td class="cvjs_modal_header_info_1" onclick="hideOnlyPop('+a+');"><i class="glyphicon glyphicon-remove"></i></td></tr><tr><td cols="2"><h4 id="cvjs_modal_header_info_2">'+vqRooms[a].data("type")+"</h4></td></tr></table>";$(vqRooms[a].node).qtip({content:{text:f,title:g},style:{classes:"qtip-bootstrap qtip-shadow qtip-rounded qtip-zindex"},position:{my:"bottom center",at:"top left"},hideOnHTMLClick:"false"});var c=vqRooms[a].data("node");var e=cvjs_getAttributeStatus(c)}hidePop();if(b==0){closeAllPopups(-1);try{cvjs_NoObjectSelected()}catch(d){var i=0}}else{space=cvjs_highlightRoomImmediate(b);if(space>=0){spaceId=b;lastObj=space;if(cvjs_supressPopUpModal==true){$(vqRooms[space].node).qtip("show");$(vqRooms[space].node).qtip("hide")}else{$(vqRooms[space].node).qtip("show");if(cvjs_callbackForModalDisplayVar){if(cvjs_getAttributeStatus(c)=="unpopulated"){cvjs_callbackForModalDisplay(b,c)}else{cvjs_populateMyCustomPopUpBody(b,c)}}}popObj=space}try{cvjs_ObjectSelected(b)}catch(d){var h=0}}}function change_space_fixed_locationStickyNotes(a){hidePopStickyNotes();if(a==0){closeAllPopupsStickyNotes(-1);try{cvjs_NoObjectSelectedStickyNotes()}catch(f){var e=0}}else{space=cvjs_highlightRoomImmediateStickyNotes(a);if(space>=0){spaceIdStickNote=a;lastObjStickyNote=space;if(cvjs_supressPopUpModal==true){$(vqStickyNotes[space].node).qtip("show");$(vqStickyNotes[space].node).qtip("hide")}else{$(vqStickyNotes[space].node).qtip("show");var d=document.getElementsByTagName("div");for(var c=0;c<d.length;c++){if(((d[c].id).indexOf("qtip-")>-1)&&((d[c].id).indexOf("-content")==-1)&&((d[c].id).indexOf("-title")==-1)){StickNoteQtipDiv=d[c].id}}}popObjStickyNote=space}try{cvjs_ObjectSelectedStickyNotes(a)}catch(f){var b=0}}}function change_space_fixed_locationHyperlink(a){if(a==0){closeAllPopupsHyperlinks(-1);try{cvjs_NoObjectSelectedHyperlinks()}catch(d){var c=0}}else{space=cvjs_highlightRoomImmediateHyperlinks(a);if(space>=0){spaceIdHyperlink=a;lastObjHyperlink=space;if(cvjs_supressPopUpModal==true){$(vqURLs[space].node).qtip("show");$(vqURLs[space].node).qtip("hide")}else{$(vqURLs[space].node).qtip("show")}popObjHyperlink=space}try{cvjs_ObjectSelectedHyperlink(a)}catch(d){var b=0}}}var floorPlan_div;var cvjs_location_flag=true;var hbody="";var hbody_2="";var dual_hbody_flag=false;function cvjs_InitCADViewerJS_highLight_popUp_dual_Id(e,d,b,f,c,a){floorPlan_div=e;cvjs_location_flag=true;lastObj=-1;$("#wait_looper").hide();defaultColor={fill:"#FFF","fill-opacity":"0.1",stroke:"#CCC","stroke-width":1,"stroke-linejoin":"round"};highlight={fill:"#a4d7f4","fill-opacity":"0.5",stroke:"#a4d7f4","stroke-width":3};selectColor={fill:"#5BBEF6","fill-opacity":"0.5",stroke:"#5BBEF6","stroke-width":3};hbody='<div class="cvjs_modal_1" onclick="my_own_clickmenu1();">Custom<br>Menu 1<br><i class="glyphicon glyphicon-transfer"></i></div>';hbody+='<div class="cvjs_modal_1" onclick="my_own_clickmenu2();">Custom<br>Menu 2<br><i class="glyphicon glyphicon-info-sign"></i></div>';hbody+='<div class="cvjs_modal_1" onclick="cvjs_zoomHere();">Zoom<br>Here<br><i class="glyphicon glyphicon-zoom-in"></i></div>';hbody_2='<div class="cvjs_modal_1" onclick="my_own_clickmenu1();">Custom<br>Menu 1<br><i class="glyphicon glyphicon-transfer"></i></div>';hbody_2+='<div class="cvjs_modal_1" onclick="cvjs_zoomHere();">Zoom<br>Here<br><i class="glyphicon glyphicon-zoom-in"></i></div>';if(d!=undefined){defaultColor=d}if(b!=undefined){highlight=b}if(f!=undefined){selectColor=f}if(c!=undefined){hbody=c}if(a!=undefined){hbody_2=a}dual_hbody_flag=true}function cvjs_InitCADViewerJS_highLight_popUp(d,c,a,e,b){floorPlan_div=d;cvjs_location_flag=true;lastObj=-1;$("#wait_looper").hide();defaultColor={fill:"#FFF","fill-opacity":"0.1",stroke:"#CCC","stroke-width":1,"stroke-linejoin":"round"};highlight={fill:"#a4d7f4","fill-opacity":"0.5",stroke:"#a4d7f4","stroke-width":3};selectColor={fill:"#5BBEF6","fill-opacity":"0.5",stroke:"#5BBEF6","stroke-width":3};hbody='<div class="cvjs_modal_1" onclick="my_own_clickmenu1();">Custom<br>Menu 1<br><i class="glyphicon glyphicon-transfer"></i></div>';hbody+='<div class="cvjs_modal_1" onclick="my_own_clickmenu2();">Custom<br>Menu 2<br><i class="glyphicon glyphicon-info-sign"></i></div>';hbody+='<div class="cvjs_modal_1" onclick="cvjs_zoomHere();">Zoom<br>Here<br><i class="glyphicon glyphicon-zoom-in"></i></div>';if(c!=undefined){defaultColor=c}if(a!=undefined){highlight=a}if(e!=undefined){selectColor=e}if(b!=undefined){hbody=b}dual_hbody_flag=false}function cvjs_InitCADViewerJS_highLight(c,b,a,d){floorPlan_div=c;cvjs_location_flag=true;lastObj=-1;$("#wait_looper").hide();defaultColor={fill:"#FFF","fill-opacity":"0.1",stroke:"#CCC","stroke-width":1,"stroke-linejoin":"round"};highlight={fill:"#a4d7f4","fill-opacity":"0.5",stroke:"#a4d7f4","stroke-width":3};selectColor={fill:"#5BBEF6","fill-opacity":"0.5",stroke:"#5BBEF6","stroke-width":3};hbody='<div class="cvjs_modal_1" onclick="my_own_clickmenu1();">Custom<br>Menu 1<br><i class="glyphicon glyphicon-transfer"></i></div>';hbody+='<div class="cvjs_modal_1" onclick="my_own_clickmenu2();">Custom<br>Menu 2<br><i class="glyphicon glyphicon-info-sign"></i></div>';hbody+='<div class="cvjs_modal_1" onclick="cvjs_zoomHere();">Zoom<br>Here<br><i class="glyphicon glyphicon-zoom-in"></i></div>';if(b!=undefined){defaultColor=b}if(a!=undefined){highlight=a}if(d!=undefined){selectColor=d}dual_hbody_flag=false}function cvjs_InitCADViewerJS(a){floorPlan_div=a;cvjs_location_flag=true;lastObj=-1;$("#wait_looper").hide();defaultColor={fill:"#FFF","fill-opacity":"0.1",stroke:"#CCC","stroke-width":1,"stroke-linejoin":"round"};highlight={fill:"#a4d7f4","fill-opacity":"0.5",stroke:"#a4d7f4","stroke-width":3};selectColor={fill:"#5BBEF6","fill-opacity":"0.5",stroke:"#5BBEF6","stroke-width":3};hbody='<div class="cvjs_modal_1" onclick="my_own_clickmenu1();">Custom<br>Menu 1<br><i class="glyphicon glyphicon-transfer"></i></div>';hbody+='<div class="cvjs_modal_1" onclick="my_own_clickmenu2();">Custom<br>Menu 2<br><i class="glyphicon glyphicon-info-sign"></i></div>';hbody+='<div class="cvjs_modal_1" onclick="cvjs_zoomHere();">Zoom<br>Here<br><i class="glyphicon glyphicon-zoom-in"></i></div>';dual_hbody_flag=false}var floor_loaded=false;var nodes_loaded=false;var stickynotesRedlines_loaded=false;var current_jsNodesFloorNames="";var current_jsThumbFloorNames="";var current_jsFullFloorNames="";var current_jsFloorNames="";var current_jsRedlinename="";var current_js_initialized=0;var current_redline_js_initialized=0;var js_loaded_flag=0;var current_FileNamePath="";function cvjs_LoadDrawing(e,d,b){try{rPaper.selectAll("*").remove()}catch(a){}$("#wait_looper").html('<table width="100" border="0" cellspacing="0" border-spacing="0" ><tr><td><div id="looper_image"></div></td></tr><tr><td><div class="wait_text_4" id="wait_looper_text_id">Loading</div></td></tr></table>');$("#wait_looper_text_id").html("Loading");var f=($(window).width()-86)/2;var c=($(window).height()-14)/2;$("#wait_looper").css({left:f,top:c,position:"absolute"});$("#looper_image").html("");$("#looper_image").append('<img class="waiting" src="../images/looper.gif" />');$("#wait_looper").show();$("#floorPlanCanvasObject").hide();cvjs_objectIsZoomedExtents=true;cvjs_loadDrawing_conversionMode=false;cvjs_loaddrawing_FileNamePath=d;$("#"+e).html("");floor_loaded=false;nodes_loaded=false;thumbs_loaded=false;VqSetup=false;current_FileNamePath=d;js_loaded_flag=0;if(current_js_initialized==1){replacejscssfile(current_jsFloorNames,d+b+".js","js");replacejscssfile(current_jsNodesFloorNames,d+b+"-nodes.js","js");replacejscssfile(current_jsThumbFloorNames,d+b+"-thumb.js","js");replacejscssfile(current_jsFullFloorNames,d+b+"-full.js","js")}else{current_js_initialized=1;loadJSbase(d+b+".js");loadJSbase(d+b+"-nodes.js");loadJSbase(d+b+"-thumb.js");loadJSbase(d+b+"-full.js")}current_jsNodesFloorNames=d+b+"-nodes.js";current_jsThumbFloorNames=d+b+"-thumb.js";current_jsFullFloorNames=d+b+"-full.js";current_jsFloorNames=d+b+".js";rebuild_drop_spaces=1}var cvjs_loadDrawing_conversionMode=false;var cvjs_conversion_originatingFile="";var cvjs_conversion_originatingFileNameNoExtension="";var cvjs_conversion_originatingUsername="";var cvjs_conversion_originatingPassword="";var cvjs_loaddrawing_FileNamePath="";function cvjs_restApiController(){return(rest_php_version)}function cvjs_restApiControllerLocation(){return(tms_rest_api_url1)}function cvjs_setRestApiControllerLocation(a){tms_rest_api_url1=a}function cvjs_setRestApiController(a){rest_php_version=a}function cvjs_restApiConverter(){return(rest_converter)}function cvjs_restApiConverterVersion(){return(rest_version)}function cvjs_setConverter(b,a){rest_converter=b;rest_version=a}function cvjs_setConverterCredentials(b,a){cvjs_usr=b;cvjs_pwd=a}function cvjs_Init_ConversionServer(c,b,d,a){tms_rest_api_url1=c;rest_php_version=b;cvjs_usr=d;cvjs_pwd=a}var tms_rest_api_url1="http://tms-restful-api.vizquery.com/";var rest_php_version="call-Api_full_04_05.php";var rest_action="conversion";var rest_converter="AutoXchange AX2015";var rest_version="V1.30a";var rest_contentType="file";var rest_contentLocation;var rest_contentStream;var rest_embeddedContent;var rest_contentFormat="DWG";var rest_contentUserName;var rest_contentPassword;var rest_userLabel="fromCADViewerJS";var rest_contentResponse="stream";var rest_parameters;var rest_nname=new Array();var rest_vvalue=new Array();function cvjs_conversion_clearAXconversionParameters(){rest_nname.length=0;rest_vvalue.length=0;rest_nname[0]="f";rest_vvalue[0]="js"}function cvjs_conversion_addAXconversionParameter(b,c){var a=rest_nname.length;if(a==0){rest_nname[0]="f";rest_vvalue[0]="js";a++}rest_nname[a]=b;rest_vvalue[a]=c}function cvjs_conversion_setContentType(a){rest_contentType=a}function cvjs_conversion_setContentFormat(a){rest_contentFormat=a}function cvjs_conversion_setUserLabel(a){rest_userLabel=a}function cvjs_conversion_setContentResponse(a){rest_contentResponse=a}function cvjs_conversion_getContentResponse(){return(rest_contentResponse)}var cvjs_debug=false;function cvjs_debugMode(a){cvjs_debug=a}function cvjs_setPasswordProtectionServerAccess(a){cvjs_passwordProtected=debug}function cvjs_setServerAccessToServlet(a){cvjs_servlet_handshake=a;cvjs_jsonp_handshake=!a}var cvjs_usr="guest";var cvjs_pwd="guest";var cvjs_passwordProtected=false;var cvjs_servlet_handshake=false;var cvjs_jsonp_handshake=true;function cvjs_LoadDrawing_Conversion(e,a,c,b,d){cvjs_checkLicensePreThenLoad(e,a,c,b,d)}function cvjs_LoadDrawing_Conversion_original(a,n,y,l,f){try{rPaper.selectAll("*").remove()}catch(g){}$("#wait_looper").html('<table width="100" border="0" cellspacing="0" border-spacing="0" ><tr><td><div id="looper_image"></div></td></tr><tr><td><div class="wait_text_4" id="wait_looper_text_id">Loading</div></td></tr></table>');$("#wait_looper_text_id").html("Loading");var r=($(window).width()-86)/2;var q=($(window).height()-14)/2;$("#wait_looper").css({left:r,top:q,position:"absolute"});$("#looper_image").html("");$("#looper_image").append('<img class="waiting" src="../images/looper.gif" />');$("#wait_looper").show();$("#floorPlanCanvasObject").hide();cvjs_objectIsZoomedExtents=true;cvjs_loadDrawing_conversionMode=true;cvjs_conversion_originatingFile=n;cvjs_conversion_originatingFileNameNoExtension=y;cvjs_conversion_originatingUsername=l;cvjs_conversion_originatingPassword=f;$("#"+a).html("");floor_loaded=false;nodes_loaded=false;thumbs_loaded=false;VqSetup=false;if(rest_nname.length==undefined||rest_nname.length==0){rest_nname[0]="f";rest_vvalue[0]="js"}var c=true;for(var t=0;t<rest_nname.length;t++){if(rest_nname[t]=="basic"){c=false}if(rest_nname[t]=="layout"){c=false}if(rest_nname[t]=="model"){c=false}}if(c){var t=rest_nname.length;rest_nname[t]="model";rest_vvalue[t]="";t=rest_nname.length;rest_nname[t]="extents";rest_vvalue[t]=""}var j;var u;var o;var x;var m;var w;var z;var b;var p=new Object();p.action="svg_js_creation";p.converter=rest_converter;p.version=rest_version;p.contentType=rest_contentType;if(p.contentType=="file"){p.contentLocation=n}if(p.contentType=="stream"){p.contentStream=n}if(p.contentType=="embedded"){p.embeddedContent=n}p.contentFormat=rest_contentFormat;p.contentUsername=l;p.contentPassword=f;p.userLabel=rest_userLabel;p.contentResponse=rest_contentResponse;p.parameters=new Array();for(var t=0;t<rest_nname.length;t++){var v=new Object;v.paramName=rest_nname[t];v.paramValue=rest_vvalue[t];p.parameters[t]=v}api_data=JSON.stringify(p);tms_rest_api_url=tms_rest_api_url1+rest_php_version;if(cvjs_debug){console.log(" index of"+tms_rest_api_url1.indexOf("tms-restful-api"))}if(tms_rest_api_url1.indexOf("tms-restful-api")>-1){cvjs_passwordProtected=true;if(cvjs_isLicensed){cvjs_usr="tms";cvjs_pwd="restful"}if(cvjs_debug){console.log(cvjs_isLicensed+" "+cvjs_usr+" "+cvjs_pwd)}}var s;if(cvjs_passwordProtected){var e=tms_rest_api_url.indexOf("//");var k=tms_rest_api_url.substring(0,e+2);var d=tms_rest_api_url.substring(e+2);s=k+cvjs_usr+":"+cvjs_pwd+"@"+d}else{s=tms_rest_api_url}var h=s+"?json="+api_data;if(cvjs_debug){console.log(s+" in makeConversion  request="+api_data)}if(cvjs_jsonp_handshake){if(cvjs_debug){console.log("before ajax call to php ")}$.ajax({url:h,jsonp:"tms_restful_api",dataType:"jsonp",success:function(i){if(cvjs_debug){console.log("jsonP Conversion success: "+i)}parseServerResponse(i)},error:function(i){window.alert("jsonp getEngines error="+i)}})}if(cvjs_servlet_handshake){if(cvjs_debug){console.log("before ajax call to Servlet")}$.ajax({url:s,type:"POST",dataType:"json",data:api_data,contentType:"application/json",mimeType:"application/json",success:function(i){if(cvjs_debug){console.log("json Conversion success: "+i)}parseServerResponse(i)},error:function(i){window.alert("json getEngines error="+i)}})}}function parseServerResponse(a){var b=$.parseJSON(a);if(rest_contentResponse=="stream"){contentStreamGraphics=b.contentStreamGraphics;contentStreamNodes=b.contentStreamNodes;contentStreamData=b.contentStreamData;contentStreamThumb=b.contentStreamThumb;if(current_js_initialized==1){replacejscssfile(current_jsFloorNames,contentStreamData,"js");replacejscssfile(current_jsNodesFloorNames,contentStreamNodes,"js");replacejscssfile(current_jsThumbFloorNames,contentStreamThumb,"js");replacejscssfile(current_jsFullFloorNames,contentStreamGraphics,"js")}else{current_js_initialized=1;loadJSbase(contentStreamData);loadJSbase(contentStreamNodes);loadJSbase(contentStreamThumb);loadJSbase(contentStreamGraphics)}current_jsNodesFloorNames=contentStreamNodes;current_jsThumbFloorNames=contentStreamThumb;current_jsFullFloorNames=contentStreamGraphics;current_jsFloorNames=contentStreamData;rebuild_drop_spaces=1}else{if(rest_contentResponse=="file"){contentLocationGraphics=b.contentLocationGraphics;contentLocationNodes=b.contentLocationNodes;contentLocationData=b.contentLocationData;contentLocationThumb=b.contentLocationThumb;cvjs_loaddrawing_FileNamePath=b.contentLocationGraphics.substring(0,(b.contentLocationGraphics.lastIndexOf("/")+1));if(current_js_initialized==1){replacejscssfile(current_jsFloorNames,contentLocationData,"js");replacejscssfile(current_jsNodesFloorNames,contentLocationNodes,"js");replacejscssfile(current_jsThumbFloorNames,contentLocationThumb,"js");replacejscssfile(current_jsFullFloorNames,contentLocationGraphics,"js")}else{current_js_initialized=1;loadJSbase(contentLocationData);loadJSbase(contentLocationNodes);loadJSbase(contentLocationThumb);loadJSbase(contentLocationGraphics)}current_jsNodesFloorNames=contentLocationNodes;current_jsThumbFloorNames=contentLocationThumb;current_jsFullFloorNames=contentLocationGraphics;current_jsFloorNames=contentLocationData;rebuild_drop_spaces=1}else{window.alert("currently contentStream and contentLocation are implemented!! embedded to follow...")}}}function createjscssfile(a,b){if(b=="js"){var c=document.createElement("script");c.setAttribute("type","text/javascript");c.setAttribute("src",a)}else{if(b=="css"){var c=document.createElement("link");c.setAttribute("rel","stylesheet");c.setAttribute("type","text/css");c.setAttribute("href",a)}}return c}function replacejscssfile(f,h,c){var e=(c=="js")?"script":(c=="css")?"link":"none";var d=(c=="js")?"src":(c=="css")?"href":"none";var g=document.getElementsByTagName(e);for(var b=g.length;b>=0;b--){if(g[b]&&g[b].getAttribute(d)!=null&&g[b].getAttribute(d).indexOf(f)!=-1){var a=createjscssfile(h,c);g[b].parentNode.replaceChild(a,g[b]);js_loaded_flag=1}}}function loadJSbase(b){try{var a=document.createElement("script");a.type="application/javascript";a.src=b;document.body.appendChild(a)}catch(c){window.alert(c)}}var SVGloadFile="";var SVGloadFlag=false;function cvjs_LoadDrawing_SVG(d,c,a,b){$("#floorPlanCanvasObject").hide();SVGloadFile=c+a;SVGloadFlag=true;cvjs_LoadDrawing(d,b,"init")}var _label;var Header1;var BackgroundColor="#FFF";var rDrawing;function setView(e,a,g,d,c){viewBox.X=a;viewBox.Y=g;var b='{"viewBox" : "'+viewBox.X+" "+viewBox.Y+" "+d+" "+c+'" }';var f=$.parseJSON(b);rPaper.attr(f)}var bbox;function ResizeVq(e,c){viewBoxWidth=e;viewBoxHeight=c;rpWidth=actualURX-actualLLX;rpHeight=actualURY-actualLLY;rpX=actualLLX;rpY=actualLLY;var a=rpWidth/viewBoxWidth;var d=rpHeight/viewBoxHeight;if(a>d){zoomScale=d}else{zoomScale=a}var b='{"viewBox" : "'+rpX+" "+rpY+" "+rpWidth+" "+rpHeight+'" }';var f=$.parseJSON(b);rPaper.attr(f);viewBox.X=rpX;viewBox.Y=rpY;viewBoxWidth=rpWidth;viewBoxHeight=rpHeight;vBHo=viewBoxHeight;vBWo=viewBoxWidth}var thumb_loaded=false;var load_failures=0;var SVGloadedFragment="";var SVGfragmentIsLoaded=false;function SetUpVq(b,c){if((floor_loaded)&&(nodes_loaded)&&(thumbs_loaded)){load_failures=0;thumb_loaded=false;if(SVGloadFlag){SVGloadFlag=false;var a=Snap.load(SVGloadFile,function(d){SVGloadedFragment=d;SVGfragmentIsLoaded=true;VqSetup=false;DoSetUpVq()})}else{DoSetUpVq()}}else{if(load_failures<80){load_failures++;$("#loading").html("Loading");setTimeout(function(){SetUpVq(b,c)},256)}else{window.alert("3x load_failures="+load_failures);load_failures=0;$("#loading").html("Failure to load drawing, floor: "+floor_loaded+" ,nodes: "+nodes_loaded);$("#looper").hide();$("#waitpane").show();setTimeout(function(){$("#waitpane").hide();$("#looper").show()},5120)}}}var mousedown_SVGCanvas=function(){window.alert("SVG we have clicked "+$(this).attr("id"))};function DoSetUpVq(){if(VqSetup){return}else{VqSetup=true}DefaultZoomFactor=1.3;hgt=$(window).height()-($("#logorow").height()+$("#navrow").height()+20);wid=$(window).width()-128;var T="#"+floorPlan_div;rPaper=Snap(T);if(SVGfragmentIsLoaded){SVGfragmentIsLoaded=false;var v=rPaper.g();v.add(SVGloadedFragment);var B=rPaper.getBBox();var K=B.x;var J=B.y;var b=B.width;var c=B.height;actualLLX=K;actualLLY=J;actualURX=K+b;actualURY=J+c;masterBackground=rPaper.group(rPaper.rect(actualLLX,actualLLY,actualURX-actualLLX,actualURY-actualLLY));masterBackground.after(v);var E={};$("*[id]").each(function(){var i=$(this).attr("id");if(!E[i]){E[i]=true}});for(var r in E){try{var a="#"+r;var n=$(a).attr("stroke-width");if(n==undefined){}else{$(a).data("original_stroke_width",n)}var C=$(a).attr("style");if(C==undefined){$(a).data("original_stroke","Undefined")}else{var L=C.split(";");for(var R=0;R<L.length;R++){var D=L[R].split(":");if(D[0].trim()=="stroke"){$(a).data("original_stroke",D[1].trim())}}}$(a).click(function(){cvjs_SVGfileObjectClicked($(this).attr("id"))})}catch(S){window.alert(S)}}}else{masterBackground=rPaper.group(rPaper.rect(actualLLX,actualLLY,actualURX-actualLLX,actualURY-actualLLY))}masterBackground.attr({fill:"#fff","fill-opacity":"0.01"});rPaper.attr({viewBox:"50 0 500 400"});viewBoxWidth=fpWidth;viewBoxHeight=winHeight;rpWidth=actualURX-actualLLX;rpHeight=actualURY-actualLLY;rpX=actualLLX;rpY=actualLLY;vBHo=viewBoxHeight;vBWo=viewBoxWidth;xfactor=rpWidth/viewBoxWidth;yfactor=rpHeight/viewBoxHeight;if(xfactor>yfactor){zoomScale=yfactor}else{zoomScale=xfactor}var A=0;var w=0;var h='{"viewBox" : "'+actualLLX+" "+actualLLY+" "+rpWidth+" "+rpHeight+'" }';var O=$.parseJSON(h);rPaper.attr(O);viewBox={X:0,Y:0,width:0,height:0};viewBox.X=actualLLX;viewBox.Y=actualLLY;viewBoxWidth=rpWidth;viewBoxHeight=rpHeight;objArr=new Array();pathArr=new Array();drawDrawing(rPaper);drawPaths(rPaper);setUpVqRooms(rPaper);try{drawThumb(rPaper)}catch(S){window.alert(" drawthumb  "+S)}setUpVqStickyNotes(rPaper);setUpVqRedlines(rPaper);setUpVqURLs(rPaper);masterBackground.add(layers_all);cvjs_addMouseWheelControls();try{rPaper.selectAll("text").attr({"stroke-width":"0"});rPaper.selectAll("path").attr({"stroke-linejoin":"round"});$("#wait_looper").fadeOut(500);cvjs_checkLicense();cvjs_OnLoadEnd()}catch(S){var R=0}var M=40;var p;var P,N;var F="";var j=0;var m=0;var k=0;var I=0;var H=0;var z=0;var g=0;var G=0;var t=0;var u=0;var s=true;var d=true;var o=0;var l=0;function f(i,Y,W){pdx=0;pdy=0;A=0;w=0;vbx=viewBox.X;vby=viewBox.Y;hideOnlyPop();o=0;l=0;if(!thumb_loaded){o=i;l=Y}F="vqjs dragstart "+o+" "+l+" x="+i+" y="+Y;$("#movements2").css("color","#FF00FF");$("#movements2").html(F);if(!thumb_loaded){thumb_loaded=true;try{}catch(V){}}var U=0;try{U=1;m=W.touches[0].pageX;U=2;k=W.touches[0].pageY;j=1;U=3;I=W.touches[1].pageX;U=4;H=W.touches[1].pageY;j=2;U=5}catch(V){var X=1}try{W.preventDefault();W.stopPropagation();if(j==2){W.preventDefault();W.stopPropagation()}}catch(V){window.alert("t7 "+V)}}function Q(y){d=true;if(j==2){y.preventDefault();y.stopPropagation()}try{if(j==2){viewBox.X=viewBox_initX;viewBox.Y=viewBox_initY;vBHo=viewBoxHeight_init;vBWo=viewBoxWidth_init;viewBoxWidth=viewBoxWidth_init;viewBoxHeight=viewBoxHeight_init;viewBoxWidth/=deltaDynamic/deltaBase;viewBoxHeight/=deltaDynamic/deltaBase;viewBox.X-=(viewBoxWidth-vBWo)/2;viewBox.Y-=(viewBoxHeight-vBHo)/2;zoomScale=viewBoxWidth/rPaper.width;var i='{"viewBox" : "'+viewBox.X+" "+viewBox.Y+" "+viewBoxWidth+" "+viewBoxHeight+'" }';var U=$.parseJSON(i);rPaper.attr(U)}}catch(x){}try{if(panWithThumb){layers_all.attr(show);layer_thumb.attr(hide)}layer_vqrooms.attr(show);thumb_loaded=false}catch(x){window.alert("t8 "+x)}}function e(ad,ab,aa,Z,Y){try{if(panWithThumb&&(((o-aa)!=0)||((l-Z)!=0))){layers_all.attr(hide);layer_thumb.attr(show);layer_vqrooms.attr(hide)}}catch(V){window.alert("t7 "+V)}if(j==2){return}if(j<2){if((Math.abs(A-ad)>4)||(Math.abs(w-ab)>4)){if(!dragMoveControl){}else{tip.hide();A=ad;w=ab;pdx=ad*zoomScale;pdy=ab*zoomScale;var i=viewBoxWidth/$("#floorPlan").width();var W=viewBoxHeight/$("#floorPlan").height();var U=1;if(i>W){U=i}else{U=W}pdx=ad*U;pdy=ab*U;viewBox.X=vbx-pdx;viewBox.Y=vby-pdy;var ac='{"viewBox" : "'+viewBox.X+" "+viewBox.Y+" "+viewBoxWidth+" "+viewBoxHeight+'" }';var X=$.parseJSON(ac);rPaper.attr(X)}}}}function q(y){var x=new Date();var i=null;do{i=new Date()}while(i-x<y)}masterBackground.drag(e,f,Q);masterBackground.mousedown(function(i){});masterBackground.mouseup(function(i){layer_vqrooms.attr(show);if(dragInsidePolygon&&j==0){dragInsidePolygon=false;DoMouseUp(i.clientX+document.body.scrollLeft,i.clientY+document.body.scrollTop);setRoomAfterPanPC()}});masterBackground.mousemove(function(U){try{mousex=U.clientX+document.body.scrollLeft;mousey=U.clientY+document.body.scrollTop;try{if(tooltipLast!=lastObj&&cvjs_location_flag&&tooltipLast!=-1){if(!cvjs_supressPopUpModal||cvjs_standardHighLightColors){vqRooms[tooltipLast].attr(defaultColor)}else{if(vqRooms[tooltipLast].data("linked")){vqRooms[tooltipLast].attr(defaultColor_linked)}else{vqRooms[tooltipLast].attr(defaultColor_unlinked)}}tip.hide()}}catch(x){}try{if(tooltipLastStickyNote!=lastObjStickyNote&&cvjs_location_flag){if(!cvjs_supressPopUpModal){vqStickyNotes[tooltipLastStickyNote].attr(defaultColor_StickyNotes)}else{if(vqStickyNotes[tooltipLastStickyNote].data("linked")){vqStickyNotes[tooltipLastStickyNote].attr(defaultColor_linked)}else{vqStickyNotes[tooltipLastStickyNote].attr(defaultColor_unlinked)}}tip.hide()}}catch(i){}try{if(tooltipLastHyperlink!=lastObjHyperlink&&cvjs_location_flag){if(!cvjs_supressHyperlinkColors){vqURLs[tooltipLastHyperlink].attr(defaultColor_Hyperlinks)}else{vqURLs[tooltipLastHyperlink].attr(defaultColor_Hyperlinks_blank)}tip.hide()}}catch(V){}if(dragInsidePolygon&&j==0){dx=U.clientX+document.body.scrollLeft;dy=U.clientY+document.body.scrollTop;DoMouseMove(dx,dy)}}catch(y){}}).touchstart(function(x){d=true;u=0;x.preventDefault();x.stopPropagation();if(!thumb_loaded){thumb_loaded=true;try{drawThumb(rPaper)}catch(i){}}try{if(j==0){if(panWithThumb){layers_all.attr(hide);layer_thumb.attr(show)}layer_vqrooms.attr(hide)}}catch(i){window.alert("t9 "+i)}try{m=x.touches[0].pageX;k=x.touches[0].pageY;j=1;d=false;I=x.touches[1].pageX;H=x.touches[1].pageY;j=2;d=true;allowPinchInPolygons=false;deltaXinit=I-m;deltaYinit=H-k;deltaBase=Math.sqrt(deltaXinit*deltaXinit+deltaYinit*deltaYinit);deltaDynamicPre=deltaBase;viewBoxWidthPre=viewBoxWidth;viewBoxheightPre=viewBoxHeight;z=m;g=k;firstFingerX_init=m;firstFingerY_init=k;viewBox_initX=viewBox.X;viewBox_initY=viewBox.Y;viewBoxWidth_init=viewBoxWidth;viewBoxHeight_init=viewBoxHeight;s=true}catch(i){var y=1}}).touchend(function(y){d=true;if(j==2){y.preventDefault();y.stopPropagation();tip.hide();hideOnlyPop()}try{if(j==2){viewBox.X=viewBox_initX;viewBox.Y=viewBox_initY;vBHo=viewBoxHeight_init;vBWo=viewBoxWidth_init;viewBoxWidth=viewBoxWidth_init;viewBoxHeight=viewBoxHeight_init;viewBoxWidth/=deltaDynamic/deltaBase;viewBoxHeight/=deltaDynamic/deltaBase;viewBox.X-=(viewBoxWidth-vBWo)/2;viewBox.Y-=(viewBoxHeight-vBHo)/2;zoomScale=viewBoxWidth/rpWidth;var i='{"viewBox" : "'+viewBox.X+" "+viewBox.Y+" "+viewBoxWidth+" "+viewBoxHeight+'" }';var U=$.parseJSON(i);rPaper.attr(U)}j=0;layer_vqrooms.attr(show);if(panWithThumb){layers_all.attr(show);layer_thumb.attr(hide)}}catch(x){window.alert(x)}}).touchmove(function(U){F="masterbackground touch move event.touches[0].pageXY="+U.touches[0].pageX+"  "+U.touches[0].pageY+"   dragstart="+j;$("#movements3").css("color","#FF00FF");$("#movements3").html(F);if(d){U.stopPropagation();U.preventDefault()}if(j==2){U.stopPropagation();U.preventDefault();tip.hide();hideOnlyPop()}if(j==2){try{m=U.touches[0].pageX;k=U.touches[0].pageY;j=1;d=false;I=U.touches[1].pageX;H=U.touches[1].pageY;j=2;d=true;deltaX=I-m;deltaY=H-k;deltaDynamic=Math.sqrt(deltaX*deltaX+deltaY*deltaY);F="event.touches[1].pageX="+U.touches[1].pageX+"  "+deltaDynamic+"   pre="+deltaDynamicPre;$("#movements").css("color","#FF00FF");$("#movements").html(F);if((deltaDynamic-deltaDynamicPre>4||deltaDynamic-deltaDynamicPre<-4)&&s){s=false;deltaDynamicPre=deltaDynamic;viewBox.X=viewBox_initX;viewBox.Y=viewBox_initY;vBHo=viewBoxHeight_init;vBWo=viewBoxWidth_init;viewBoxWidth=viewBoxWidth_init;viewBoxHeight=viewBoxHeight_init;viewBoxWidth/=deltaDynamic/deltaBase;viewBoxHeight/=deltaDynamic/deltaBase;viewBox.X-=(viewBoxWidth-vBWo)/2;viewBox.Y-=(viewBoxHeight-vBHo)/2;zoomScale=viewBoxWidth/rpWidth;var x='{"viewBox" : "'+viewBox.X+" "+viewBox.Y+" "+viewBoxWidth+" "+viewBoxHeight+'" }';var X=$.parseJSON(x);rPaper.attr(X);var i=viewBox.X;var W=viewBox.Y;z=m;g=k;s=true}}catch(y){var V=1}}});$("#waitpane").hide();cvjs_change_space(0)}var scroll_locationX;var scroll_locationY;function cvjs_addMouseWheelControls(){var a=/Firefox/i.test(navigator.userAgent);if(a){$("#floorPlan").mousemove(function(b){scroll_locationX=b.pageX;scroll_locationY=b.pageY});$("#floorPlan").bind("DOMMouseScroll",function(i){var m=scroll_locationX;var j=scroll_locationY;var k=$("#floorPlan").position();var l="X coords: "+m+", Y coords: "+j+"  "+k.top+"  "+k.left+"  "+$("#floorPlan").width()+"  "+$("#floorPlan").height();var g=m-k.left;var f=j-k.top;var d=g/$("#floorPlan").width()*100;var b=f/$("#floorPlan").height()*100;var h=d-50;var c=b-50;if(i.originalEvent.detail>0){console.log("Down ");cvjs_zoomOutMouseWheel(h,c)}else{console.log("Up");cvjs_zoomInMouseWheel(h,c)}return false})}else{$("#floorPlan").bind("mousewheel",function(i){var m=event.clientX;var j=event.clientY;var k=$("#floorPlan").position();var l="X coords: "+m+", Y coords: "+j+"  "+k.top+"  "+k.left+"  "+$("#floorPlan").width()+"  "+$("#floorPlan").height();var g=m-k.left;var f=j-k.top;var d=g/$("#floorPlan").width()*100;var b=f/$("#floorPlan").height()*100;var h=d-50;var c=b-50;if(i.originalEvent.wheelDelta<0){console.log("Down");cvjs_zoomOutMouseWheel(h,c)}else{console.log("Up");cvjs_zoomInMouseWheel(h,c)}return false})}}function cvjs_zoomWindow(){hideOnlyPop();cvjs_addHandleFunc_ZoomWindow()}function cvjs_addHandleFunc_ZoomWindow(){tPath_r="M"+firstX_r+","+firstY_r;tRubberBand_r=rPaper.path(tPath_r).attr({stroke:"#b00000",fill:"none"});canvas_width=$("#"+floorPlan_div).width();canvas_height=$("#"+floorPlan_div).height();var a=$("#"+floorPlan_div).position();global_scale_X=canvas_width/viewBoxWidth;global_scale_Y=canvas_height/viewBoxHeight;if(global_scale_X<global_scale_Y){global_scale=global_scale_X}else{global_scale=global_scale_Y}delta_x=(canvas_width-viewBoxWidth*global_scale)/2-viewBox.X*global_scale+a.left;delta_y=(canvas_height-viewBoxHeight*global_scale)/2-viewBox.Y*global_scale+a.top;handleGroup=rPaper.rect(actualLLX,actualLLY,actualURX-actualLLX,actualURY-actualLLY).attr({fill:"#fff","fill-opacity":"0.01"});handleGroup.drag(move_cvjs_create_zoomwindow_rectangle,start_cvjs_create_zoomwindow_rectangle,stop_cvjs_create_zoomwindow_rectangle)}function cvjs_removeHandleFunc_ZoomWindowRectangle(){handleGroup.selectAll("handler").remove();handleGroup.remove();cvjs_objectIsZoomedExtents=false}var start_cvjs_create_zoomwindow_rectangle=function(){flag_rectangle=false;var b=viewBoxWidth/400;var a='{"stroke": "#0b0b0b", "fill" : "none", "stroke-opacity": "0.5", "stroke-width": "'+b+'"}';var c=$.parseJSON(a);tRubberBand_r.attr(c)};var zoomwindow_counter=0;var move_cvjs_create_zoomwindow_rectangle=function(c,b,a,e){var d=a+" "+e+" dx="+c+" dy="+b;zoomwindow_counter++;a=a+document.body.scrollLeft;e=e+document.body.scrollTop;if(!flag_rectangle){firstX_r=a;firstY_r=e;lastX_r=c;lastY_r=b;flag_rectangle=true}else{lastX_r=c;lastY_r=b}tPath_r="M"+(firstX_r-delta_x)/global_scale+","+(firstY_r-delta_y)/global_scale;tPath_r+="h"+lastX_r/global_scale+"v"+lastY_r/global_scale+"h"+(-lastX_r/global_scale)+"v"+(-lastY_r/global_scale+" Z");if(zoomwindow_counter==1){zoomwindow_counter=0;tRubberBand_r.attr({path:tPath_r})}};var stop_cvjs_create_zoomwindow_rectangle=function(){tRubberBand_r.attr({path:"M0,0"});if(lastX_r<0){firstX_r+=lastX_r}if(lastY_r<0){firstY_r+=lastY_r}viewBox.X=(firstX_r-delta_x)/global_scale;viewBox.Y=(firstY_r-delta_y)/global_scale;viewBoxWidth=Math.abs(lastY_r/global_scale);viewBoxHeight=Math.abs(lastX_r/global_scale);var a='{"viewBox" : "'+viewBox.X+" "+viewBox.Y+" "+viewBoxWidth+" "+viewBoxHeight+'" }';var b=$.parseJSON(a);rPaper.attr(b);tRubberBand_r.attr({fill:"#ff9999","fill-opacity":"0.5",stroke:"#ff9999","stroke-opacity":"1"});cvjs_removeHandleFunc_ZoomWindowRectangle()};function cvjs_panRight(){try{}catch(c){var b=0}hideOnlyPop();viewBox.X+=viewBoxWidth/10;var a='{"viewBox" : "'+viewBox.X+" "+viewBox.Y+" "+viewBoxWidth+" "+viewBoxHeight+'" }';var d=$.parseJSON(a);rPaper.attr(d);cvjs_objectIsZoomedExtents=false}function cvjs_panUp(){try{}catch(c){var b=0}hideOnlyPop();viewBox.Y-=viewBoxHeight/10;var a='{"viewBox" : "'+viewBox.X+" "+viewBox.Y+" "+viewBoxWidth+" "+viewBoxHeight+'" }';var d=$.parseJSON(a);rPaper.attr(d);cvjs_objectIsZoomedExtents=false}function cvjs_panDown(){try{}catch(c){var b=0}hideOnlyPop();viewBox.Y+=viewBoxHeight/10;var a='{"viewBox" : "'+viewBox.X+" "+viewBox.Y+" "+viewBoxWidth+" "+viewBoxHeight+'" }';var d=$.parseJSON(a);rPaper.attr(d);cvjs_objectIsZoomedExtents=false}function cvjs_panLeft(){try{}catch(c){var b=0}hideOnlyPop();viewBox.X-=viewBoxWidth/10;var a='{"viewBox" : "'+viewBox.X+" "+viewBox.Y+" "+viewBoxWidth+" "+viewBoxHeight+'" }';var d=$.parseJSON(a);rPaper.attr(d);cvjs_objectIsZoomedExtents=false}function cvjs_resetZoomPan(){try{layers_all.attr(show);layer_vqrooms.attr(show);layer_thumb.attr(hide)}catch(c){var b=0}hideOnlyPop();viewBox.X=actualLLX;viewBox.Y=actualLLY;viewBoxWidth=rpWidth;viewBoxHeight=rpHeight;vBHo=viewBoxHeight;vBWo=viewBoxWidth;zoomScale=1;var a='{"viewBox" : "'+viewBox.X+" "+viewBox.Y+" "+rpWidth+" "+rpHeight+'" }';var d=$.parseJSON(a);rPaper.attr(d);cvjs_objectIsZoomedExtents=true}function cvjs_zoomIn(){try{}catch(c){var b=0}hideOnlyPop();vBHo=viewBoxHeight;vBWo=viewBoxWidth;viewBoxWidth/=DefaultZoomFactor;viewBoxHeight/=DefaultZoomFactor;viewBox.X-=(viewBoxWidth-vBWo)/2;viewBox.Y-=(viewBoxHeight-vBHo)/2;var a='{ "viewBox" : "'+viewBox.X+" "+viewBox.Y+" "+viewBoxWidth+" "+viewBoxHeight+'" }';var d=$.parseJSON(a);rPaper.attr(d);zoomScale=viewBoxWidth/rpWidth;cvjs_objectIsZoomedExtents=false}function cvjs_zoomInMouseWheel(b,a){try{}catch(e){var d=0}hideOnlyPop();vBHo=viewBoxHeight;vBWo=viewBoxWidth;viewBoxWidth/=DefaultZoomFactor;viewBoxHeight/=DefaultZoomFactor;viewBox.X-=(viewBoxWidth-vBWo)/2-(vBHo/4*b/100);viewBox.Y-=(viewBoxHeight-vBHo)/2-(vBWo/4*a/100);var c='{ "viewBox" : "'+viewBox.X+" "+viewBox.Y+" "+viewBoxWidth+" "+viewBoxHeight+'" }';var f=$.parseJSON(c);rPaper.attr(f);zoomScale=viewBoxWidth/rpWidth;cvjs_objectIsZoomedExtents=false}function cvjs_zoomOut(){try{}catch(c){var b=0}hideOnlyPop();vBHo=viewBoxHeight;vBWo=viewBoxWidth;viewBoxWidth*=DefaultZoomFactor;viewBoxHeight*=DefaultZoomFactor;viewBox.X-=(viewBoxWidth-vBWo)/2;viewBox.Y-=(viewBoxHeight-vBHo)/2;var a='{ "viewBox" : "'+viewBox.X+" "+viewBox.Y+" "+viewBoxWidth+" "+viewBoxHeight+'" }';var d=$.parseJSON(a);rPaper.attr(d);zoomScale=viewBoxWidth/rpWidth;cvjs_objectIsZoomedExtents=false}function cvjs_zoomOutMouseWheel(b,a){try{}catch(e){var d=0}hideOnlyPop();vBHo=viewBoxHeight;vBWo=viewBoxWidth;viewBoxWidth*=DefaultZoomFactor;viewBoxHeight*=DefaultZoomFactor;viewBox.X-=(viewBoxWidth-vBWo)/2+(vBHo/4*b/100);viewBox.Y-=(viewBoxHeight-vBHo)/2+(vBWo/4*a/100);var c='{ "viewBox" : "'+viewBox.X+" "+viewBox.Y+" "+viewBoxWidth+" "+viewBoxHeight+'" }';var f=$.parseJSON(c);rPaper.attr(f);zoomScale=viewBoxWidth/rpWidth;cvjs_objectIsZoomedExtents=false}function cvjs_redrawViewBox(){try{}catch(c){var b=0}hideOnlyPop();viewBox.X-=0.01;var a='{"viewBox" : "'+viewBox.X+" "+viewBox.Y+" "+viewBoxWidth+" "+viewBoxHeight+'" }';var d=$.parseJSON(a);rPaper.attr(d);window.alert("after pan 1")}function d2h(b){var a=b.toString(16);if(b<16){return"0"+a}return a}function h2d(a){return parseInt(a,16)}function rgb2hex(e,d,a){var c=d2h(e)+d2h(d)+d2h(a);return c};